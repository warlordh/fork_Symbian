<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="concept" />
  <meta name="DC.Title" content="Templated stream operators" />
  <meta name="DC.Relation" scheme="URI" content="GUID-6BF09365-09D7-5596-B802-1BE1757F51F6.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-3FAB9077-3EC3-5539-B391-D11456362513.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-6BF09365-09D7-5596-B802-1BE1757F51F6.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Templated stream operators
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803">
  <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2388397 id2388585 id2398757 id2399178 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html" title="Provides services to enable and support persistence.">
      Persistent Data Services Guide
     </a>
     &gt;
     <a href="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html" title="The persistent storage collection.">
      Persistent Storage
     </a>
     &gt;
     <a href="GUID-3FAB9077-3EC3-5539-B391-D11456362513.html" title="Store provides structured data storage.">
      Store
     </a>
     &gt;
     <a href="GUID-6BF09365-09D7-5596-B802-1BE1757F51F6.html" title="Provides various streams and stream operations such as read, write, internalize, and externalize.">
      Streaming
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Templated stream operators
    </h1>
    <div>
     <p>
      There are two templated stream operators,
      <samp class="codeph">
       operator&lt;&lt;
      </samp>
      and
      <samp class="codeph">
       operator&gt;&gt;
      </samp>
      that can be used to externalise and internalise data of all types. They use a syntax that is familiar to users of C++ iostreams, or Java streams.
     </p>
     <p>
      An object can be externalised to a stream, using a write stream:
     </p>
     <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-825246E2-9EFF-5D34-9B89-62B0AE8419E8">
      <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-825246E2-9EFF-5D34-9B89-62B0AE8419E8">
       <!-- -->
      </a>
      writeStream &lt;&lt; object;
     </pre>
     <p>
      and later, assuming the operation starts from the appropriate place on the stream, the data can be internalised again, using a read stream:
     </p>
     <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-4D1E6CC5-06D1-5AA9-99A0-DDAC3793DEEA">
      <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-4D1E6CC5-06D1-5AA9-99A0-DDAC3793DEEA">
       <!-- -->
      </a>
      readStream &gt;&gt; object;
     </pre>
     <p>
      The implementation of the operators depends on the type of object on which they are called.
     </p>
     <div class="section">
      <h2 class="sectiontitle">
       Implementation for a class defining ExternalizeL() &amp; InternalizeL()
      </h2>
      <p>
       For a class that defines and implements the
       <samp class="codeph">
        ExternalizeL()
       </samp>
       and
       <samp class="codeph">
        InternalizeL()
       </samp>
       functions, the Store framework:
      </p>
      <ul>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-7000A711-4C8F-5522-9981-6975FD563D6B">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-7000A711-4C8F-5522-9981-6975FD563D6B">
         <!-- -->
        </a>
        <p>
         implements
         <samp class="codeph">
          operator&lt;&lt;
         </samp>
         by calling the
         <samp class="codeph">
          ExternalizeL()
         </samp>
         member function of that class.
        </p>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-D62B7DE5-7179-56AB-A7BC-221459CA7E77">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-D62B7DE5-7179-56AB-A7BC-221459CA7E77">
         <!-- -->
        </a>
        <p>
         implements
         <samp class="codeph">
          operator&gt;&gt;
         </samp>
         by calling the
         <samp class="codeph">
          InternalizeL()
         </samp>
         member function of that class.
        </p>
       </li>
      </ul>
     </div>
     <div class="section">
      <h2 class="sectiontitle">
       Implementation for standard types and classes
      </h2>
      <p>
       The Store framework provides the necessary implementation for the operators to externalise and internalise the following:
      </p>
      <ul>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-7FC174ED-C934-5AEA-9149-ED8CB7A9B4C4">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-7FC174ED-C934-5AEA-9149-ED8CB7A9B4C4">
         <!-- -->
        </a>
        <p>
         The basic types:
         <samp class="codeph">
          TInt8
         </samp>
         ,
         <samp class="codeph">
          TInt16
         </samp>
         ,
         <samp class="codeph">
          TInt32
         </samp>
         ,
         <samp class="codeph">
          TInt64
         </samp>
         ,
         <samp class="codeph">
          TUint8
         </samp>
         ,
         <samp class="codeph">
          TUint16
         </samp>
         ,
         <samp class="codeph">
          TUint32
         </samp>
         ,
         <samp class="codeph">
          TReal32
         </samp>
         and
         <samp class="codeph">
          TReal64
         </samp>
         .
        </p>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-E03896E9-A375-55ED-A4A4-2BD9D39DACE2">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-E03896E9-A375-55ED-A4A4-2BD9D39DACE2">
         <!-- -->
        </a>
        <p>
         The graphics API classes:
         <samp class="codeph">
          TPoint
         </samp>
         ,
         <samp class="codeph">
          TSize
         </samp>
         and
         <samp class="codeph">
          TRect
         </samp>
         .
        </p>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-2ABB347E-A8FD-5D7B-8D83-D15A489DA2A1">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-2ABB347E-A8FD-5D7B-8D83-D15A489DA2A1">
         <!-- -->
        </a>
        <p>
         The UID Manipulation API class:
         <samp class="codeph">
          TUid
         </samp>
         .
        </p>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-F49A0B41-09AB-5802-BECD-E4C855DAF809">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-F49A0B41-09AB-5802-BECD-E4C855DAF809">
         <!-- -->
        </a>
        <p>
         The Dynamic Buffers API classes:
         <samp class="codeph">
          CBufFlat
         </samp>
         and
         <samp class="codeph">
          CBufSeg
         </samp>
         .
        </p>
       </li>
      </ul>
     </div>
     <div class="section">
      <h2 class="sectiontitle">
       Implementation for non-class types
      </h2>
      <p>
       For non-class types, for example enumerators, a
       <em>
        specialized
       </em>
       implementation of the operators must be defined and implemented for that specific non-class type. The definition of the operators must conform to the templated definitions.
      </p>
      <p>
       For example, for a class
       <samp class="codeph">
        TSimple
       </samp>
       that contains an enumeration of type
       <samp class="codeph">
        TXxx
       </samp>
       as a data member:
      </p>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-5B40D0D2-DB8F-57BE-A6F4-C259BDC1190D">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-5B40D0D2-DB8F-57BE-A6F4-C259BDC1190D">
        <!-- -->
       </a>
       enum  TXxx {EX1,EX2,EX3};
      </pre>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-F6F46E9F-4A96-51C9-B32C-99ACD1303F16">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-F6F46E9F-4A96-51C9-B32C-99ACD1303F16">
        <!-- -->
       </a>
       class TSimple
          {
    public :
          void ExternalizeL(RWriteStream&amp; aStream) const;
          void InternalizeL(RReadStream&amp; aStream);
    public :
          TXxx     iTheEnum;
          ...
          TUint    iUintValue;
          ...
          };
      </pre>
      <p>
       The
       <samp class="codeph">
        iTheEnum
       </samp>
       data member is externalised using
       <samp class="codeph">
        operator&lt;&lt;
       </samp>
       and internalised using
       <samp class="codeph">
        operator&gt;&gt;
       </samp>
       :
      </p>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-0B46A456-336B-5D97-AEF9-49B1043D9C4A">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-0B46A456-336B-5D97-AEF9-49B1043D9C4A">
        <!-- -->
       </a>
       void TSimple::ExternalizeL(RWriteStream&amp; aStream) const
          {
          aStream &lt;&lt; iTheEnum;
          ...
          }
      </pre>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-5F1DC34C-9889-5111-AD53-DB58FE31D1B3">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-5F1DC34C-9889-5111-AD53-DB58FE31D1B3">
        <!-- -->
       </a>
       void TSimple::InternalizeL(RReadStream&amp; aStream)
          {
          aStream &gt;&gt; iTheEnum;
          ...
          }
      </pre>
      <p>
       As
       <samp class="codeph">
        TXxx
       </samp>
       is a non-class type, the operators are implemented:
      </p>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-4A3A0ACC-D6AB-5438-9D73-687DC24F1CFE">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-4A3A0ACC-D6AB-5438-9D73-687DC24F1CFE">
        <!-- -->
       </a>
       RWriteStream&amp; operator&lt;&lt;(RWriteStream&amp; aStream, const TXxx&amp; anXxx)
          {
          aStream.WriteInt8L(anXxx);
          return aStream;
          }
      </pre>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-C1CE1913-1753-59C0-A192-8D79AE369ACD">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-C1CE1913-1753-59C0-A192-8D79AE369ACD">
        <!-- -->
       </a>
       RReadStream&amp;  operator&gt;&gt;(RReadStream&amp;  aStream, TXxx&amp; anXxx)
          {
          anXxx = TXxx(aStream.ReadInt8L());
          return aStream;
          }
      </pre>
      <p>
       The enumerator value is written to the stream using
       <samp class="codeph">
        RWriteStream::WriteInt8L()
       </samp>
       . Implicit here is the assumption that the enumeration can be represented by just 8 bits.
      </p>
     </div>
     <div class="section">
      <h2 class="sectiontitle">
       Implementation for a class without ExternalizeL() &amp; InternalizeL()
      </h2>
      <p>
       The operators may be used on class types that do not define and implement
       <samp class="codeph">
        InternalizeL()
       </samp>
       and
       <samp class="codeph">
        ExternalizeL()
       </samp>
       functions. This is done by defining and implementing some extra global functions.
      </p>
      <p>
       In practice, it is much simpler to define and implement
       <samp class="codeph">
        InternlizeL()
       </samp>
       and
       <samp class="codeph">
        ExternalizeL()
       </samp>
       for a class, and all new classes should include these functions. However, there may be rare situations, for example, when porting classes, where it may be undesirable to define them.
      </p>
      <p>
       To support the use of the operators for such a class, for example, for the class
       <samp class="codeph">
        TNonStore
       </samp>
       defined as:
      </p>
      <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-6ACB011D-36B4-5BDF-8866-9B3C8E33A0B4">
       <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-6ACB011D-36B4-5BDF-8866-9B3C8E33A0B4">
        <!-- -->
       </a>
       class TNonStore
          {
    public :
          void  SetBuffer(const TDesC&amp; aData);
          TPtrC GetBuffer() const;
    private :
          TBuf&lt;32&gt; iBuffer;
    public :
          TInt     iIntValue;
          TUint    iUintValue;
          TReal    iRealValue;
          };
      </pre>
      <ul>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-BED64035-9CE4-5EEC-93FB-4D71A9E94F99">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-BED64035-9CE4-5EEC-93FB-4D71A9E94F99">
         <!-- -->
        </a>
        <p>
         <em>
          implement
         </em>
         the following
         <samp class="codeph">
          Externalization()
         </samp>
         and
         <samp class="codeph">
          Internalization()
         </samp>
         <em>
          global
         </em>
         functions:
        </p>
        <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-417BE16B-9A96-5A74-BDC0-8BD36226DD55">
         <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-417BE16B-9A96-5A74-BDC0-8BD36226DD55">
          <!-- -->
         </a>
         inline Externalize::Function Externalization(const TNonstore*)
          {return Externalize::Function();}
        </pre>
        <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-B087C930-27F5-5A0A-BC77-C3AA41539959">
         <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-B087C930-27F5-5A0A-BC77-C3AA41539959">
          <!-- -->
         </a>
         inline Internalize::Function Internalization(TNonstore*)
          {return Internalize::Function();}
        </pre>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-B7ADAB29-0E0A-50F1-AB60-907F142699F5">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-B7ADAB29-0E0A-50F1-AB60-907F142699F5">
         <!-- -->
        </a>
        <p>
         <em>
          declare
         </em>
         the following
         <samp class="codeph">
          ExternalizeL()
         </samp>
         and
         <samp class="codeph">
          InternalizeL()
         </samp>
         <em>
          global
         </em>
         functions:
        </p>
        <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-A28A8120-0D38-5A56-820A-41527F260523">
         <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-A28A8120-0D38-5A56-820A-41527F260523">
          <!-- -->
         </a>
         void ExternalizeL(const TNonstore&amp; aClass,RWriteStream&amp; aStream);
        </pre>
        <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-42046A8B-0DFD-540E-913E-F3D603D327D6">
         <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-42046A8B-0DFD-540E-913E-F3D603D327D6">
          <!-- -->
         </a>
         void InternalizeL(TNonstore&amp; aClass,RReadStream&amp; aStream);
        </pre>
       </li>
       <li id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-D34FEE7D-37C1-54D0-B9FB-0D9F86F09115">
        <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-D34FEE7D-37C1-54D0-B9FB-0D9F86F09115">
         <!-- -->
        </a>
        <p>
         <em>
          implement
         </em>
         the
         <samp class="codeph">
          ExternalizeL()
         </samp>
         and
         <samp class="codeph">
          InternalizeL()
         </samp>
         <em>
          global
         </em>
         functions to implement the streaming of
         <samp class="codeph">
          TNonstore
         </samp>
         's components. For this example class:
        </p>
        <pre class="codeblock" id="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-A6D4AED2-6EA5-5345-B744-A79019470EF6">
         <a name="GUID-3690B530-BFFC-554E-9692-3D7C4C0BC803__GUID-A6D4AED2-6EA5-5345-B744-A79019470EF6">
          <!-- -->
         </a>
         void ExternalizeL(const TNonStore&amp; aClass,RWriteStream&amp; aStream)
          {
          aStream.WriteInt32L(aClass.iIntValue);
          aStream.WriteUint32L(aClass.iUintValue);
          aStream.WriteReal64L(aClass.iRealValue);
          aStream &lt;&lt; aClass.GetBuffer();
          }

    void InternalizeL(TNonStore&amp; aClass,RReadStream&amp; aStream)
          {
          aClass.iIntValue  = aStream.ReadInt32L();
          aClass.iUintValue = aStream.ReadUint32L();
          aClass.iRealValue = aStream.ReadReal64L();
          TBuf&lt;32&gt; temp;
          aStream &gt;&gt; temp;
          aClass.SetBuffer(temp);
          }
        </pre>
       </li>
      </ul>
     </div>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-6BF09365-09D7-5596-B802-1BE1757F51F6.html" title="Provides various streams and stream operations such as read, write, internalize, and externalize.">
        Streaming
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>