<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="concept" />
  <meta name="DC.Title" content="Examples Showing the use of the SIP Client API" />
  <meta name="DC.Relation" scheme="URI" content="GUID-E339A683-94E2-54E8-BB2B-286B11B0FCE3.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-057F1F82-56AF-5696-853E-79196A3D567E.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-E339A683-94E2-54E8-BB2B-286B11B0FCE3.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Examples Showing the use of the SIP Client API
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D">
  <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2386636 id2386727 id2386742 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html">
      Multimedia Protocols Guide
     </a>
     &gt;
     <a href="GUID-057F1F82-56AF-5696-853E-79196A3D567E.html">
      SIP
     </a>
     &gt;
     <a href="GUID-E339A683-94E2-54E8-BB2B-286B11B0FCE3.html">
      SIP Client API
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Examples Showing the use of the SIP Client API
    </h1>
    <div>
     <p>
      The following sections describe how to use the SIP Client API.
     </p>
     <ul>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-C9BF535A-9B75-5133-BBC5-3341A3671126">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-C9BF535A-9B75-5133-BBC5-3341A3671126">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-6E3797D8-507F-5D7B-B601-DABCE95EC87C">
         SIP Client API dependent objects
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-22A2CB82-E384-5137-99E9-CE39FF248971">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-22A2CB82-E384-5137-99E9-CE39FF248971">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0D3FB3DF-9316-554E-AC08-62C8D33B7F5E">
         Publishing the SIP contact address of a user
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0417F827-6C56-5EE9-B1B2-FE82A757E452">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0417F827-6C56-5EE9-B1B2-FE82A757E452">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0B246AE6-F0D1-56D4-9367-AF8678D5DB0F">
         Initiating a REGISTER transaction
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A6E71991-EE51-59CD-AD38-B976F623300A">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A6E71991-EE51-59CD-AD38-B976F623300A">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-E1F1952C-F56A-53D8-BD7E-C39E3E2566FD">
         Creating a CSIPConnection instance for a different IAP
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-D3732A15-A3B2-530E-991F-8B3311677853">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-D3732A15-A3B2-530E-991F-8B3311677853">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-4E2849A8-36BB-5986-BA33-71E39FA5FCE7">
         Creating a SIP dialog while responding to the INVITE request
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-F701EF01-D87C-5665-B5B2-8AAC9A8790DD">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-F701EF01-D87C-5665-B5B2-8AAC9A8790DD">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-9C1A5E22-7E45-5346-B266-7767161816BA">
         Deleting the transaction object
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-079B944B-6026-5AAF-AAD2-390476641272">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-079B944B-6026-5AAF-AAD2-390476641272">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-66B8C7BF-0157-5108-BFE9-510144C0F61C">
         No response is sent to a received ACK
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-3C83FD0B-8040-5E36-8844-69FF156FA3A9">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-3C83FD0B-8040-5E36-8844-69FF156FA3A9">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-5A707F15-A679-5FE0-943D-FE246514F852">
         Getting the transaction timers values
        </a>
       </p>
      </li>
      <li id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-BBC6F83A-760B-597C-B3AD-0DEBBC62EC3C">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-BBC6F83A-760B-597C-B3AD-0DEBBC62EC3C">
        <!-- -->
       </a>
       <p>
        <a href="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D.html#GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-2436DD1E-A388-5D77-A745-22D264770D95">
         Extension headers definition with the SIP Client API
        </a>
       </p>
      </li>
     </ul>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-6E3797D8-507F-5D7B-B601-DABCE95EC87C">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-6E3797D8-507F-5D7B-B601-DABCE95EC87C">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       SIP Client API dependent objects
      </h2>
      <p>
       Create
       <a href="GUID-AFB2603A-8A35-3E70-8EC2-229C9726F00B.html">
        <span class="apiname">
         CSIP
        </span>
       </a>
       and
       <a href="GUID-2A070F4D-A35B-3505-BE86-E6C7A2F27B94.html">
        <span class="apiname">
         CSIPConnection
        </span>
       </a>
       objects to use the SIP Client API:
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-60B89CAD-CB12-521D-8C34-AF8DDC56495B">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-60B89CAD-CB12-521D-8C34-AF8DDC56495B">
        <!-- -->
       </a>
       iSIP = CSIP::NewL(KAppUid, *iMySIPObserver);
iConnection = CSIPConnection::NewL(*iSIP, KIapIdentifier,*iMyConnectionObserver);
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0D3FB3DF-9316-554E-AC08-62C8D33B7F5E">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0D3FB3DF-9316-554E-AC08-62C8D33B7F5E">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Publishing the SIP contact address of a user
      </h2>
      <p>
       Create a SIP registration to publish the SIP contact address of a user. The AOR and a contact must be registered. In this example, create
       <a href="GUID-3C166C85-6E17-323B-9CD3-B3E2836DC1C3.html">
        <span class="apiname">
         CSIPRefresh
        </span>
       </a>
       to automatically refresh the SIP stack when it is registered.
      </p>
      <p>
       In the following code,
       <samp class="codeph">
        localhost
       </samp>
       indicates the request for the SIP stack to replace it with a local address. The
       <samp class="codeph">
        sip:user@localhost
       </samp>
       means that the SIP stack replaces the localhost with the local IP address. An application uses
       <a href="GUID-48AA01D5-CE7B-3C22-B2E0-529261121EC4.html">
        <span class="apiname">
         CSIPRegistrationBinding
        </span>
       </a>
       class to handle SIP registration. The application can also use the profile agent API for handling registration. The profile agents implement all the necessary call flows or behaviour for handling registration for both IETF and 3GPP IMS type networks. For more information about the profile agent API, see
       SIP Profile Agent API
       .
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-E80C2B5B-8FA4-5DBD-9FB0-1DB4AE851E64">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-E80C2B5B-8FA4-5DBD-9FB0-1DB4AE851E64">
        <!-- -->
       </a>
       CSIPToHeader* aor = CSIPToHeader::DecodeL(_L8("sip:user@remote.registrar"));
CleanupStack::PushL(aor);

CSIPAddress* addr = CSIPAddress::DecodeL(_L8("sip:user@LOCALHOST"));
CleanupStack::PushL(addr);
CSIPContactHeader* contact = CSIPContactHeader::NewL(addr);
CleanupStack::Pop(addr);
CleanupStack::PushL(contact);

CSIPRefresh* refresh = CSIPRefresh::NewLC();

iRegistration = CSIPRegistrationBinding::NewL(*iConnection, aor, contact, refresh);

CleanupStack::Pop(3); //refresh, contact, aor
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0B246AE6-F0D1-56D4-9367-AF8678D5DB0F">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-0B246AE6-F0D1-56D4-9367-AF8678D5DB0F">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Initiating a REGISTER transaction
      </h2>
      <p>
       Create a
       <a href="GUID-48AA01D5-CE7B-3C22-B2E0-529261121EC4.html">
        <span class="apiname">
         CSIPRegistrationBinding
        </span>
       </a>
       object to start a
       <samp class="codeph">
        REGISTER
       </samp>
       transaction.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-2C9251DE-298C-5E36-B601-49F33D5EA4F7">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-2C9251DE-298C-5E36-B601-49F33D5EA4F7">
        <!-- -->
       </a>
       iRegisterTransaction = iRegistration-&gt;RegisterL();
      </pre>
      <p>
       When you receive a 2xx response, the registration is active. Delete the transaction when the final response is received.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-320F575F-166F-5A4B-AFE9-EDFF6345CFB0">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-320F575F-166F-5A4B-AFE9-EDFF6345CFB0">
        <!-- -->
       </a>
       void CMyConnectionObserver::IncomingResponse(CSIPClientTransaction&amp; aTransaction, CSIPRegistrationBinding&amp; aRegistration)
    {
    if (aRegistration.IsContextActive())
        {
        // Registration has succeeded
        }

    if (aTransaction.ResponseElements()-&gt;StatusCode() &gt;= 200)
        {
        // Final response received, transaction is no longer needed

        if (aTransaction == *iRegisterTransaction)
            {
            delete iRegisterTransaction;
            iRegisterTransaction = NULL;
            }
        }
    }
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-E1F1952C-F56A-53D8-BD7E-C39E3E2566FD">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-E1F1952C-F56A-53D8-BD7E-C39E3E2566FD">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Creating a CSIPConnection instance for a different IAP
      </h2>
      <p>
       An
       <samp class="codeph">
        INVITE
       </samp>
       request is received from the network. In this example the INVITE is received through a different IAP that does not have a
       <samp class="codeph">
        CSIPConnection
       </samp>
       . Create a
       <samp class="codeph">
        CSIPConnection
       </samp>
       instance for this IAP.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-31AAF5A5-79B1-512B-A649-53562C9940EA">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-31AAF5A5-79B1-512B-A649-53562C9940EA">
        <!-- -->
       </a>
       void CMySIPObserver::IncomingRequest(TUint32 aIapId, CSIPServerTransaction* aTransaction)
    {
    // Create an observer for the new CSIPConnection
    TRAPD(err, iMyOtherConnectionObserver = CMyConnectionObserver::NewL());
    // Handle leave condition

    // Create a new connection for the IAP
    TRAP(err, iOtherConnection = CSIPConnection::NewL(*iSIP, aIapId,
                                   *iMyOtherConnectionObserver));
    // Handle leave condition

    // Application owns the transaction
    iInviteServerTransaction = aTransaction;
    }
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-4E2849A8-36BB-5986-BA33-71E39FA5FCE7">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-4E2849A8-36BB-5986-BA33-71E39FA5FCE7">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Creating a SIP dialog while responding to the INVITE request
      </h2>
      <p>
       The INVITE request is received and the application sends a response (101-299). This creates a SIP dialog. Before sending the response, create a
       <a href="GUID-B4A2FBBD-2B5F-3E64-800D-C4E9203679A8.html">
        <span class="apiname">
         CSIPInviteDialogAssoc
        </span>
       </a>
       .
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A1CD9786-DA64-5495-9F08-F4FE382C2EE9">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A1CD9786-DA64-5495-9F08-F4FE382C2EE9">
        <!-- -->
       </a>
       iInviteAssoc = CSIPInviteDialogAssoc::NewL(*iInviteServerTransaction);

CSIPResponseElements* response = CSIPResponseElements::NewLC(180, SIPStrings::StringF(SipStrConsts::EPhraseRinging));

iInviteServerTransaction-&gt;SendResponseL(response);
CleanupStack::Pop(response);
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-9C1A5E22-7E45-5346-B266-7767161816BA">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-9C1A5E22-7E45-5346-B266-7767161816BA">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Deleting the transaction object
      </h2>
      <p>
       When the user accepts the
       <samp class="codeph">
        INVITE
       </samp>
       , it sends a '200 response' using the same transaction object. When a 2xx response is sent to an
       <samp class="codeph">
        INVITE
       </samp>
       transaction it enters the
       <a href="GUID-93256B64-49C9-37F1-9A4E-72C521759749.html#GUID-93256B64-49C9-37F1-9A4E-72C521759749__GUID-DF7E4DCE-1F6D-3F2A-A638-5516A733AA9D">
        <span class="apiname">
         CSIPTransactionBase::ETerminated
        </span>
       </a>
       state. Then the transaction is deleted.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A2CBCF0A-4E6B-58BD-AFDA-44D57F248C27">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A2CBCF0A-4E6B-58BD-AFDA-44D57F248C27">
        <!-- -->
       </a>
       CSIPResponseElements* response = CSIPResponseElements::NewLC(200, SIPStrings::StringF(SipStrConsts::EPhraseOk));
            
iInviteServerTransaction-&gt;SendResponseL(response);
CleanupStack::Pop(response);

delete iInviteServerTransaction;
iInviteServerTransaction = NULL;
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-66B8C7BF-0157-5108-BFE9-510144C0F61C">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-66B8C7BF-0157-5108-BFE9-510144C0F61C">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       No response is sent to a received ACK
      </h2>
      <p>
       When the ACK request arrives, SIP Client API creates a
       <a href="GUID-7E54C95E-5155-30B1-8169-A59778774403.html">
        <span class="apiname">
         CSIPServerTransaction
        </span>
       </a>
       and passes the transaction object to the application using the
       <a href="GUID-B889A3FD-3B14-3785-90AE-3546F0C9A5D4.html">
        <span class="apiname">
         MSIPConnectionObserver
        </span>
       </a>
       of the IAP through which the ACK is received. If no response is sent to an ACK the transaction object is deleted.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A6B15426-09EA-5C93-AF78-91D304F7A47E">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-A6B15426-09EA-5C93-AF78-91D304F7A47E">
        <!-- -->
       </a>
       void CMyConnectionObserver::IncomingRequest(CSIPServerTransaction* aTransaction, CSIPDialog&amp; aDialog)
    {
    if (aTransaction.Type() == SIPStrings::StringF(SipStrConsts::EAck))
        {
        // Might inspect the Content part of the ACK for SDP etc.
       // No response will be sent to an ACK
        delete aTransaction;
        }
    else
        {
        // Handle other requests
        }
    }
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-5A707F15-A679-5FE0-943D-FE246514F852">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-5A707F15-A679-5FE0-943D-FE246514F852">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Getting the transaction timers values
      </h2>
      <p>
       The following example code shows how to get the transaction timers values from the Central Repository (CenRep).
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-6DF49D97-642A-551A-9D7B-45BE2F4050BE">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-6DF49D97-642A-551A-9D7B-45BE2F4050BE">
        <!-- -->
       </a>
       #include &lt;centralrepository.h&gt;
#include &lt;SIPSDKCRKeys.h&gt;
TInt timerT1 = 0;
TInt timerT2 = 0;
CRepository* repository = CRepository::NewLC(KCRUidSIP);
User::LeaveIfError(repository-&gt;Get(KSIPTransactionTimerT1,timerT1));
User::LeaveIfError(repository-&gt;Get(KSIPTransactionTimerT2,timerT2));
CleanupStack::PopAndDestroy(repository);
      </pre>
     </div>
     <div class="section" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-2436DD1E-A388-5D77-A745-22D264770D95">
      <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-2436DD1E-A388-5D77-A745-22D264770D95">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Extension header definitions with the SIP Client API
      </h2>
      <p>
       The following is an example of the extension header definitions with the SIP Client API. SIP clients use Extension headers to send or receive SIP messages with methods that do not have default handling support implemented in the stack.
      </p>
      <pre class="codeblock" id="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-C25C4DE0-AE63-55BC-8366-387E931EF611">
       <a name="GUID-77E02E43-A72A-52DC-A22B-31FABE5B658D__GUID-C25C4DE0-AE63-55BC-8366-387E931EF611">
        <!-- -->
       </a>
       void CMyClass::ExtractHeadersL( CSIPMessageElements&amp; aElements )
    {
    const RPointerArray&lt;CSIPHeaderBase&gt;&amp; userHeaders = aElements.UserHeaders();
    for ( TInt I = 0; I &lt; userHeaders.Count(); I++ )
        {
        const CSIPHeaderBase* header = userHeaders[ I ];
        
        // An example of a known already supported header.
        // This can be casted to the actual class.
        // It will be supported also in the future and does not cause SC/BC problems.
        
        if ( header-&gt;Name() == SIPStrings::StringF( SipStrConsts::ERAckHeader ) )
             {
             iRAckHeader = static_cast&lt;CSIPRAckHeader*&gt;(header-&gt;CloneL());
             }
         
        // An example of a SIP header that is currently supported as an extension.
        // The application must NOT make a static cast to CSIPExtensionHeader.
        // Instead it must use CSIPHeaderBase::ToTextValueL and parse the result.
        
        RStringF extensionName = SIPStrings::Pool().OpenFStringL( L8("Extension") );
        CleanupClosePushL( extensionName ); 
        if ( header-&gt;Name() == extensionName )
            {
            HBufC8* headerValue = header-&gt;ToTextValueLC();
            
            // Do application specific parsing and handling for the header
 
            CleanupStack::PopAndDestroy( headerValue );
            }
        CleanupStack::PopAndDestroy( 1 ); // extensionName
        }
    }
      </pre>
     </div>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-E339A683-94E2-54E8-BB2B-286B11B0FCE3.html">
        SIP Client API
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>