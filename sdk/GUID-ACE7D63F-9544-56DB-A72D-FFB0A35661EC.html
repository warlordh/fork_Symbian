<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="task" />
  <meta name="DC.Title" content="Loading a Symbian platform Defined Table, Changing a Field, Write Changed Record: Tutorial" />
  <meta name="abstract" content="This tutorial shows you how to load a Symbian platform defined table from the Comms Database, change a field, and write the changed record to the database." />
  <meta name="description" content="This tutorial shows you how to load a Symbian platform defined table from the Comms Database, change a field, and write the changed record to the database." />
  <meta name="DC.Relation" scheme="URI" content="GUID-BD971173-E009-58DA-AF9C-F4AAFF77B138.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-8F2D6AC8-8357-55C7-970B-CD2684BA9B04.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-C3018CEE-865B-595A-A735-40E11665E50A.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-BD971173-E009-58DA-AF9C-F4AAFF77B138.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-1AFDDD6F-CB99-587D-A0B5-D3F5B27F7135.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Loading a Symbian platform Defined Table, Changing a Field, Write Changed Record: Tutorial
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC">
  <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2562582 id2562781 id2562786 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-8F2D6AC8-8357-55C7-970B-CD2684BA9B04.html" title="The Communications Framework is the base for all communications, network and telephony services that Symbian platform provides. The Communications Framework manages the communications threads and the flow of information between those threads. The Framework also manages and stores the communications related settings.">
      Communications Framework Guide
     </a>
     &gt;
     <a href="GUID-C3018CEE-865B-595A-A735-40E11665E50A.html">
      Communications Configuration Utilities
     </a>
     &gt;
     <a href="GUID-BD971173-E009-58DA-AF9C-F4AAFF77B138.html">
      Comms Database
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Loading
a Symbian platform Defined Table, Changing a Field, Write Changed Record:
Tutorial
    </h1>
    <div>
     <p>
      This tutorial shows you how to load a Symbian platform defined
table from the Comms Database, change a field, and write the changed record
to the database.
     </p>
     <div class="p" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-A9D46D95-97E9-537C-BDAA-80CF7A780A99">
      <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-A9D46D95-97E9-537C-BDAA-80CF7A780A99">
       <!-- -->
      </a>
      <p>
       Before you start,
you must understand:
      </p>
      <ul>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-A70B727A-1BE6-5443-91DD-103CD9842F16">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-A70B727A-1BE6-5443-91DD-103CD9842F16">
         <!-- -->
        </a>
        <p>
         the general concept
of the Comms Database
        </p>
       </li>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-15D683C4-D755-5BEC-845D-A81891190114">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-15D683C4-D755-5BEC-845D-A81891190114">
         <!-- -->
        </a>
        <p>
         the specific concept
of fields, records, links and tables
        </p>
       </li>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-686874B2-2B58-5B2A-A9FF-71C156232E62">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-686874B2-2B58-5B2A-A9FF-71C156232E62">
         <!-- -->
        </a>
        <p>
         how to write and build
application code to run on Symbian platform
        </p>
       </li>
      </ul>
     </div>
     <div class="section" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-9837C422-F698-5621-AE3D-2410D5FBDA37">
      <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-9837C422-F698-5621-AE3D-2410D5FBDA37">
       <!-- -->
      </a>
      <p>
       This tutorial shows
you:
      </p>
      <ul>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-72E9465D-1003-521A-8449-37ABB8A5F84E">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-72E9465D-1003-521A-8449-37ABB8A5F84E">
         <!-- -->
        </a>
        <p>
         how to load the
         <em>
          Internet
Access Points Configuration
         </em>
         table. This table is also called the IAP table
        </p>
       </li>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-E4E3455F-1A38-53A2-B609-314580025107">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-E4E3455F-1A38-53A2-B609-314580025107">
         <!-- -->
        </a>
        <p>
         how to search for a
records that have a specific
         <em>
          Service Type
         </em>
         field.
        </p>
       </li>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-810269E0-5159-5028-9A8F-E9DEA5BCB815">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-810269E0-5159-5028-9A8F-E9DEA5BCB815">
         <!-- -->
        </a>
        <p>
         how to change the
         <em>
          Network
Weighting
         </em>
         field in the last record found
        </p>
       </li>
       <li id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-240F862B-4292-5E86-A7F2-AEF989BBAF7F">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-240F862B-4292-5E86-A7F2-AEF989BBAF7F">
         <!-- -->
        </a>
        <p>
         how to store the changed
record in the Comms Database.
        </p>
       </li>
      </ul>
      <p>
       The principles that apply here also apply to the other Symbian platform
defined tables.
      </p>
     </div>
     <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-DCCB1FCB-FC9C-5D02-AD5C-F85560BE77E4">
      <!-- -->
     </a>
     <ol id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-DCCB1FCB-FC9C-5D02-AD5C-F85560BE77E4">
      <li class="stepexpand" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-F8378F77-253C-5FC0-9235-05E15F8A7E2F">
       <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-F8378F77-253C-5FC0-9235-05E15F8A7E2F">
        <!-- -->
       </a>
       <span>
        Make sure that you
have created a session.
       </span>
      </li>
      <li class="stepexpand" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-6FD057FB-F78B-5524-8DAB-9EF7EEE03DC7">
       <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-6FD057FB-F78B-5524-8DAB-9EF7EEE03DC7">
        <!-- -->
       </a>
       <span>
        Create the table
object in the tool or application process.
       </span>
       You create a
       CMDBRecordSet
       <samp class="codeph">
        &lt;T&gt;
       </samp>
       object
and specify
       CCDIAPRecord
       as the template
parameter. 

 Symbian platform defines the
       <samp class="codeph">
        CCDIAPRecord
       </samp>
       class to
represent a IAP record. The class is a schema for the record. The class defines
the fields and links that make a IAP record. 
 Symbian platform defines
       <a href="GUID-6DAF85AD-E412-5823-81C2-FC1755A90A84.html#GUID-6DAF85AD-E412-5823-81C2-FC1755A90A84__GUID-32E556BC-55C3-5FBD-9A60-9708139C20D6">
        unique
numeric Id
       </a>
       s for Symbian platform defined tables. The symbol
       KCDTIdIAPRecord
       defines the value of this Id for
the IAP table. The Id allows the CommsDat API to retrieve the table from the
Comms Database efficiently. 
 To work with other Symbian platform defined tables, use the correct
class name and the correct unique numeric Id values. The
       <a href="GUID-58089281-9DD0-502D-8DFD-831E7BAA931E.html">
        Reference
       </a>
       section
contains a list of all Symbian platform defined tables.
       <pre class="codeblock" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-AB6A65B1-4FBB-5712-97CC-B9223A1538B6">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-AB6A65B1-4FBB-5712-97CC-B9223A1538B6">
         <!-- -->
        </a>
        ...

// This code fragment assumes that a session with the Comms Database has been created.
// iDb is a pointer to a CMDBSession object
...

// Use the standard "new (ELeave)" construction to create the object to 
// represent the table. 
//
// Note:
// 1. the template parameter CCDIAPRecord defines 
//    the "IAP" record type.
// 2. the unique numeric Id KCDTIdIAPRecord is passed as a parameter
//    to the constructor.
CMDBRecordSet&lt;CCDIAPRecord&gt;* iapRecordSet = 
   new (ELeave) CMDBRecordSet&lt;CCDIAPRecord&gt;(KCDTIdIAPRecord);
...
       </pre>
      </li>
      <li class="stepexpand" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-78143DEF-8DA6-5FAB-A2D1-60891D85CED9">
       <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-78143DEF-8DA6-5FAB-A2D1-60891D85CED9">
        <!-- -->
       </a>
       <span>
        Create a record
that contains the type of Service Typefield needed.
       </span>
       To search for a record the tool or application creates a record in memory.
The fields in the record are set to the specific values on which the search
is to match. In this tutorial this record is called the "search record". The
record is appended to the set of records in the table object. At this point,
the search record is the only record in the table, because the Comms Database
has not yet been accessed. 

 In this tutorial, the Service Type field in the search record is set
to DialOutISP.
       <pre class="codeblock" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-0477C3F8-1ECF-50F8-B60A-55E3FF58BEB2">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-0477C3F8-1ECF-50F8-B60A-55E3FF58BEB2">
         <!-- -->
        </a>
        ...
// Searching for all IAP records that support the DialOutISP service.
_LIT(KServiceType, "DialOutISP");

    
// Create the "search record". You use the unique numeric Id KCDTIdIAPRecord 
// to identify the type record to the factory function.
CCDIAPRecord* ptrPrimingRecord = static_cast&lt;CCDIAPRecord *&gt;
    (CCDRecordBase::RecordFactoryL(KCDTIdIAPRecord));


// Prime the Service    Types field with the string "DialOutISP"
ptrPrimingRecord-&gt;iServiceType.SetMaxLengthL(KServiceType().Length());
ptrPrimingRecord-&gt;iServiceType = KServiceType; 


// Append the search record to the table in memory. Remember that the table only 
// contains this record. The Comms Database has not yet been accessed.
iapRecordSet-&gt;iRecords.AppendL(ptrPrimingRecord);


// Set the record pointer to NULL, because ownership of the "search record" has
// been passed to the table object.
ptrPrimingRecord = NULL; 
...
       </pre>
      </li>
      <li class="stepexpand" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-CAE140E8-AE1E-5B7A-A9E1-4A0885F02429">
       <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-CAE140E8-AE1E-5B7A-A9E1-4A0885F02429">
        <!-- -->
       </a>
       <span>
        Perform the search.
       </span>
       Use the
       <samp class="codeph">
        FindL()
       </samp>
       function to search the table in the
Comms Database. The function is called on the class that defines the table.
The function is implemented in the base class
       MMetaDatabase
       .
You pass a reference to the session object into the
       <samp class="codeph">
        FindL()
       </samp>
       function.
       <pre class="codeblock" id="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-1F8AC8D1-3C78-534F-8658-7D439BFFCF6D">
        <a name="GUID-ACE7D63F-9544-56DB-A72D-FFB0A35661EC__GUID-1F8AC8D1-3C78-534F-8658-7D439BFFCF6D">
         <!-- -->
        </a>
        ...
// Perform the search. 
if(iapRecordSet-&gt;FindL(*iDb))
    {
    // At least one record found. 
    // Find the number of records found.   
    TInt iapRecordsFound = iapRecordSet-&gt;iRecords.Count();

    // Change the Network Weighting field in the last record.
    CCDIAPRecord* iapRecord = 
        static_cast&lt;CCDIAPRecord*&gt;( iapRecordSet-&gt;iRecords [iapRecordsFound-1]);
    iapRecord-&gt;iNetworkWeighting = 1;

    // Update the changed record in the Comms Database
    
    // EITHER
    // Check through all records and submit all changes
    // made by the tool or application.
    iapRecordSet-&gt;ModifyL(*iDb);

    // OR 
    // Explicitly submit this record only
    iapRecord -&gt;ModifyL(*iDb); 
    ...
    }
else 
    {
    // No matching records found.
    // Note that iRecords[0] still contains the "search record". The "search record"
    // only contains the priming values.
    // It is important to check the return code from the call to ModifyL()
    }           
...
       </pre>
      </li>
     </ol>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-BD971173-E009-58DA-AF9C-F4AAFF77B138.html">
        Comms Database
       </a>
      </div>
     </div>
     <div class="relinfo relconcepts">
      <strong>
       Related concepts
      </strong>
      <br />
      <div>
       <a href="GUID-1AFDDD6F-CB99-587D-A0B5-D3F5B27F7135.html">
        Comms Database
                concepts
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>