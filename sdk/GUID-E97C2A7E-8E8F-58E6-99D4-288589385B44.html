<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="task" />
  <meta name="DC.Title" content="Querying TLD Policy Data" />
  <meta name="abstract" content="This document explains how to retrieve the characters from the Top-Level Domain Blacklists and Whitelists." />
  <meta name="description" content="This document explains how to retrieve the characters from the Top-Level Domain Blacklists and Whitelists." />
  <meta name="DC.Relation" scheme="URI" content="GUID-945FAA13-A302-55F5-917C-EAD2C9D960E9.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-C0D38954-2FC5-4E8B-BC11-229464DCF16C.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-939C0EE6-0931-4898-842B-9D0C9D61DD2F.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-C0E7CBC4-C525-4CA8-8D21-E7E2ABE396CE.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-945FAA13-A302-55F5-917C-EAD2C9D960E9.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-EDA831F7-7248-5C00-B6BE-B7F44097C9B6.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-AC4C18D1-D6A3-5988-AB10-5A5025183950.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Querying TLD Policy Data
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44">
  <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2404116 id2404372 id2404380 id2404434 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-C0D38954-2FC5-4E8B-BC11-229464DCF16C.html">
      High Level Internet Protocols Guide
     </a>
     &gt;
     <a href="GUID-939C0EE6-0931-4898-842B-9D0C9D61DD2F.html">
      Application Layer Plugins and Utils
     </a>
     &gt;
     <a href="GUID-C0E7CBC4-C525-4CA8-8D21-E7E2ABE396CE.html">
      URI Permission Services
     </a>
     &gt;
     <a href="GUID-945FAA13-A302-55F5-917C-EAD2C9D960E9.html">
      WhiteList/BlackList TLD Services
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Querying
TLD Policy Data
    </h1>
    <div>
     <p>
      This document explains how to retrieve the characters from the
Top-Level Domain Blacklists and Whitelists.
     </p>
     <div class="p" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-67B2BC51-7D62-4A5D-84A4-259F645FBF3D">
      <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-67B2BC51-7D62-4A5D-84A4-259F645FBF3D">
       <!-- -->
      </a>
      <p>
       Before you start, you must:
      </p>
      <ul>
       <li id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-1EE28078-9695-5F4E-AFBA-18B2E31B4994">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-1EE28078-9695-5F4E-AFBA-18B2E31B4994">
         <!-- -->
        </a>
        <p>
         Be familiar with the
concepts of Top-Level Domain (TLD) and International Domain Name (IDN): see
         <a href="GUID-6A78F618-09A9-56A7-8C58-98C353BF0788.html" title="The Domain Name Server (DNS) identifies the Internet servers based on the host names. This topic describes the concept of the DNS.">
          What is the Domain Name Server
         </a>
         .
        </p>
       </li>
      </ul>
     </div>
     <div class="section" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-7778FEFB-9E66-4C3F-8102-2A20F705B058">
      <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-7778FEFB-9E66-4C3F-8102-2A20F705B058">
       <!-- -->
      </a>
      <p>
       The TLD policy data is composed of a list of TLDs.
      </p>
      <p>
       For
each of the TLDs, the Whitelist contains the trusted UTF-8 characters and
the Blacklist contains the suspect UTF-8 characters.
      </p>
     </div>
     <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-DD346F2F-33BE-5510-866D-B8F2B9748EA6">
      <!-- -->
     </a>
     <ol id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-DD346F2F-33BE-5510-866D-B8F2B9748EA6">
      <li class="stepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-567ECE81-C1EF-56A0-9654-9AB1151183D2">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-567ECE81-C1EF-56A0-9654-9AB1151183D2">
        <!-- -->
       </a>
       <span>
        Create a connection
with the InetURIList server.
       </span>
       <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-9F4059C8-89C9-5528-A75D-0F6DF59B7615">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-9F4059C8-89C9-5528-A75D-0F6DF59B7615">
         <!-- -->
        </a>
        RInetUriList uriServer;
uriServer.OpenL();
CleanupClosePushL(uriServer);
       </pre>
      </li>
      <li class="stepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-D0A705EA-1A7E-56E3-A3A8-8CC6A9AA1820">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-D0A705EA-1A7E-56E3-A3A8-8CC6A9AA1820">
        <!-- -->
       </a>
       <span>
        Build a
        TPolicyQueryArgs
        object.
       </span>
       The constructor takes an URI as its first parameter, which defines which
TLD the request is made on.
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-4AE60DE9-963C-5093-AF74-CB634EBA1A41">
        <!-- -->
       </a>
       <ol type="a" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-4AE60DE9-963C-5093-AF74-CB634EBA1A41">
        <li class="substepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-C83724BE-BE79-59A9-B7A2-A6434CA95F2B">
         <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-C83724BE-BE79-59A9-B7A2-A6434CA95F2B">
          <!-- -->
         </a>
         <span>
          <br />
          To request a character set, pass the list type (
          InetUriList::EWhiteList
          or
          InetUriList::EBlackList
          )
as the second parameter, and the
          InetUriList::EPolicyCharSet
          request
type as the third parameter.
         </span>
         <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-DCB3AB91-32D8-5666-8DD3-3280129A6E93">
          <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-DCB3AB91-32D8-5666-8DD3-3280129A6E93">
           <!-- -->
          </a>
          // The TLD is "COM"
_LIT8(KUri, "http://www.nokia.com");

// the query requests the white list character set
TPolicyQueryArgs tldArgs(KUri, InetUriList::EWhiteList, InetUriList::EPolicyCharSet);
         </pre>
        </li>
        <li class="substepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-3BCB0DC7-CE81-5978-B9DB-1BA9CF00245D">
         <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-3BCB0DC7-CE81-5978-B9DB-1BA9CF00245D">
          <!-- -->
         </a>
         <span>
          <br />
          To check whether an URI is unsafe, only pass the
          InetUriList::EPolicyListType
          request
type as the second parameter.
         </span>
         <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-3AAE8443-F7EF-581F-BF6D-1F66D8B6608D">
          <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-3AAE8443-F7EF-581F-BF6D-1F66D8B6608D">
           <!-- -->
          </a>
          // The TLD is "COM"
_LIT8(KUri, "http://www.nokia.com");

// the query requests to check the URI
TPolicyQueryArgs tldArgs(KUri, InetUriList::EPolicyListType);
         </pre>
        </li>
       </ol>
      </li>
      <li class="stepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-A616A748-8962-5CC0-A5F9-A5E97BA30BC1">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-A616A748-8962-5CC0-A5F9-A5E97BA30BC1">
        <!-- -->
       </a>
       <span>
        Create a
        TQueryResults
        object
to store the result.
       </span>
       <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-0C52490F-6D74-542B-89DC-B9DFD2012538">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-0C52490F-6D74-542B-89DC-B9DFD2012538">
         <!-- -->
        </a>
        TQueryResults tldResult;
       </pre>
      </li>
      <li class="stepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-27E11482-72C6-5645-A381-B96843E522A6">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-27E11482-72C6-5645-A381-B96843E522A6">
        <!-- -->
       </a>
       <span>
        Call the
        RInetUriList::QueryTldInfoL()
        method
with your query and result structures.
       </span>
       <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-E7CCF168-823A-5458-AEB8-3DFFC40384FB">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-E7CCF168-823A-5458-AEB8-3DFFC40384FB">
         <!-- -->
        </a>
        RInetUriList::QueryTldInfoL(tldArgs, tldResult);

// retrieve the characters
HBufC8* policyData(NULL);
policydata = tldResult.CharSetL();
       </pre>
      </li>
      <li class="stepexpand" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-1D67B3E0-3AC6-5829-A691-9DFA6C7B34DC">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-1D67B3E0-3AC6-5829-A691-9DFA6C7B34DC">
        <!-- -->
       </a>
       <span>
        Close the connection
with the InetURIList server.
       </span>
       <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-A0BD5890-3D52-5A0A-B3AD-A02FD886B22C">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-A0BD5890-3D52-5A0A-B3AD-A02FD886B22C">
         <!-- -->
        </a>
        CleanupStack::PopAndDestroy(&amp;uriServer);
       </pre>
      </li>
     </ol>
     <div class="section" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-F79600BE-2553-4671-996E-2CA93480C3D7">
      <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-F79600BE-2553-4671-996E-2CA93480C3D7">
       <!-- -->
      </a>
      <p>
       The
       <samp class="codeph">
        TQueryResults
       </samp>
       object contains the requested
TLD policy data.
      </p>
      <ul>
       <li id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-92BF741E-4764-59AB-81C2-8680F71EA4EF">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-92BF741E-4764-59AB-81C2-8680F71EA4EF">
         <!-- -->
        </a>
        <p>
         With an
         <samp class="codeph">
          EPolicyListType
         </samp>
         request,
the results objet contains
         <samp class="codeph">
          ETrue
         </samp>
         is the URI contains suspect
characters,
         <samp class="codeph">
          EFalse
         </samp>
         otherwise.
        </p>
       </li>
       <li id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-846E962F-3AF4-5A45-8B8E-BBB7B4F8B07B">
        <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-846E962F-3AF4-5A45-8B8E-BBB7B4F8B07B">
         <!-- -->
        </a>
        <p>
         An
         <samp class="codeph">
          EPolicyCharSet
         </samp>
         request,
the results objet contains the list of characters of the requested list.
        </p>
       </li>
      </ul>
     </div>
     <div class="example" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-8D5A4D7A-C9C9-5F16-8DE0-94212B7131F3">
      <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-8D5A4D7A-C9C9-5F16-8DE0-94212B7131F3">
       <!-- -->
      </a>
      <h2 class="sectiontitle">
       Query example
      </h2>
      <p>
       Here
is the combination of the code snippets provided in the above steps:
      </p>
      <pre class="codeblock" id="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-5E01A904-0BAD-571F-9DBB-486154D9DE04">
       <a name="GUID-E97C2A7E-8E8F-58E6-99D4-288589385B44__GUID-5E01A904-0BAD-571F-9DBB-486154D9DE04">
        <!-- -->
       </a>
       // Open the connection
RInetUriList uriServer;
uriServer.OpenL();
CleanupClosePushL(uriServer);

// The TLD is "COM"
_LIT8(KUri, "http://www.nokia.com");

// Build a query requesting a character set
TPolicyQueryArgs tldArgs(KUri, InetUriList::EPolicyCharSet);

// Create an object for the results
TQueryResults tldResult;

// Make the query
RInetUriList::QueryTldInfoL(tldArgs, tldResult);

// retrieve the characters
HBufC8* policyData(NULL);
policydata = tldResult.CharSetL();

// [...] 
// process the policy data

// Close the connection
CleanupStack::PopAndDestroy(&amp;uriServer);
      </pre>
     </div>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-945FAA13-A302-55F5-917C-EAD2C9D960E9.html">
        WhiteList/BlackList TLD Services
       </a>
      </div>
     </div>
     <div class="relinfo relconcepts">
      <strong>
       Related concepts
      </strong>
      <br />
      <div>
       <a href="GUID-EDA831F7-7248-5C00-B6BE-B7F44097C9B6.html" title="This document introduces the Whitelist/Blacklist Top-Level Domain services of the InetURIList framework.">
        WhiteList/BlackList
TLD Overview
       </a>
      </div>
     </div>
     <div class="relinfo reltasks">
      <strong>
       Related tasks
      </strong>
      <br />
      <div>
       <a href="GUID-AC4C18D1-D6A3-5988-AB10-5A5025183950.html" title="This document explains how to update the TLD character lists.">
        Modifying
TLD Policy Data
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>