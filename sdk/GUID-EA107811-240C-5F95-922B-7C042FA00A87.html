<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="task" />
  <meta name="DC.Title" content="Reading a String Resource" />
  <meta name="DC.Relation" scheme="URI" content="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-D02B5AF1-B1C3-560D-9654-971A5CC1A904.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-C8BD333E-8384-534B-822B-F61B2F7C8B9F.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-EA107811-240C-5F95-922B-7C042FA00A87" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Reading a String Resource
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-EA107811-240C-5F95-922B-7C042FA00A87">
  <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2682564 id2396835 id2397069 id2397083 id2397157 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html">
      Generic OS Services Guide
     </a>
     &gt;
     <a href="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html">
      Low Level Libraries and Frameworks
     </a>
     &gt;
     <a href="GUID-D02B5AF1-B1C3-560D-9654-971A5CC1A904.html">
      Application Utilities
     </a>
     &gt;
     <a href="GUID-C8BD333E-8384-534B-822B-F61B2F7C8B9F.html">
      Basic Application Framework Library
     </a>
     &gt;
     <a href="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30.html" title="This section explains the tasks that can performed using Basic Application Framework Library.">
      Basic Application Framework Library Tutorials
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Reading a String Resource
    </h1>
    <div>
     <div>
      <p>
       The simplest use of a resource file involves reading
string resources and interpreting the source data.
      </p>
     </div>
     <div class="section" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-FD651A99-73F0-4CDD-9B4F-7C3A1DE8C4BE">
      <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-FD651A99-73F0-4CDD-9B4F-7C3A1DE8C4BE">
       <!-- -->
      </a>
      <p>
       Resources are defined in terms of structs which are accessed
and read by the
       <a href="GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html">
        <span class="apiname">
         RResourceFile
        </span>
       </a>
       class, and interpreted
by the
       <a href="GUID-B375D32E-1F91-30FA-8605-A2E163111F9A.html">
        <span class="apiname">
         TResourceReader
        </span>
       </a>
       . An application may also
use resources from multiple files simultaneously. See
       <a href="GUID-98903A01-CD04-5345-84AE-2E440CE06E11.html">
        Resource File examples
       </a>
       for more information.
      </p>
      <p>
       Consider a sample resource file where
a struct of STRING is defined having a single member of type
       <samp class="codeph">
        LTEXT
       </samp>
       :
      </p>
      <pre class="codeblock">
       // define structures
STRUCT STRING
    {
    LTEXT text;
    }
// define resources
RESOURCE STRING hello
    {
    text=Bonjour tout le monde!;
    }
      </pre>
     </div>
     <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-F147E8CF-65D1-5025-BA85-E0D171DBEFFD">
      <!-- -->
     </a>
     <ol id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-F147E8CF-65D1-5025-BA85-E0D171DBEFFD">
      <li class="stepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-0BAEB54B-5A6E-59F6-B14E-FAF0A3D15F27">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-0BAEB54B-5A6E-59F6-B14E-FAF0A3D15F27">
        <!-- -->
       </a>
       <span>
        <br />
        Compile the resource file using the resource compiler (rcomp)
to generate an
        <span class="filepath">
         .rsc
        </span>
        file and an
        <span class="filepath">
         .rsg
        </span>
        file.
       </span>
       <p>
        For information on resource compiler, see
        <strong>
         Symbian^3 Tools
Guide &gt; Building
        </strong>
        .
       </p>
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-0B421705-A5CD-5FF7-BB95-C17559811267">
        <!-- -->
       </a>
       <ol type="a" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-0B421705-A5CD-5FF7-BB95-C17559811267">
        <li class="substepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-673E32C9-665C-5388-AE17-780A149F8837">
         <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-673E32C9-665C-5388-AE17-780A149F8837">
          <!-- -->
         </a>
         <span>
          <br />
          <span class="filepath">
           .rsc
          </span>
          file contains the resource data;
this is the resource file that must be referred to at run-time by
the
          <samp class="codeph">
           RResourceFile
          </samp>
          class in the C++ code.
         </span>
        </li>
        <li class="substepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-AEE254EB-0716-5478-B1DF-F8ED8E4FF8E1">
         <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-AEE254EB-0716-5478-B1DF-F8ED8E4FF8E1">
          <!-- -->
         </a>
         <span>
          <br />
          <span class="filepath">
           .rsg
          </span>
          file is a
          <span class="keyword">
           generated    
                 header
          </span>
          file that contains
          <samp class="codeph">
           #define
          </samp>
          statements for each resource defined in the source file. In the
resource file generated here, the only resource is called
          <samp class="codeph">
           hello
          </samp>
          and the generated header file contains:
         </span>
         <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-385BB8E3-FF77-5A95-8F65-043E72412959">
          <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-385BB8E3-FF77-5A95-8F65-043E72412959">
           <!-- -->
          </a>
          #define HELLO 1
         </pre>
         Note that the name in the generated header file is converted
to upper case.
        </li>
       </ol>
      </li>
      <li class="stepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-3367B1DD-C2E9-5780-A77A-7F574D2EC541">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-3367B1DD-C2E9-5780-A77A-7F574D2EC541">
        <!-- -->
       </a>
       <span>
        <br />
        <samp class="codeph">
         #include
        </samp>
        the
        <span class="filepath">
         .rsg
        </span>
        file
in the file containing the C++ code, to access the resource IDs generated
by the resource compiler. For example, for a project refered as
        <samp class="codeph">
         ReadText
        </samp>
        , this might be:
       </span>
       <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-AC615F67-6331-500C-B91E-ADD6A94464FB">
        <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-AC615F67-6331-500C-B91E-ADD6A94464FB">
         <!-- -->
        </a>
        #include ReadText.rsg
       </pre>
      </li>
      <li class="stepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-ACC66DA2-4AC8-536B-9912-7CE632C0A8DF">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-ACC66DA2-4AC8-536B-9912-7CE632C0A8DF">
        <!-- -->
       </a>
       <span>
        <br />
        Initialize the
        <samp class="codeph">
         RResourceFile
        </samp>
        object in the
C++ program, specifying the name of the resource file:
       </span>
       <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-5CF79231-E42C-51DF-9002-FD1ED8AB21C1">
        <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-5CF79231-E42C-51DF-9002-FD1ED8AB21C1">
         <!-- -->
        </a>
        RResourceFile resourceFile;
resourceFile.OpenL( fsSession,_L( Z:\\system\\data\\ReadText.rsc ) );
       </pre>
       Note: To access the resource file contents, a session with the
file server must be started using an instance of
       <a href="GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html">
        <span class="apiname">
         RFs
        </span>
       </a>
       class.
      </li>
      <li class="stepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-CA53A8D1-E13E-50A8-96A7-B6B397B82DB3">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-CA53A8D1-E13E-50A8-96A7-B6B397B82DB3">
        <!-- -->
       </a>
       <span>
        <br />
        Use one of the three functions (
        <a href="GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html#GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA__GUID-9B16E6B8-84A4-37DF-BBB4-EC8B04FDB14C">
         <span class="apiname">
          RResourceFile::AllocReadLC()
         </span>
        </a>
        ,
        <a href="GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html#GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA__GUID-8CEE29E0-78F3-3DD6-B068-85C8E0403884">
         <span class="apiname">
          RResourceFile::AllocReadL()
         </span>
        </a>
        or
        <a href="GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA.html#GUID-AA6DEF11-6F23-3523-A9F7-F15DF918E1BA__GUID-DF6DFFD5-E923-3C4E-87F0-BC4EE7C8B586">
         <span class="apiname">
          RResourceFile::ReadL()
         </span>
        </a>
        to read a resource as shown in the following code fragment:
       </span>
       <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-92AC4270-4A4D-52F1-B5C4-CFF6FBD19700">
        <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-92AC4270-4A4D-52F1-B5C4-CFF6FBD19700">
         <!-- -->
        </a>
        HBufC8* dataBuffer = resourceFile.AllocReadLC( HELLO );
       </pre>
      </li>
      <li class="stepexpand" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-77F9A976-6E09-5158-B515-256F4B878CDB">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-77F9A976-6E09-5158-B515-256F4B878CDB">
        <!-- -->
       </a>
       <span>
        <br />
        Interpret the resource data using a
        <samp class="codeph">
         TResourceReader
        </samp>
        object. This provides access to the text string through a pointer
descriptor as shown in the following code fragment:
       </span>
       <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-CB3BE44D-72F5-5E15-8D1D-52F513D9D980">
        <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-CB3BE44D-72F5-5E15-8D1D-52F513D9D980">
         <!-- -->
        </a>
        TResourceReader theReader;
...
theReader.SetBuffer( datafBuffer );
TPtrC textdata = reader.ReadTPtrC();
       </pre>
      </li>
     </ol>
     <div class="section" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-565451D8-6C9E-4F1C-BC15-BFA4F3DD6D1D">
      <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-565451D8-6C9E-4F1C-BC15-BFA4F3DD6D1D">
       <!-- -->
      </a>
      <p>
       In this example, once the resource data is no longer needed,
the heap descriptor, dataBuffer, can be removed from the cleanup stack
and destroyed as shown in the code fragment:
      </p>
      <pre class="codeblock">
       CleanupStack::PopAndDestroy();
      </pre>
      <p>
       When all operations on the resource file are complete, the resource
file can be closed using the RResourceFile::close() function as:
      </p>
      <pre class="codeblock">
       resourceFile.Close();
      </pre>
     </div>
     <div class="example">
      <h2 class="sectiontitle">
       Example
      </h2>
      <p>
       Consider a resource constructed
from the following definition.
      </p>
      <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-538D959C-A85A-5675-9B14-ED81AB860F47">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-538D959C-A85A-5675-9B14-ED81AB860F47">
        <!-- -->
       </a>
       RESOURCE ARRAY anarray
{
items=
    {
    LBUF { txt="Esc"; },
    LBUF { txt="Enter"; },
    LBUF { txt="Tab"; },
    LBUF { txt="Del"; },
    LBUF { txt="Space"; }
    };
}
      </pre>
      <p>
       A
       <samp class="codeph">
        TPtrC
       </samp>
       representing the second
item can be constructed using the
       <samp class="codeph">
        ReadTPtrC()
       </samp>
       function.
The example simply takes the length of the text
       <samp class="codeph">
        Enter
       </samp>
       :
      </p>
      <pre class="codeblock" id="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-9817910D-0661-513D-BB3A-9557D70688AD">
       <a name="GUID-EA107811-240C-5F95-922B-7C042FA00A87__GUID-9817910D-0661-513D-BB3A-9557D70688AD">
        <!-- -->
       </a>
       // open the resource file
...
HBufC8* res = resourceFile.AllocReadLC( ANARRAY );
TResourceReader theReader;
...
TInt len;
len = ( theReader.ReadTPtrC( 1,res ) ).Length(); // len == 5
...
      </pre>
     </div>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-85AA0FD4-3BD1-50A7-B241-AE3908ACCF30.html" title="This section explains the tasks that can performed using Basic Application Framework Library.">
        Basic Application Framework Library Tutorials
       </a>
      </div>
     </div>
     <div class="relinfo relconcepts">
      <strong>
       Related concepts
      </strong>
      <br />
      <div>
       <a href="GUID-3AF1F492-3D7D-5F8C-B1AE-16FBD8224775.html">
        Resource
files
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>