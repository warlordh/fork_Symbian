<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="task" />
  <meta name="DC.Title" content="Receiving Data from Sensors" />
  <meta name="abstract" content="You can implement a data listener to receive data from the sensors. Based on the data received, you can perform specific actions on the Symbian device. For example, if you receive information from the sensor about the distance between the device and the user then based on this information, you can disable or enable the loudspeaker mode on the Symbian device." />
  <meta name="description" content="You can implement a data listener to receive data from the sensors. Based on the data received, you can perform specific actions on the Symbian device. For example, if you receive information from the sensor about the distance between the device and the user then based on this information, you can disable or enable the loudspeaker mode on the Symbian device." />
  <meta name="DC.Relation" scheme="URI" content="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-F8C8CE42-E7C9-5AFC-86BC-B78F677F1B05.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-E3ADCC42-ACFC-49FC-88FF-8196CE61014B.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-9102DB10-3B93-4E79-9125-25791CEEBEFB.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   Receiving Data from Sensors
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231">
  <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2838663 id2839278 id2839334 id2839196 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-F8C8CE42-E7C9-5AFC-86BC-B78F677F1B05.html">
      Device Services Guide
     </a>
     &gt;
     <a href="GUID-E3ADCC42-ACFC-49FC-88FF-8196CE61014B.html" title="The Sensors Services collection provides Sensors Framework, which allows clients to request and receive sensor information from the different sensors on a device.">
      Sensor Services
     </a>
     &gt;
     <a href="GUID-9102DB10-3B93-4E79-9125-25791CEEBEFB.html" title="Sensors Framework provides a framework for creating plug-ins and connecting client applications with the sensor hardware.">
      Sensors Framework
     </a>
     &gt;
     <a href="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html" title="The Sensor Channel establishes a data exchange connection between the sensor framework and hardware using the sensor channel APIs.">
      Using Sensor Channels APIs
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     Receiving
Data from Sensors
    </h1>
    <div>
     <p>
      You can implement a data listener to receive data from the sensors.
Based on the data received, you can perform specific actions on the Symbian
device. For example, if you receive information from the sensor about the
distance between the device and the user then based on this information, you
can disable or enable the loudspeaker mode on the Symbian device.
     </p>
     <div class="p" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-E09C6ABC-F717-4791-A2EE-491421D2BD30">
      <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-E09C6ABC-F717-4791-A2EE-491421D2BD30">
       <!-- -->
      </a>
      <p>
       Before listening
for sensor channel data, you must
       <a href="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html#GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B__GUID-FBBD3A8B-F240-4DC0-B516-3A51FDD86A88">
        open
the sensor channel
       </a>
       .
      </p>
     </div>
     <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-1-10-1-11-1-1-6-1-4-1-4-1-5-1-3-2">
      <!-- -->
     </a>
     <ol id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-1-10-1-11-1-1-6-1-4-1-4-1-5-1-3-2">
      <li class="stepexpand" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-CE0EE6EE-84A7-46F6-8590-C75FAA381843">
       <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-CE0EE6EE-84A7-46F6-8590-C75FAA381843">
        <!-- -->
       </a>
       <span>
        Implement the data
listener.
       </span>
       <p>
        Inherit from the
        <span class="parmname">
         MSensrvDataListener
        </span>
        interface
and implement the following pure virtual functions:
        <a href="GUID-519E744E-246C-3F4A-A869-F25B03F1126F.html#GUID-519E744E-246C-3F4A-A869-F25B03F1126F__GUID-92EDE76E-F5D8-3D45-939B-FD5C03347AE8">
         <span class="apiname">
          MSensrvDataListener::DataReceived
         </span>
        </a>
        ,
        <a href="GUID-519E744E-246C-3F4A-A869-F25B03F1126F.html#GUID-519E744E-246C-3F4A-A869-F25B03F1126F__GUID-F6C22940-A276-38C2-890F-CA45B75D613F">
         <span class="apiname">
          MSensrvDataListener::DataError
         </span>
        </a>
        and
        <a href="GUID-519E744E-246C-3F4A-A869-F25B03F1126F.html#GUID-519E744E-246C-3F4A-A869-F25B03F1126F__GUID-4062844D-2F25-38FC-B91A-DD5B41E6FF3F">
         <span class="apiname">
          MSensrvDataListener::GetDataListenerInterfaceL
         </span>
        </a>
       </p>
       <pre class="codeblock">
        class DataListener:public MSensrvDataListener
    {
    public:
        void DataReceived(CSensrvChannel&amp; aChannel, TInt aCount, TInt aDataLost )
        {
        ...
         //Implementation
        }
    void DataError( CSensrvChannel&amp;, TSensrvErrorSeverity)
        {
        ...
         //Implementation
        }
    void GetDataListenerInterfaceL( TUid, TAny*&amp;)
        {
        ...
         //Implementation
        }
    };
       </pre>
      </li>
      <li class="stepexpand" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-107B26D8-CD5A-4571-8441-F1A5A2C0EB2B">
       <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-107B26D8-CD5A-4571-8441-F1A5A2C0EB2B">
        <!-- -->
       </a>
       <span>
        Start data listening.
       </span>
       <p>
        Pass an instance of data listener implementation using the
        <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-F851A108-C72F-3132-BE15-DC41CACB64F9">
         <span class="apiname">
          CSensrvChannel::StartDataListeningL()
         </span>
        </a>
        function.
       </p>
       <pre class="codeblock">
        //Instance of the data listener implementation
DataListener dataListener; 
...
CSensrvChannel* channel;
...
channel-&gt;StartDataListeningL(&amp;dataListener, 1, 1, 0);
...
       </pre>
       <p>
        When new data is available to be read in the sensor channel,
the client is notified by the
        <a href="GUID-519E744E-246C-3F4A-A869-F25B03F1126F.html#GUID-519E744E-246C-3F4A-A869-F25B03F1126F__GUID-7EE31046-31A6-356E-AFEF-2E8C003A7F15">
         <span class="apiname">
          MSensrvDataListener::DataReceived(CSensrvChannel
&amp;,TInt,TInt)
         </span>
        </a>
        callback function. The channel data is received
into the receiving buffer. The receiving buffer is allocated from the heap
in the client's thread and its size is the channel data item size multiplied
by the maximum number of data items.
       </p>
      </li>
      <li class="stepexpand" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-40F9F566-475E-4ECD-B420-70EB1B77DEAA">
       <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-40F9F566-475E-4ECD-B420-70EB1B77DEAA">
        <!-- -->
       </a>
       <span>
        Read the channel
data from the receiving buffer using the
        <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-EC1AF564-F05D-3729-B0C9-7573A1F79B86">
         <span class="apiname">
          CSensrvChannel::GetData()
         </span>
        </a>
        function.
For more information about handling data notifications, see the following
        <a href="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231.html#GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__5876a529-0484-497d-8cf8-9ceb9c725388">
         Example
        </a>
        .
       </span>
      </li>
      <li class="stepexpand" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-D3928C98-3D10-40BE-A63E-584969AA0416">
       <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-D3928C98-3D10-40BE-A63E-584969AA0416">
        <!-- -->
       </a>
       <span>
        After you get the
required sensor data feeds from the sensor channel, you can stop data listening
using the
        <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-0129F5FA-BD26-37F0-8FE4-19F393AA817C">
         <span class="apiname">
          CSensrvChannel::StopDataListening()
         </span>
        </a>
        function.
       </span>
       <pre class="codeblock">
        channel-&gt;StopDataListening();
       </pre>
      </li>
     </ol>
     <div class="example" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__5876A529-0484-497D-8CF8-9CEB9C725388">
      <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__5876A529-0484-497D-8CF8-9CEB9C725388">
       <!-- -->
      </a>
      <p>
       The following example
shows how to handle the double tapping data notification that is received.
      </p>
      <p>
       Check
the channel type of the received data and then receive the data object using
the
       <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-EC1AF564-F05D-3729-B0C9-7573A1F79B86">
        <span class="apiname">
         CSensrvChannel::GetData()
        </span>
       </a>
       function. The
       <span class="parmname">
        aCount
       </span>
       parameter
provides the details about the number of data objects in the channels receiving
buffer. This number can be zero if the buffering period is used when data
listening is started. The
       <span class="parmname">
        aDataLost
       </span>
       parameter provides
the details about the number of the lost data objects. For example, in heavy
load situations.
      </p>
      <pre class="codeblock">
       void CTestClass::DataReceived( CSensrvChannel&amp; aChannel, 
                               TInt aCount, 
                               TInt aDataLost )
    {
    if ( aChannel.GetChannelInfo().iChannelType == KSensrvChannelTypeIdAccelerometerDoubleTappingData )
        {
        TSensrvTappingData tappingData;
        TPckg &lt;TSensrvTappingData&gt; tappingPackage( tappingData );
        aChannel.GetData( tappingPackage );
        }
    }
      </pre>
     </div>
     <div class="section" id="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-69071DC2-EB41-43BA-8DFC-CE2D4423AF8A">
      <a name="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231__GUID-69071DC2-EB41-43BA-8DFC-CE2D4423AF8A">
       <!-- -->
      </a>
      <p>
       End the session
with the sensor channel using the
       <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-0B8F50A6-2CA1-316A-82AB-AA026005E810">
        <span class="apiname">
         CSensrvChannel::CloseChannel()
        </span>
       </a>
       function.
      </p>
     </div>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html" title="The Sensor Channel establishes a data exchange connection between the sensor framework and hardware using the sensor channel APIs.">
        Using Sensor Channels APIs
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>