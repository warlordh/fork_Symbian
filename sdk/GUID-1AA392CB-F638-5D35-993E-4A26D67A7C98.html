<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="copyright" content="(C) Copyright 2010" />
  <meta name="DC.rights.owner" content="(C) Copyright 2010" />
  <meta name="DC.Type" content="concept" />
  <meta name="DC.Title" content="How to retrieve characteristics" />
  <meta name="DC.Relation" scheme="URI" content="GUID-268E2151-C758-46BF-86EB-F7D6EE44DBCF.html" />
  <meta name="DC.Relation" scheme="URI" content="index.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-5B112A34-1CBA-5B28-A941-27847FC1D30A.html" />
  <meta name="DC.Relation" scheme="URI" content="GUID-268E2151-C758-46BF-86EB-F7D6EE44DBCF.html" />
  <meta name="DC.Format" content="XHTML" />
  <meta name="DC.Identifier" content="GUID-1AA392CB-F638-5D35-993E-4A26D67A7C98" />
  <meta name="DC.Language" content="en" />
  <link rel="stylesheet" type="text/css" href="commonltr.css" />
  <title>
   How to retrieve characteristics
  </title>
  <link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
  <link rel="stylesheet" type="text/css" href="nokiacxxref.css" />
 </head>
 <body id="GUID-1AA392CB-F638-5D35-993E-4A26D67A7C98">
  <a name="GUID-1AA392CB-F638-5D35-993E-4A26D67A7C98">
   <!-- -->
  </a>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
  <div id="sdl_container">
   <div id="leftMenu">
    <div id="expandcontractdiv">
     <a id="collapseTree" href="javascript:tree.collapseAll()">
      Collapse all
     </a>
     <a id="index" href="index.html">
      Symbian^3 Application Developer Library
     </a>
    </div>
    <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">
     &#160;
    </div>
    <script type="text/javascript">
     var currentIconMode = 0; window.name="id2470542 id2387653 id2387924 id2387985 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
   </div>
   <div id="sdl_content">
<div class="breadcrumb">
     <a href="index.html" title="Symbian^3 Application Developer Library">
      Symbian^3 Application Developer Library
     </a>
     &gt;
     <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">
      Symbian Guide
     </a>
     &gt;
     <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">
      OS Security Guide
     </a>
     &gt;
     <a href="GUID-5B112A34-1CBA-5B28-A941-27847FC1D30A.html">
      Cryptography overview
     </a>
     &gt;
     <a href="GUID-268E2151-C758-46BF-86EB-F7D6EE44DBCF.html" title="This section provides detailed information on encrypting and decrypting data using Symmetric and Asymmetric algorithms supported by Symbian platform.">
      Encrypting and Decrypting Data
     </a>
     &gt;
    </div>
    <h1 class="topictitle1">
     How
to retrieve characteristics
    </h1>
    <div>
     <p>
      The following example demonstrates the use of the legacy selector to retrieve
the characteristics of an asymmetric cipher object. In the example, an implementation
object is constructed (making use of an RSA Key Pair also generated by the
framework) and returned. The plug-in characteristics and extended characteristics
associated with the object are then accessed.
     </p>
     <pre class="codeblock" id="GUID-1AA392CB-F638-5D35-993E-4A26D67A7C98__GUID-CF2DF77C-90BD-56A0-A27D-89C4DA18EDCD">
      <a name="GUID-1AA392CB-F638-5D35-993E-4A26D67A7C98__GUID-CF2DF77C-90BD-56A0-A27D-89C4DA18EDCD">
       <!-- -->
      </a>
      #include &lt;cryptoasymmetriccipherapi.h&gt;
#include &lt;cryptokeypairgeneratorapi.h&gt;
#include &lt;cryptospidef.h&gt;
#include &lt;plugincharacteristics.h&gt;
#include &lt;extendedcharacteristics.h&gt;
#include &lt;keypair.h&gt;

// Constant definition for the RSA key pair generator exponent value
const TInt KKeyExponent = 65537;

using namespace CryptoSpi;

// Create a new CCryptoParams instance to contain the RSA Key Pair initialization data
CCryptoParams* keyParams = CCryptoParams::NewLC(); 
                    
// Create an RSA Key Pair and Key Pair Generator object pointers
CKeyPair* keyPair = NULL;
CKeyPairGenerator * keypairImpl = NULL;                
                
// Set the RSA Key Pair Generator initialization parameters reate an RSA key pair
keyParams-&gt;AddL(KKeyExponent, KRsaKeyParameterEUid);
keyParams-&gt;AddL(KRsaPrivateKeyStandard, KRsaKeyTypeUid);

// Retrieve an instance of an RSA Key Pair Generator implementation from the framework
CKeyPairGeneratorFactory::CreateKeyPairGeneratorL( keypairImpl,
                                                   KRSAKeyPairGeneratorUid,
                                                   keyParams);
                                            
CleanupStack::PushL(keypairImpl);
    
// Create an RSA Key Pair    
keypairImpl-&gt;GenerateKeyPairL(1024, *keyParams, keyPair);
                
CleanupStack::PushL(keyPair);
                                        
// Create and initialize a pointer for the asymmetric cipher implementation object        
CAsymmetricCipher* asymmetricCipherImpl = NULL;

// If successful, the 'CreateAsymmetricCipherL' method returns KErrNone and sets the 
// asymmetricCipherImpl pointer to point to the constructed implementation
TRAPD(err, CAsymmetricCipherFactory::CreateAsymmetricCipherL(asymmetricCipherImpl,
                                                             KRsaCipherUid,
                                                             keyPair-&gt;PrivateKey(),
                                                             KCryptoModeEncryptUid,
                                                             KPaddingModeNoneUid,
                                                             NULL));

// Having successfully constructed the asymmetric cipher implementation object, 
// it is possible to retrieve the plug-in characteristics associated with it
if (asymmetricCipherImpl &amp;&amp; (err == KErrNone))
 {
 CleanupStack::PushL(asymmetricCipherImpl);

 // Retrieving common and algorithm-specific characteristics
 // Create a constant pointer of type TCharacteristics used to access the
 // asymmetric cipher plug-in's common and algorithm-specific characteristics
    const TCharacteristics* chars(NULL);

 // Retrieve the common and algorithm-specific characteristics by calling the
 // 'GetCharacteristicsL' method passing in TCharacteristics pointer
 asymmetricCipherImpl-&gt;GetCharacteristicsL(chars);

 // Static cast the characteristics to type TAsymmetricCipherCharacteristics
 const TAsymmetricCipherCharacteristics* asymmetricChars = 
  static_cast&lt;const TAsymmetricCipherCharacteristics*&gt;(chars);

 // Retrieve the common characteristics from the TASymmetricCipherCharacteristics
 // object
 const TCommonCharacteristics* asymmetricCommonChars = &amp;asymmetricChars-&gt;cmn;

    TUid implementationId;
    TBool hardwareSupported;
    TRomLitC16 creatorName;
    TInt maximumKeyLength;
    TInt32 supportedPaddingModes;

 // Example of extracting asymmetric common characteristics
 implementationId.iUid = asymmetricCommonChars-&gt;iImplementationUID;
 hardwareSupported = asymmetricCommonChars-&gt;iIsHardwareSupported;
 creatorName = *(asymmetricCommonChars-&gt;iCreatorName);

 // Example of extracting asymmetric algorithm specific characteristics
 maximumKeyLength = asymmetricChars-&gt;iMaximumKeyLength;
 supportedPaddingModes = *(asymmetricChars-&gt;iSupportedPaddingModes);

 //Retrieving extended characteristics

 // Create a constant pointer of type CExtendedCharacteristics used to store and
 // access the asymmetric cipher plug-in extended characteristics. Retrieve
 // the data by calling the 'GetExtendedCharacteristicsL' method and store the
 // returned pointer
 const CExtendedCharacteristics* extendedChars =
  asymmetricCipherImpl-&gt;GetExtendedCharacteristicsL();

 // Const casting the pointer to the CExtendedCharacteristics object allows it to
 // be pushed onto the cleanup stack
 CExtendedCharacteristics* ncExtendedChars =
  const_cast&lt;CExtendedCharacteristics*&gt;(extendedChars);
 CleanupStack::PushL(ncExtendedChars);

 TInt concurrency;

 // Each of the extended characteristics for the particular cryptographic
 // implementation can then be accessed by passing the UID value into the
 // appropriate 'Get' method
 concurrency = extendedChars-&gt;GetTIntCharacteristicL(KConcurrencyTypeUid);
 // Alternatively, extended characteristic retrieval can be achieved via the
 // ListExtendedCharacteristics() method of the CExtendedCharacteristics Object.
 // Using the 'ListExtendedCharacteristics' function returns a pointer to a
 // CCryptoParams object, that contains a list of all associated extended
 // characteristics
 const CCryptoParams* extendedCryptoParams = 
  extendedChars-&gt;ListExtendedCharacteristics();

 TBool exclusiveUse;

 // The extended characteristics can then be accessed in much the same way as 
 // before, making a call to the appropriate 'Get' method with the UID value of the
 // required type
 exclusiveUse = extendedCryptoParams-&gt;GetTIntL(KExclusiveUseTypeUid);

 CleanupStack::PopAndDestroy(2, asymmetricCipherImpl);
 }

// Pop and destroy the remaining items on the cleanup stack
CleanupStack::PopAndDestroy(3,keyParams);
     </pre>
    </div>
    <div>
     <div class="familylinks">
      <div class="parentlink">
       <strong>
        Parent topic:
       </strong>
       <a href="GUID-268E2151-C758-46BF-86EB-F7D6EE44DBCF.html" title="This section provides detailed information on encrypting and decrypting data using Symmetric and Asymmetric algorithms supported by Symbian platform.">
        Encrypting and Decrypting Data
       </a>
      </div>
     </div>
    </div>
    <p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>
 </body>
</html>