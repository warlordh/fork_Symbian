<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="CAsyncRequest"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-9955168D-20A6-3FCA-8946-6F5338933B67"/>

<title>CAsyncRequest</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-9955168D-20A6-3FCA-8946-6F5338933B67"><a name="GUID-9955168D-20A6-3FCA-8946-6F5338933B67"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2578593 id2487220 id2488660 id2488966 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">CAsyncRequest Class Reference</h1>
	<table class="signature"><tr><td>class CAsyncRequest : public CActive</td></tr></table><div class="section"><div>
			<p>An outstanding request on the server side. A subclass should be created for each type of outstanding request.</p>

			<p>This class is implemented as an active object, because it is anticipated that some asynchronous requests can be implemented simply by completing the client request when a <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html#GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646">TRequestStatus</a> completes. The implementor can override this behavior by re-implementing RunL, e.g. to free some resources before completing the request. If they do so, they must call CompleteAndMarkForDeletion to complete the client request and mark this object for deletion (alternatively they can simply call <a href="GUID-9955168D-20A6-3FCA-8946-6F5338933B67.html#GUID-B6030E80-A6D6-35A7-8DF7-6458962B6464">CAsyncRequest::RunL</a> from their RunL).</p>

			<p>This class cannot, however, anticipate the cancellation mechanism. The implementor must implement DoCancel for that. DoCancel should not delete the client request or mark this object for deletion.</p>

			<p>When the implementor has allocated an instance of this class, they must add it to the session by calling <a href="GUID-9955168D-20A6-3FCA-8946-6F5338933B67.html#GUID-2CB924D0-9B9B-39E0-95D7-244C60596883">CAsyncRequest::TransferToScsFrameworkL</a>. The second-phase constructor must not leave between that and calling SetActive.</p>

			<p>These objects are cancelled and destroyed when the client-side session / subsession sends a cancel command.</p>

			<p>CScsSession::AddAsyncRequestL </p>

		</div></div>
<div class="section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">CAsyncRequest<ul class="derivation"><li class="derivation-depth-1 "><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive</a><ul class="derivation"><li class="derivation-depth-2 "><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase</a></li></ul></li></ul></li></ul></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"/><td><a href="#GUID-222FD50B-16A2-3BC6-9E8A-8DC53DF09DD0">CAsyncRequest</a>(<a href="GUID-05B8B8DB-E65B-39C7-8369-5366395071DF.html">CScsSession</a> *, <a href="GUID-D8941F20-7A00-32D1-8DE2-4B7A9F4A0E40.html">CScsSubsession</a> *, const <a href="GUID-D7D422D3-65E5-378B-8F52-6485BC5603A0.html">RMessage2</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-6C858B9B-74FF-3EB8-88CC-7F28DF1EC1B1">CancelCompleteAndMarkForDeletion</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-0E2C19B2-6325-32A4-99C5-59300008CBE7">DoCleanup</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-365B3617-7E02-3202-9EE8-2B6063F29E59">MarkForDeletion</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-2CB924D0-9B9B-39E0-95D7-244C60596883">TransferToScsFrameworkL</a>()</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Protected Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-B24AC6FE-A933-3032-B7DB-7F3610038DB2">CompleteAndMarkForDeletion</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-2AE6B5A1-06D2-3F93-88C8-49A27B5242F8">RunError</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-B6030E80-A6D6-35A7-8DF7-6458962B6464">RunL</a>()</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::CActive(TInt)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Cancel()</a></td></tr><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Deque()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::DoCancel()</a></td></tr><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Extension_(TUint,TAny *&amp;,TAny *)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::IsActive()const</a></td></tr><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::IsAdded()const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Priority()const</a></td></tr><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::SetActive()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::SetPriority(TInt)</a></td></tr><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::~CActive()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::CBase()</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::Delete(CBase *)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TAny *)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave,TUint)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TUint)</a></td></tr><tr><td> </td><td><a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::~CBase()</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Enumerations</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive:TPriority</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Public Attributes</th></tr></thead><tbody><tr><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td><a href="#GUID-F0B5C726-1537-3CBF-A01D-AA5BF1A8F4EC">iFunction</a></td></tr><tr class="bg"><td align="right" valign="top">const <a href="GUID-78E0DEDD-C020-3174-AD0A-E4C18C4C9213.html">RMessagePtr2</a></td><td><a href="#GUID-A4ABFAC3-B5C9-38F6-BA1F-05E09E442273">iMessagePtr2</a></td></tr><tr><td align="right" valign="top">
					<a href="GUID-05B8B8DB-E65B-39C7-8369-5366395071DF.html">CScsSession</a> *</td><td><a href="#GUID-87D4C0BB-3C41-37C3-A41F-DEF282B79EC1">iSession</a></td></tr><tr class="bg"><td align="right" valign="top">
					<a href="GUID-D8941F20-7A00-32D1-8DE2-4B7A9F4A0E40.html">CScsSubsession</a> *</td><td><a href="#GUID-141C471E-88D1-316C-AABC-CC79BC40B7A7">iSubsession</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Attributes</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::iStatus</a></td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Constructor &amp; Destructor Documentation</h1><div class="nested1" id="GUID-222FD50B-16A2-3BC6-9E8A-8DC53DF09DD0"><a name="GUID-222FD50B-16A2-3BC6-9E8A-8DC53DF09DD0"><!-- --></a>
		<h2 class="topictitle2">CAsyncRequest(CScsSession *, CScsSubsession *, const RMessage2 &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C</td><td>CAsyncRequest</td><td>(</td><td><a href="GUID-05B8B8DB-E65B-39C7-8369-5366395071DF.html">CScsSession</a> *</td><td>aSession,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-D8941F20-7A00-32D1-8DE2-4B7A9F4A0E40.html">CScsSubsession</a> *</td><td>aSubsession,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-D7D422D3-65E5-378B-8F52-6485BC5603A0.html">RMessage2</a> &amp;</td><td>aMessage</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Record the session, subsession, and function associated with this request. These are required to complete or to cancel the request later.</p>

				<p>Adds this object to the active scheduler.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-05B8B8DB-E65B-39C7-8369-5366395071DF.html">CScsSession</a> * aSession</td><td>Session used to launch this request.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-D8941F20-7A00-32D1-8DE2-4B7A9F4A0E40.html">CScsSubsession</a> * aSubsession</td><td>Subsession on which this request is queued. This should be NULL if the request is relative to a session, instead of a subsession  </td></tr><tr><td class="parameter">const <a href="GUID-D7D422D3-65E5-378B-8F52-6485BC5603A0.html">RMessage2</a> &amp; aMessage</td><td>Handle to the kernel-side request object, which will be completed later.  </td></tr></table></div>

	</div>
<h1 class="pageHeading topictitle1">Member Functions Documentation</h1><div class="nested1" id="GUID-6C858B9B-74FF-3EB8-88CC-7F28DF1EC1B1"><a name="GUID-6C858B9B-74FF-3EB8-88CC-7F28DF1EC1B1"><!-- --></a>
		<h2 class="topictitle2">CancelCompleteAndMarkForDeletion()</h2>
		<table class="signature"><tr><td>void</td><td>CancelCompleteAndMarkForDeletion</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Cancel this asynchronous request and complete the client request with KErrCancel. On exit, this object has been marked for deletion. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-B24AC6FE-A933-3032-B7DB-7F3610038DB2"><a name="GUID-B24AC6FE-A933-3032-B7DB-7F3610038DB2"><!-- --></a>
		<h2 class="topictitle2">CompleteAndMarkForDeletion(TInt)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CompleteAndMarkForDeletion</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aError</td><td>)</td><td>[protected]</td></tr></table><div class="section"><div>
				<p>Completes the client-side request associated with this asynchronous request and marks this object for deletion.</p>

				<p>If the error was because the client passed a bad descriptor then panick the client instead of completing the request for consistency with synchronous requests.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aError</td><td>Error code with which the client request will be completed.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-0E2C19B2-6325-32A4-99C5-59300008CBE7"><a name="GUID-0E2C19B2-6325-32A4-99C5-59300008CBE7"><!-- --></a>
		<h2 class="topictitle2">DoCleanup()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>DoCleanup</td><td>(</td><td>)</td><td>[virtual]</td></tr></table><div class="section"><div>
				<p>This virtual function is called whenever the SCS needs to cancel an operation.</p>

				<p>If the asynchronous request implementation ALWAYS has an internal request active for the duration of the client request, then this default implementation can be used, which simply calls <a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html#GUID-A8C4BD4D-4D85-31E3-AA9F-4F8675D608C5">CActive::Cancel</a> which will call the derived classe's DoCancel (if, and only if the object IsActive).</p>

				<p>A more complex case is where the asynchronous requests may enter an internal queue where the client request is (obviously still active), but the derived class has not outstanding request. In this case the default implementation will cause a HANG, because Cancel will not call DoCancel if the object is not active...</p>

				<p>In the generic case, the derived class should provide an overload for the Cleanup method. This function should call Cancel to cancel any outstanding operation, then perform whatever other cleanup is required to cleanup the request (closing handles, removing from queues etc). The framework will then complete the client request.</p>

				<p>nb. The destructor of the <a href="GUID-9955168D-20A6-3FCA-8946-6F5338933B67.html#GUID-9955168D-20A6-3FCA-8946-6F5338933B67">CAsyncRequest</a> may not run until sometime after the client request has been completed. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-365B3617-7E02-3202-9EE8-2B6063F29E59"><a name="GUID-365B3617-7E02-3202-9EE8-2B6063F29E59"><!-- --></a>
		<h2 class="topictitle2">MarkForDeletion()</h2>
		<table class="signature"><tr><td>void</td><td>MarkForDeletion</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Mark this outstanding request for deletion, so it is cleaned up when the cleanup AO runs. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-2AE6B5A1-06D2-3F93-88C8-49A27B5242F8"><a name="GUID-2AE6B5A1-06D2-3F93-88C8-49A27B5242F8"><!-- --></a>
		<h2 class="topictitle2">RunError(TInt)</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>RunError</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aError</td><td>)</td><td>[protected, virtual]</td></tr></table><div class="section"><div>
				<p>Override <a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html#GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F">CActive</a> by completing the request with the supplied error code and marking this object for deletion. The default implementation of RunL cannot leave, but the subclass may override it with a more complex implementation.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aError</td><td>Error code with which aError left.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-B6030E80-A6D6-35A7-8DF7-6458962B6464"><a name="GUID-B6030E80-A6D6-35A7-8DF7-6458962B6464"><!-- --></a>
		<h2 class="topictitle2">RunL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>RunL</td><td>(</td><td>)</td><td>[protected, virtual]</td></tr></table><div class="section"><div>
				<p>Implement <a href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html#GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F">CActive</a> by completing the server client's request status with the AO error code, i.e. iStatus. This function also marks this object for deletion.</p>

				<p>If a subclass overrides this implementation then it must call CompleteAndMarkForDeletion itself to complete the client-side request.</p>

				<p>
					<a href="GUID-9955168D-20A6-3FCA-8946-6F5338933B67.html#GUID-B24AC6FE-A933-3032-B7DB-7F3610038DB2">CompleteAndMarkForDeletion</a> </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-2CB924D0-9B9B-39E0-95D7-244C60596883"><a name="GUID-2CB924D0-9B9B-39E0-95D7-244C60596883"><!-- --></a>
		<h2 class="topictitle2">TransferToScsFrameworkL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>TransferToScsFrameworkL</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Adds this asynchronous request to the global collection. This should be called after the subclass has performed its own initialization, but before the active request has been set up. </p>

			</div></div>

	</div>
<h1 class="pageHeading topictitle1">Member Data Documentation</h1><div class="nested1" id="GUID-F0B5C726-1537-3CBF-A01D-AA5BF1A8F4EC"><a name="GUID-F0B5C726-1537-3CBF-A01D-AA5BF1A8F4EC"><!-- --></a>
		<h2 class="topictitle2">
					TInt
				 iFunction</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td>iFunction</td></tr></table><div class="section"><div>
				<p>Identifies outstanding request. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-A4ABFAC3-B5C9-38F6-BA1F-05E09E442273"><a name="GUID-A4ABFAC3-B5C9-38F6-BA1F-05E09E442273"><!-- --></a>
		<h2 class="topictitle2">const RMessagePtr2 iMessagePtr2</h2>
		<table class="signature"><tr><td>const <a href="GUID-78E0DEDD-C020-3174-AD0A-E4C18C4C9213.html">RMessagePtr2</a></td><td>iMessagePtr2</td></tr></table><div class="section"><div>
				<p>Outstanding message to complete. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-87D4C0BB-3C41-37C3-A41F-DEF282B79EC1"><a name="GUID-87D4C0BB-3C41-37C3-A41F-DEF282B79EC1"><!-- --></a>
		<h2 class="topictitle2">
					CScsSession * iSession</h2>
		<table class="signature"><tr><td>
					<a href="GUID-05B8B8DB-E65B-39C7-8369-5366395071DF.html">CScsSession</a> *</td><td>iSession</td></tr></table><div class="section"><div>
				<p>Session on which this request is queued. NULL if completed. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-141C471E-88D1-316C-AABC-CC79BC40B7A7"><a name="GUID-141C471E-88D1-316C-AABC-CC79BC40B7A7"><!-- --></a>
		<h2 class="topictitle2">
					CScsSubsession * iSubsession</h2>
		<table class="signature"><tr><td>
					<a href="GUID-D8941F20-7A00-32D1-8DE2-4B7A9F4A0E40.html">CScsSubsession</a> *</td><td>iSubsession</td></tr></table><div class="section"><div>
				<p>Subsession on which this request is queued. NULL if session-relative. </p>

			</div></div>

	</div>

	
	
	
	
	
	
	
	
	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>