<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Deriving from COpenFontRasterizer"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CD464A4E-56D5-5645-B493-DE7BF8F6DB6D.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1DCA2F4D-ABE6-52A0-AC4E-5AAC1AB5909D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-762A665F-43D0-53ED-B698-0CBD3AC46391.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B798C19D-4030-564A-A208-D84738259D72.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-89AD2E29-DF29-5B2B-9894-B7ECD62854F4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CD464A4E-56D5-5645-B493-DE7BF8F6DB6D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F477E82D-2929-5C69-BF6D-A69A61AC9EA5.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BCF6FEF0-1792-5DEA-A2D7-896E47163547.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5A89E3C4-DEE7-5823-A109-92ED0D87B58C.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F44D974F-AADE-5E6C-8D69-8D3EEE4BD395.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Deriving from COpenFontRasterizer</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9"><a name="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2535736 id2535744 id2535786 id2535806 id2535827 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-1DCA2F4D-ABE6-52A0-AC4E-5AAC1AB5909D.html">Text and Localization Guide</a> &gt; <a href="GUID-762A665F-43D0-53ED-B698-0CBD3AC46391.html" title="The Font and Text Services Collection contains the Font Store and related plug-ins and the Text Rendering component. Application developers can select fonts from the Font Store. Device creators can create and add fonts.">Font and Text Services Collection</a> &gt; <a href="GUID-B798C19D-4030-564A-A208-D84738259D72.html" title="The Font Store is encapsulated by the Font and Bitmap Server. It represents all of the fonts stored as files in the file system. Font files may be of the native Symbian bitmap format or they may require rasterising into bitmaps. Font rasterisers are ECOM plug-ins to the Font Store.">Font Store Component</a> &gt; <a href="GUID-89AD2E29-DF29-5B2B-9894-B7ECD62854F4.html">Font Store Tutorials</a> &gt; <a href="GUID-CD464A4E-56D5-5645-B493-DE7BF8F6DB6D.html" title="This section provides instructions for creating a font rasterizer. The code examples in this tutorial are take from the FreeType font rasterizer.">Writing a Font Rasterizer Plug-in Tutorial</a> &gt; </div>
<h1 class="topictitle1">Deriving
from COpenFontRasterizer</h1>
<div>
<div class="section" id="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-AD534201-E590-46F5-969D-399A31F86A02"><a name="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-AD534201-E590-46F5-969D-399A31F86A02"><!-- --></a><h2 class="sectiontitle">Overview</h2> <p>Classes derived from <samp class="codeph">COpenFontRasterizer</samp> are
used to recognize font files and create objects to manage them. To derive
from <samp class="codeph">COpenFontRasterizer</samp> you need only provide an implementation
of its pure virtual function <samp class="codeph">NewFontFileL()</samp>. The implementation
of this function is discussed in the following section. </p>
 <p>The derived
class <em>should</em> also define the DLL's single exported function. This function
is discussed further in the previous topic: <a href="GUID-F477E82D-2929-5C69-BF6D-A69A61AC9EA5.html#GUID-F477E82D-2929-5C69-BF6D-A69A61AC9EA5__GUID-ADA409CE-7326-5586-8DC4-B1E3FEBCE070">The
exported function</a>. </p>
 <p>In addition, font rasterizer classes often
need to store an 'engine context'. For example, FreeType relies on a <samp class="codeph">TT_Engine</samp> object;
this is kept in the <samp class="codeph">CFreeTypeRasterizer</samp>, in a <samp class="codeph">CFreeTypeRasterizerContext</samp>.
The context is derived from <samp class="codeph">COpenFontRasterizerContext</samp>, a
utility base class that provides functions that make it easier to write the
glyph bitmap during rasterization. </p>
 </div>

<div class="section" id="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-EF664329-BB35-4DB5-841B-47EA565AA071"><a name="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-EF664329-BB35-4DB5-841B-47EA565AA071"><!-- --></a><h2 class="sectiontitle">Implementing NewFontFileL()</h2> <p>The implementation
must examine a specified file and, if it is of the correct type, attempt to
create a <samp class="codeph">COpenFontFile</samp> derived object to open it. The function
must return NULL if it cannot recognize the file. It may also leave if there
is an error. The caller is responsible for deleting the <samp class="codeph">COpenFontFile</samp> object. </p>
 <p>The
function prototype is given below: </p>
 <pre class="codeblock" id="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-25C6CABB-E2C6-52E6-BEB8-36AD98AAAD0D"><a name="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-25C6CABB-E2C6-52E6-BEB8-36AD98AAAD0D"><!-- --></a>virtual COpenFontFile* NewFontFileL(TInt aUid,
        const TDesC&amp; aFileName, RFs&amp; aFileSession) = 0;</pre>
 <p> <samp class="codeph">aUid</samp> is
an ID to be used for the font file â€” the application framework requires that
each typeface have a UID, so one is dynamically allocated for font files that
are not Symbian-native. The ID must be passed to the <samp class="codeph">COpenFontFile</samp> derived
class's constructor. </p>
 <p> <samp class="codeph">aFileName</samp> is the full path
and filename of the file that the font rasterizer is attempting to open. This
filename must also be passed to the <samp class="codeph">COpenFontFile</samp> derived
class's constructor. </p>
 <p> <samp class="codeph">aFileSession</samp> is the file session
owned by the Font and Bitmap server. This reference should be used for any
file access. If <samp class="codeph">COpenFontFile</samp> derived objects need to keep
files open, <samp class="codeph">aFileSession</samp> should be stored in a place that
is accessible to them. </p>
 </div>

<div class="example"><p>The FreeType implementation of <samp class="codeph">NewFontFileL()</samp> is
given below. It recognizes the file only by its extension, relying on the
construction of the font file object to perform stricter checking.</p>
<pre class="codeblock" id="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-7AA7FB45-1399-5A22-892D-2B365F8F0C60"><a name="GUID-1CF78E25-8C83-5812-AE6F-8612B3F9CDA9__GUID-7AA7FB45-1399-5A22-892D-2B365F8F0C60"><!-- --></a>COpenFontFile* CFreeTypeRasterizer::NewFontFileL(TInt aUid,
    const TDesC&amp; aFileName,RFs&amp; aFileSession)
    {
    TBool is_ttf = EFalse;

    //Tests if the filename extension is ".ttf" or ".ttc".
    if (aFileName.Length() &gt; 4)
        {
        _LIT(KExtensionTTF,".ttf"); // Extension for truetype font file.
        _LIT(KExtensionTTC,".ttc"); // Extension for truetype collection file.
        TPtrC ext = aFileName.Right(4);
        if ((ext.CompareF(KExtensionTTF) == 0) | (ext.CompareF(KExtensionTTC)==0))
          is_ttf = ETrue;
        }
    // If the extension is not .ttf or .ttc then we can't read the file.
    if (!is_ttf)  
      return NULL; 
    
    //If extension is .ttf then attempt to create the font file reader.
    //return it to the caller.
    return CFreeTypeFontFile::NewL(iContext,aUid,
    aFileName,aFileSession);
    }
</pre>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-CD464A4E-56D5-5645-B493-DE7BF8F6DB6D.html" title="This section provides instructions for creating a font rasterizer. The code examples in this tutorial are take from the FreeType font rasterizer.">Writing a Font Rasterizer Plug-in Tutorial</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-F477E82D-2929-5C69-BF6D-A69A61AC9EA5.html">Creating
a Font Rasterizer Plug-in</a></div>
<div><a href="GUID-BCF6FEF0-1792-5DEA-A2D7-896E47163547.html">Deriving
from COpenFontFile</a></div>
<div><a href="GUID-5A89E3C4-DEE7-5823-A109-92ED0D87B58C.html">Deriving
from COpenFont</a></div>
<div><a href="GUID-F44D974F-AADE-5E6C-8D69-8D3EEE4BD395.html">Deriving
from COpenFontRasterizerContext</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>