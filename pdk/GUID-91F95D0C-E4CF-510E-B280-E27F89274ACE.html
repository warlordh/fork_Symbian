<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="SUPL Protocol Module Quick Start"/>
<meta name="abstract" content="This document describes how a device creator starts working with the SUPL Protocol Module."/>
<meta name="description" content="This document describes how a device creator starts working with the SUPL Protocol Module."/>
<meta name="DC.Relation" scheme="URI" content="GUID-816334A7-488B-5F91-8C2E-47076D875013.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-01C03839-C88B-5FC3-9E0E-686415888B63.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-816334A7-488B-5F91-8C2E-47076D875013.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>SUPL Protocol Module Quick Start</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2403195 id2403262 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-01C03839-C88B-5FC3-9E0E-686415888B63.html" title="The Network Adaptation collection contains Protocol Module ECOM plug-ins that can be used by the Network Gateway to support location and privacy requests.">Network Adaptation</a> &gt; <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a> &gt; </div>
<h1 class="topictitle1">SUPL
Protocol Module Quick Start </h1>
<div><p>This document describes how a device creator starts working with
the SUPL Protocol Module. </p>

<p>Note: From Symbian^3 the SUPL Protocol Module is deprecated. For the preferred
way of using SUPL see <a href="GUID-1F7F543A-8A9C-4460-BDB1-A6866E9DF0B9.html">SUPL
Proxy Protocol Module</a>.  </p>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-D1488297-52A2-4A72-8A15-975C744EC34B"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-D1488297-52A2-4A72-8A15-975C744EC34B"><!-- --></a><h2 class="sectiontitle">Contents</h2> <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-9C7133FF-1314-565B-B7E4-24336106DFD0"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-9C7133FF-1314-565B-B7E4-24336106DFD0"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6C811E0E-FF79-5E06-8A62-6251CBD2C28F">Purpose</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-258503E8-82E0-5150-AA5F-A3790697C422"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-258503E8-82E0-5150-AA5F-A3790697C422"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-7EB8FA0D-7892-5EF1-95BF-561163CB2A7F">Introduction</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-57375575-BF24-5036-B5DD-0B4A0BEC0B57"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-57375575-BF24-5036-B5DD-0B4A0BEC0B57"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CA9E94AC-B779-51F5-9407-74F6855AE559">Mandatory tasks</a>  </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-EA0AD505-6FEF-5CB6-AF0D-305123CB8F97"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-EA0AD505-6FEF-5CB6-AF0D-305123CB8F97"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1146D14D-FC0C-55B4-AD2A-A9F7F71A8299">Obtain and set up a SUPL Location Platform</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3D8393E1-E10F-56AF-ACA5-0BDFACCC537B"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3D8393E1-E10F-56AF-ACA5-0BDFACCC537B"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0C287261-D374-5056-93E1-59D8732CBE53">Get the SUPL Protocol Module</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-E8111D40-1AE2-5FAF-A10E-FD22D1F42DE2"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-E8111D40-1AE2-5FAF-A10E-FD22D1F42DE2"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F20DE179-AAC8-501D-928A-AB153A0C5F37">Configure an A-GPS Integration Module for LBS</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CAC78758-721D-5A1D-A74D-1878A09755E1"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CAC78758-721D-5A1D-A74D-1878A09755E1"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCC0652D-F67D-5422-8E87-4F2CCBE7B89F">Configure the LBS administration settings for SUPL</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3606684E-68CB-52E2-A165-F27588AC4C65"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3606684E-68CB-52E2-A165-F27588AC4C65"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54">Configure the SUPL Location Platform host settings</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5F6DD9FC-7477-5C70-8250-C51A7B8EF0B2"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5F6DD9FC-7477-5C70-8250-C51A7B8EF0B2"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8">Implement ETel TSY enhancements</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5431453F-16A9-5A53-828F-3953FEA51844"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5431453F-16A9-5A53-828F-3953FEA51844"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C99DDA3C-FB8D-5C87-95EB-787BC4E58651">Build a ROM image to include the SUPL Protocol Module</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-D2F5E821-F9A3-5886-8524-9DC8C9EF7059"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-D2F5E821-F9A3-5886-8524-9DC8C9EF7059"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FBE89F3C-7D98-528F-8DF4-93077A604C65">Test the SUPL Protocol Module</a>  </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-40F6AF44-5215-5BF3-B266-6A1E15E042BF"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-40F6AF44-5215-5BF3-B266-6A1E15E042BF"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A0D16304-B733-5CE8-9038-70DDF8C6493E">SUPL Protocol Module development logging</a>  </p>
 </li>

</ul>
 </li>

</ul>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2D366E0F-4865-510F-94B1-E0EE12F9B937"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2D366E0F-4865-510F-94B1-E0EE12F9B937"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-98ADB801-5665-5677-8A46-EB9F3BE40B45">Optional tasks</a>  </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-78EC3BDE-404D-5AA8-9EC9-AF0AC364ABDB"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-78EC3BDE-404D-5AA8-9EC9-AF0AC364ABDB"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1B8100CB-B9C2-5C7E-8973-EC0FF06E06C5">Create an application for managing SLP host settings</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0162916F-B1B7-5175-9CEB-80975CA91864"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0162916F-B1B7-5175-9CEB-80975CA91864"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6E2ED828-D1D6-5FA8-9508-058360932E1B">Create a handler for SUPL INIT messages received via SMS Trigger</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-984F42B9-C3A7-5ECD-A1D8-B3A3CD95BBC1"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-984F42B9-C3A7-5ECD-A1D8-B3A3CD95BBC1"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-9F4E4AED-4276-5587-81FF-E43883A51971">Provision SLP root certificate for Transport Level Security (TLS)</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-06FAE256-69CA-518D-A6F0-C68DD05CBDFD"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-06FAE256-69CA-518D-A6F0-C68DD05CBDFD"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-62ECFF09-BBED-59FF-A835-057A67309E62">Create a plug-in to obtain a pre-shared key for PSK-TLS</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0048A93C-71F7-5F30-BB5A-1AABF10D040E"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0048A93C-71F7-5F30-BB5A-1AABF10D040E"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F4BA8794-2F67-5AE3-B099-FFCC156F6722">Define conflict control rules</a>  </p>
 </li>

</ul>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-8015C091-4038-5C5F-8F1C-8144D1AA3728"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-8015C091-4038-5C5F-8F1C-8144D1AA3728"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-89156A75-D752-51FE-9949-DF080B4C8EB0">See also</a>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-968D3341-9320-5E31-815D-85800C44EAC5"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-968D3341-9320-5E31-815D-85800C44EAC5"><!-- --></a><p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">References</a>  </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6C811E0E-FF79-5E06-8A62-6251CBD2C28F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6C811E0E-FF79-5E06-8A62-6251CBD2C28F"><!-- --></a><h2 class="sectiontitle">Purpose</h2> <p>This
document describes the tasks required to start using and testing the LBS subsystem
SUPL Protocol Module and to integrate it into a device. It describes the components
outside of the LBS subsystem that must be provided or modified to support
SUPL and the LBS subsystem settings that must be configured so LBS can use
the SUPL Protocol Module. </p>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-7EB8FA0D-7892-5EF1-95BF-561163CB2A7F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-7EB8FA0D-7892-5EF1-95BF-561163CB2A7F"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>The
SUPL Protocol Module (SPM) is a reference module provided by Symbian and is
described in <a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL Protocol
Module Overview</a>. </p>
 <p>Using the SPM and integrating it into a product
requires a licensee to perform several tasks. Some of the tasks must be performed
by all licensees and others are optional depending on how a licensee and network
operator intend to use the SUPL Protocol Module. </p>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CA9E94AC-B779-51F5-9407-74F6855AE559"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CA9E94AC-B779-51F5-9407-74F6855AE559"><!-- --></a><h2 class="sectiontitle">Mandatory tasks</h2> <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1146D14D-FC0C-55B4-AD2A-A9F7F71A8299"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1146D14D-FC0C-55B4-AD2A-A9F7F71A8299"><!-- --></a><strong>Obtain and set up a SUPL
Location Platform</strong> </p>
 <p>The <a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL
Protocol Module Overview</a> and the SUPL specification [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">1</a>] describe the SUPL Location Platform, the server side platform that
supports the SUPL standard. </p>
 <p>The Symbian reference SUPL Protocol Module
has been tested with a commercial SUPL Location Platform (SLP). There are
several different SLPs available from different vendors and a network operator
may choose to use a different SLP to the one used by Symbian to test the SPM. </p>
 <p> <em>A
licensee who intends to integrate the SPM into a device must verify that it
works with the SLP chosen by the target network operator.</em>  </p>
 <p>The
details of setting up and configuring an SLP are specific to the platform
used and are outside of the scope of this document. </p>
 <p>See <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FBE89F3C-7D98-528F-8DF4-93077A604C65">Test the SUPL Protocol Module</a> for information about how the SPM was
tested by Symbian with a commercial SLP. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0C287261-D374-5056-93E1-59D8732CBE53"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-0C287261-D374-5056-93E1-59D8732CBE53"><!-- --></a><strong>Get the SUPL Protocol Module</strong> </p>
 <p>The
SUPL Protocol Module is included as part of the Symbian LBS subsystem distribution. </p>
 <p>See <a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL Protocol Module Overview</a> for
more information on the components of the SUPL Protocol Module. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F20DE179-AAC8-501D-928A-AB153A0C5F37"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F20DE179-AAC8-501D-928A-AB153A0C5F37"><!-- --></a><strong>Configure an A-GPS Integration
Module for LBS</strong> </p>
 <p>A GPS or Assisted GPS (A-GPS) Integration Module
is required to integrate the LBS subsystem with GPS hardware. </p>
 <p><a href="GUID-8F2BA0D3-1549-5837-A105-3AB484CDB80B.html" title="The documents in this section describe the A-GPS Location Data Source API.">A-GPS Location Data Source
API</a> describes how to use the A-GPS Location Data Source API to implement
an Integration Module and the design of Symbian's reference SiRF A-GPS Integration
Module implementation. </p>
 <p>The section <em>GPS/A-GPS Integration Module</em> of
the <a href="GUID-D18B4715-3942-52EA-9D2F-E145037FA47A.html" title="The documents in this section describe the tasks necessary to build and configure the LBS subsystem. These documents are for device creators.">LBS integration
and configuration guide</a> describes how to configure an Integration Module's <samp class="codeph">module.ini</samp> configuration
file so that LBS recognises and uses an Integration Module. </p>
 <p>The SPM
supports Autonomous Mode GPS, Terminal Based Mode GPS and Terminal Assisted
Mode GPS. It also supports Cell-based positioning if the accuracy of GPS is
not required. </p>
 <p><strong>Minimising assistance data requests </strong> </p>
 <p>The LBS subsystem may
be configured to use the SUPL Protocol Module when a user is roaming as described
in <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCC0652D-F67D-5422-8E87-4F2CCBE7B89F">Configure
the LBS administration settings for SUPL</a>. When roaming, charges for
data, including GPS assistance data may be high. It is therefore important
that a licensee's A-GPS Integration Module request only the types of assistance
data it requires. Requests for necessary assistance data may unnecessarily
increase the costs to the user of using GPS. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCC0652D-F67D-5422-8E87-4F2CCBE7B89F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCC0652D-F67D-5422-8E87-4F2CCBE7B89F"><!-- --></a><strong>Configure the LBS administration
settings for SUPL</strong> </p>
 <p>There are two LBS administration settings that
specify the implementation UIDs of the Network Protocol Modules loaded by
LBS and one that specifies how Network Protocol Modules are loaded: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5448D0D5-775C-5082-A620-040D9F746C1B"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5448D0D5-775C-5082-A620-040D9F746C1B"><!-- --></a><p> <samp class="codeph">KSettingHomeProtocolModule</samp> specifies
the implementation UID of the Network Protocol Module ECOM plug-in that is
used when the device is in the home network. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FEEE1897-E530-57D7-9BA9-A192FD3E5830"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FEEE1897-E530-57D7-9BA9-A192FD3E5830"><!-- --></a><p> <samp class="codeph">KSettingRoamingProtocolModule</samp> specifies
the implementation UID of the Network Protocol Module ECOM plug-in that is
used when the device is roaming. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-10A29556-6C51-5E97-96C9-BFBAF475251D"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-10A29556-6C51-5E97-96C9-BFBAF475251D"><!-- --></a><p> <samp class="codeph">KLbsProtocolModuleLoading</samp> specifies
the loading strategy for Network Protocol Modules. See the entry in <a href="GUID-9348D79B-D4BF-50B0-B787-DDA2765CE058.html" title="This document describes the LBS administration service and the API that it supports.">LBS administration service</a> for
details about the effects of this setting. Note that if LBS cannot obtain
a network registration status then it cannot use a Network Protocol Module
and location requests will fail. </p>
 <p>LBS uses the ETel API to obtain the
mobile device's network registration status. LBS uses this status at startup
to decide which Network Protocol Module to load. A Symbian licensee must implement
the methods <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0251C53A-852B-3737-9131-E82C489A5EA9"><span class="apiname">RMobilePhone::GetNetworkRegistrationStatus()</span></a> and <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0B567090-EA9A-3023-8229-EEE43C024D54"><span class="apiname">RMobilePhone::NotifyNetworkRegistrationStatusChange()</span></a> to report the registration status of the device. LBS calls <samp class="codeph">GetNetworkRegistrationStatus()</samp> on
startup to get the initial network registration status. It also subscribes
for registration status changes by calling <samp class="codeph">NotifyNetworkRegistrationStatusChange()</samp>.
See <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8">Implement
ETel TSY Enhancements</a> for more information about changes that are required
in a licensee's ETel TSY. </p>
 </li>

</ul>
 <p>The administration settings are read by LBS on subsystem start-up.
It is recommended that they are set in the <a href="GUID-852E58C1-EA5C-5B46-9020-4463D3FA06AD.html" title="This topic describes the LBS administration repository initialisation file.">LBS
administration repository initialisation file</a>. </p>
 <p>For LBS to load
the reference SUPL Protocol Module, the administration settings values must
be set to the <samp class="codeph">implementation_uid</samp> specified in the ECOM resource
file <span class="filepath">suplprotocolmodule.rss</span>, which is shown below: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5D171531-39D1-51F1-8D47-53A23AC41750"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5D171531-39D1-51F1-8D47-53A23AC41750"><!-- --></a>
// suplprotocolmodule.rss
//

#include "ecom/registryinfov2.rh"

RESOURCE REGISTRY_INFO theInfo
    {
    resource_format_version = RESOURCE_FORMAT_VERSION_2;
    dll_uid = 0x10285A9C;
    interfaces = 
        {
        INTERFACE_INFO
            {
            // UID of interface that is implemented
            interface_uid = 0x10281D4A;
            implementations = 
                {
                IMPLEMENTATION_INFO
                    {
                    // UID of this interface implementation
                    implementation_uid = 0x10285A9D;
                    version_no = 1;
                    display_name = "SUPL V1 Protocol Module";
                    default_data = "";
                    opaque_data = "";
                    rom_only = 0;
                    }
                };
            }
        };
    }
</pre>
 <p>LBS administration settings to use the SUPL Protocol Module
in the home network and when roaming are shown below, together with the module
loading strategy setting: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-91AD5D81-CAA2-55F2-BB87-0B28416391AF"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-91AD5D81-CAA2-55F2-BB87-0B28416391AF"><!-- --></a>
#KSettingHomeProtocolModule.
0x0000000E  int  0x10285A9D
#KSettingRoamingProtocolModule.
0x0000000F  int  0x10285A9D

...

#KLbsProtocolModuleLoading
#Load KSettingHomeProtocolModule or KSettingRoamingProtocolModule based on network registration status
0x00000018  int  1</pre>
 <p>A default central repository initialisation
source file <span class="filepath">1028224B.txt</span> can be found in the LBS source
tree at <span class="filepath">&lt;LBS_ROOT&gt;\LbsAdmin\data</span>. Licensees can modify
the source file <span class="filepath">1028224B.txt</span> and rebuild it to configure
their LBS subsystem. The directory <span class="filepath">&lt;LBS_ROOT&gt;\LbsAdmin\group</span> contains
a make file <span class="filepath">createlbsadminrep.mk</span> that creates the binary
file from the text source. This file is exported to <span class="filepath">\epoc32\data\z\private\10202BE9\1028224B.cre</span>. </p>
 <p> <strong>Note
that the default initialisation file that ships with LBS is not configured
to use the Symbian reference SUPL Protocol Module.</strong> Licensees must modify
the settings described above to use the reference SUPL Protocol Module when
the device is in the home network and when roaming. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54"><!-- --></a><strong>Configure the SUPL Location
Platform host settings</strong> </p>
 <p>The <a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host
Settings API</a> is the interface through which SLP host settings are configured
at runtime. The API is a wrapper on a central repository area that defines
the host settings for SET initiated and network initiated location requests.
The settings also define the encryption and authentication methods that must
be used between the SET and the SLP. </p>
 <p>Host Settings can be configured
in one or more of the following ways: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-E14D26B7-836E-5204-A5F2-C0B181130318"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-E14D26B7-836E-5204-A5F2-C0B181130318"><!-- --></a><p>Over the air from a
Device Management server (Symbian provide a SUPL Host Settings Device Management
plug-in). </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6F707444-1ACE-5B6D-866F-0468D8EEA47C"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6F707444-1ACE-5B6D-866F-0468D8EEA47C"><!-- --></a><p>Over the air, or from
a local data source (such as a SIM card), using Client Provisioning (Symbian
provide a SUPL Host Settings Client Provisioning plug-in). </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-56958247-9FE0-5114-AEFD-391FD053E224"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-56958247-9FE0-5114-AEFD-391FD053E224"><!-- --></a><p>By a locally installed
client application such as an "LBS settings application" that a licensee may
have already created to configure other LBS settings. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-109221DF-1D46-50DD-A720-174EEA1A81A6"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-109221DF-1D46-50DD-A720-174EEA1A81A6"><!-- --></a><p>By installation of a
host settings central repository initialisation file. </p>
 </li>

</ul>
 <p>More that one of these methods can be used by a licensee and network
operator to configure the SLP host settings. For example, host settings can
be pre-configured in the device in a central repository initialisation file,
the default SLP can be changed via an LBS settings application and a network
operator can also send Device Management messages to change the settings over-the-air. </p>
 <p>To
begin testing with the SUPL Protocol Module, the simplest approach is to create
a host settings initialisation file. </p>
 <p>An example host settings initialisation
text file is shown below. The comments refer to the methods that are used
to get SLP host settings via the <a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host
Settings API</a>. </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-718286A4-3964-5B29-9583-D2C464DB4F52"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-718286A4-3964-5B29-9583-D2C464DB4F52"><!-- --></a>
# 1.0 File Version For Supl Host Settings

# This file is compiled into the binary '.cre' version
# by an extension makefile (createbinaryrep.mk), which
# is called as part of the standard abld build process.
#
# The ".cre" version is the one used to install the 
# repository when the ROM is built. 
cenrep
version 1

[platsec]
cap_rd=AlwaysPass 
cap_wr=WriteDeviceData

[Main]
#counter for record IDs in the settings store - 2 in this case
0x00000001    int    2    0
# default SLP host
0x00000002    int    1
# ---------- SLP Host A ----------
# ECreatorId
# Host settings creator - device provisioning in this case
# Value is KLbsHostSettingsDevProvCreatorId as defined in lbshostsettings.h
0x10000000     int            0x10285AA9 // TLbsHostSettingsBase::CreatorId() 
# EConnectionId
0x20000000    int            0 // TLbsHostSettingsSupl::GetConnectionPoint() - Connection point
# EConnectionIdType
0x30000000    int            1 // TLbsHostSettingsSupl::GetConnectionPoint() - Connection type
# EHostAddress
0x40000000    string8            &lt;ENTER HOST 1 ADDRESS HERE&gt; // TLbsHostSettingsSupl::GetHostNameAddress()
# EReadOnly
0x50000000    int            0 // TLbsHostSettingsSupl::GetReadOnly()
# EHostPort
0x60000000    int            7275 // Standard port for SUPL - TLbsHostSettingsSupl::GetPortId()
# EHostName
0x70000000    string8            &lt;ENTER HOST 1 NAME HERE&gt; // TLbsHostSettingsSupl::GetName()
# EProviderId
0x80000000    string8            Symbian // TLbsHostSettingsSupl::GetProviderId()
# ETimestamp
0x90000000    string            20080514:134400.000000 // TLbsHostSettingsBase::LastModified()
# EAuthMoLr
0xA0000000    int            1 // TLbsHostSettingsSupl::GetAuthModesMolr()
# EAuthMtLr
0xB0000000    int            1 // TLbsHostSettingsSupl::GetAuthModesMtlr()

# ---------- SLP Host B (uses TLS) ----------
# ECreatorId
0x10000001     int            0x10285AA9
# EConnectionId
0x20000001    int            0
# EConnectionIdType
0x30000001    int            0
# EHostAddress
0x40000001    string8            &lt;ENTER HOST 2 ADDRESS HERE&gt;
# EReadOnly
0x50000001    int            0
# EHostPort
0x60000001    int            7275
# EHostName
0x70000001    string8            &lt;ENTER HOST 2 NAME HERE&gt;
# EProviderId
0x80000001    string8            Symbian
# ETimestamp
0x90000001    string            20080514:134400.000000
# EAuthMoLr
0xA0000001    int            2
# EAuthMtLr
0xB0000001    int            2
</pre>
 <p>The following are the most important points about the values
in this file: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-07E1D482-DB28-513B-B917-764081C00CDB"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-07E1D482-DB28-513B-B917-764081C00CDB"><!-- --></a><p>The settings for each
SLP host have a unique key range. In the example above the keys for the SLP
Host A settings range from <samp class="codeph">0x10000000</samp> to <samp class="codeph">0xB0000000</samp>.
For SLP Host B the settings keys range from <samp class="codeph">0x10000001</samp> to <samp class="codeph">0xB0000001</samp>. </p>
 <p>The
first part of the key describes the type of setting. For SLP Host A, 0x10000000
is the key for the settings creator ID and 0x20000000 is the key for the settings
connection point ID. </p>
 <p>The last part of the key specifies the SLP host
for which the settings apply: <samp class="codeph">0x10000000</samp> is the key for the
settings creator ID for the SLP Host A settings and <samp class="codeph">0x10000001</samp> is
the key for the settings creator UID of the SLP Host B settings. The unique
value for the last part of the key identifies that a group of settings values
belong to the same SLP Host. To specify new settings for an SLP Host C, the
next logical range of keys is <samp class="codeph">0x10000002</samp> to <samp class="codeph">0xB0000002</samp>. </p>
 <p><a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host Settings API</a> describes
how a program can read and create host settings. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-76A087F5-AB7D-504C-A67C-450F93CC4EDA"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-76A087F5-AB7D-504C-A67C-450F93CC4EDA"><!-- --></a><p>The value of <samp class="codeph">EHostAddress</samp> must
be set to the IP number or domain name of the SLP host server. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FA586B8F-750F-5EA3-9B5D-4E05AE6A556F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FA586B8F-750F-5EA3-9B5D-4E05AE6A556F"><!-- --></a><p>The value of <samp class="codeph">EHostName</samp> must
be set to a name to identify the server (for example in a settings application
that allows users to select the SLP). </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1A1AEF76-EDE9-5855-8A13-8F99E25EBB6E"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1A1AEF76-EDE9-5855-8A13-8F99E25EBB6E"><!-- --></a><p>The values of <samp class="codeph">EAuthMolr</samp> and <samp class="codeph">EAuthMtlr</samp> describe
the authentication and encryption method(s) that are allowed for SET initiated
location requests (MO-LR) and network initiated location requests (MT-LR). </p>
 <p>Several
different levels of authentication and encryption are defined by the Host
Settings API enumeration <a href="GUID-5B492B69-19D2-38B8-946F-FD1155513F9F.html#GUID-5B492B69-19D2-38B8-946F-FD1155513F9F__GUID-08CE8437-2BEB-3FCE-ABCD-0D842D079560"><span class="apiname">TLbsHostSettingsSupl::_TAuthModes</span></a>.
The values of the enumeration are described in the table shown below. Note
that the value in the initialisation file is decimal: </p>
 
<div class="tablenoborder"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6C8B40BC-770C-5F14-813A-C3059E6BD1BA"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6C8B40BC-770C-5F14-813A-C3059E6BD1BA" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" id="d1367100e614">Meaning</th>

<th class="cellrowborder" valign="top" id="d1367100e617">TLbsHostSettingsSupl::_TAuthModes</th>

<th class="cellrowborder" valign="top" id="d1367100e620">Numeric value</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" headers="d1367100e614 "><p>Do not use authentication/encryption </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e617 "><p> <samp class="codeph">EAuthNone</samp>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e620 "><p>1 </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d1367100e614 "><p>Use TLS </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e617 "><p> <samp class="codeph">EAuthTls</samp>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e620 "><p>2 </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d1367100e614 "><p>Use ACA + TLS </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e617 "><p> <samp class="codeph">EAuthAcaTls</samp>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e620 "><p>4 </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d1367100e614 "><p>Use PSK + TLS </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e617 "><p> <samp class="codeph">EAuthPskTls</samp>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d1367100e620 "><p>8 </p>
 </td>

</tr>

</tbody>

</table>
</div>
 <p>The values are bitwise added to describe the set of possible types
of authentication and encryption that can be used between the SET and an SLP.
At runtime the SET and the SLP negotiate to use the highest level of security
and authentication supported by both. </p>
 <p>For example, to specify that
either ACA + TLS or PSK + TLS are allowed for SET initiated location requests, <samp class="codeph">EAuthMolr</samp> must
be set to <samp class="codeph">EAuthAcaTls | EAuthPskTls</samp> = 12. </p>
 <p>Note that
the SUPL specification [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">1</a>]
mandates the use of ACA or PSK with TLS, but turning off authentication and
encryption can be useful for testing. </p>
 </li>

</ul>
 <p><strong>Installing a host settings initialisation file </strong> </p>
 <p>A host settings
initialisation text file can be converted to a binary file using the make
file in <span class="filepath">&lt;LBS_ROOT&gt;\LbsSuplProtocolModule\HostSettingsAPI\group\createlbssuplstore.mk</span>,
where <span class="filepath">&lt;LBS_ROOT&gt;</span> is the root directory of the LBS
source tree. </p>
 <p>The source file is copied to <span class="filepath">\epoc32\winscw\c\private\10202be9\10285AA8.cre</span> on
the emulator and to <span class="filepath">z:\private\10202be9\10285AA8.cre</span> on
hardware. </p>
 <p><strong>Rules for host settings selection </strong> </p>
 <p>This section describes
the rules that are used by the SUPL Protocol Module to choose SLP host settings
for SET initiated location requests (MO-LRs) and network initiated location
requests (MT-LRs). </p>
 <p> <strong>Rules for SET initiated location requests (MO-LR)</strong>  </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-652019AF-0038-5580-9CFF-0B7A16B04F8F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-652019AF-0038-5580-9CFF-0B7A16B04F8F"><!-- --></a><p>If a default host is
specified, use it for MO-LR. </p>
 <p>The example host settings file shown
above contains the following lines: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F4788690-5E37-550A-A20E-18CCE60DAABE"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F4788690-5E37-550A-A20E-18CCE60DAABE"><!-- --></a>
# default SLP host
0x00000002    int    1
</pre>
 <p>The entry specifies that the host setting keys beginning at <samp class="codeph">0x10000001</samp> must
be used for MO-LR because 1 is the last digit of <samp class="codeph">0x10000001</samp>.
This is the host specified as SLP Host 2 in the example host settings file
shown above. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3FF3EC3C-0356-5544-B363-CEA95B8B8EE3"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3FF3EC3C-0356-5544-B363-CEA95B8B8EE3"><!-- --></a><p>If a default host is
not specified, use the host that was most recently provisioned from the network. </p>
 <p>A
timestamp value is associated with each host settings entry as shown in the
example host settings file. This key is commented as <samp class="codeph">ETimestamp</samp> in
the example host settings file. </p>
 <p>A creator UID value of <samp class="codeph">0x10285AA9</samp> is
specified for host settings that were provisioned from the network. This UID
is the value of <samp class="codeph">KLbsHostSettingsDevProvCreatorId</samp> as defined
in <span class="filepath">lbshostsettings.h</span>. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C770A9B1-F9CA-59A2-A7FB-C4E5BA13158B"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C770A9B1-F9CA-59A2-A7FB-C4E5BA13158B"><!-- --></a><p>If neither of the above
rules can be used to obtain host settings, derive a host address from the <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8">IMSI</a> as
described in [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">1</a>]. </p>
 </li>

</ul>
 <p> <strong>Rules for network initiated location requests (MT-LR)</strong>  </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2D213DB0-BA6B-5CDB-AC9A-4866A0611E53"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2D213DB0-BA6B-5CDB-AC9A-4866A0611E53"><!-- --></a><p>Use the host settings
that were most recently provisioned from the network. </p>
 <p>The host settings
with a creator UID value of <samp class="codeph">0x10285AA9</samp> and the most recent
timestamp are used. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A8D4079D-87C2-58CD-ACC6-58AFF28BF4A2"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A8D4079D-87C2-58CD-ACC6-58AFF28BF4A2"><!-- --></a><p>If there are no host
settings with a creator UID of <samp class="codeph">0x10285AA9</samp> derive a host address
from the <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8">IMSI</a> as
described in [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">1</a>]. </p>
 </li>

</ul>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-145112E6-6DDE-5FF6-A61A-2414E2B2EDF8"><!-- --></a><strong>Implement ETel TSY enhancements</strong> </p>
 <p>LBS
and the SUPL Protocol Module use the ETel API to get location information,
network status information and mobile subscriber identity information. The
following types of information must be available to the SUPL Protocol Module: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CDB56FE0-977A-5184-A4C3-B92768709792"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-CDB56FE0-977A-5184-A4C3-B92768709792"><!-- --></a><p>The mobile network cell
ID </p>
 <p>The SUPL Protocol Module uses the method <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-622488D3-9665-3249-85EE-D509D17193F6"><span class="apiname">RMobilePhone::GetCellInfo()</span></a> to
get a cell info object of type <a href="GUID-C5598BFB-9048-3527-AD66-D45819813B71.html"><span class="apiname">TMobilePhoneCellInfoV9</span></a>,
which contains the cell ID as specified in [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">2</a>] and [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">3</a>].
The cell ID is passed from the SET to the SLP as part of a <samp class="codeph">SUPL POS
INIT</samp> message and is used to obtain a cell-based position and/or GPS
assistance data. </p>
 <p>To use cell-based positioning or request assistance
data, the ETel TSY must be implemented to return the cell ID. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F2A16BDF-9DE0-58DD-B6BF-10660ED6F1F9"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F2A16BDF-9DE0-58DD-B6BF-10660ED6F1F9"><!-- --></a><p>Timing advance information
for enhanced cell-based positioning </p>
 <p>A <a href="GUID-653A00A1-9007-30BB-8E0B-43E39C3A27E0.html"><span class="apiname">TMobilePhoneCellInfov9</span></a> object
also contains a timing advance parameter to support enhanced cell-based positioning
in GSM networks. If the licensee ETel TSY can provide timing advance information,
it is returned to the network as part of a <samp class="codeph">SUPL POS              
    INIT</samp> message and allows a more accurate cell-based position to
be calculated. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-47326313-B2E5-5C08-A549-4C5F689C26DE"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-47326313-B2E5-5C08-A549-4C5F689C26DE"><!-- --></a><p>The network registration
status </p>
 <p>On startup, LBS gets the current network registration status
of the device by calling <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0251C53A-852B-3737-9131-E82C489A5EA9"><span class="apiname">RMobilePhone::GetNetworkRegistrationStatus()</span></a>.
LBS receives notification of changes to the mobile device's network registration
status by calling <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0B567090-EA9A-3023-8229-EEE43C024D54"><span class="apiname">RMobilePhone::NotifyNetworkRegistrationStatusChange()</span></a>.
The ETel TSY must be implemented to return the network registration status
for both of these methods. </p>
 <p>LBS loads one or more Network Protocol
Modules based on the settings specified in the <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCC0652D-F67D-5422-8E87-4F2CCBE7B89F">LBS
administration settings</a>. </p>
 <p> <strong>Note that if the ETel TSY is not
implemented to report the network registration status, LBS cannot use a Network
Protocol Modules and location requests will fail.</strong>  </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-66889509-4B4C-5D2B-A833-ABD9638584A3"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-66889509-4B4C-5D2B-A833-ABD9638584A3"><!-- --></a><p>The International Mobile
Subscriber Identity (IMSI) </p>
 <p>[<a href="http://www.openmobilealliance.org" target="_blank">1</a>] describes how the IMSI must be used to derive a
default Home SUPL Location Platform (H-SLP) host address if the value has
not been provisioned on the mobile device by some other means. </p>
 <p>The
SUPL Protocol Module derives a default H-SLP host address from the IMSI if
it cannot be obtained using the Host Settings API. It uses the <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-3E541EF3-E466-382F-9979-605A4EDC4B30"><span class="apiname">RMobilePhone::GetSubscriberId()</span></a> method
to obtain the IMSI. The ETEL TSY must be implemented to return the IMSI to
handle situations where the H-SLP host address has not been provisioned by
other means. </p>
 </li>

</ul>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C99DDA3C-FB8D-5C87-95EB-787BC4E58651"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C99DDA3C-FB8D-5C87-95EB-787BC4E58651"><!-- --></a><strong>Build a ROM image to include
the SUPL Protocol Module</strong> </p>
 <p>The SUPL Protocol Module and its supporting
components are all built as part of the standard LBS code build process. The
components are part of the set of LBS <span class="filepath">.exe</span> and <span class="filepath">.dll</span> files
that are delivered to licensees as part of an LBS distribution. </p>
 <p>The
SUPL Protocol Module and its supporting components are not included by default
in an LBS ROM image. It is necessary for a licensee to specify ROM build macros
to include the SUPL Protocol Module in a ROM image. </p>
 <p>The following
SUPL macros are checked in the LBS .iby files: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-EE1CFEF6-D108-512C-9B39-ED2FD66209D7"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-EE1CFEF6-D108-512C-9B39-ED2FD66209D7"><!-- --></a><p> <strong>SYMBIAN_INCLUDE_LOCATION_SUPLv10</strong> includes
the SUPL Protocol Module, the WAP Push Handler plug-in, the test SMS Trigger
plug-in and the Host Settings API DLL in ROM. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6D337264-76C9-52E2-B30E-83D9B9EF3F9A"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6D337264-76C9-52E2-B30E-83D9B9EF3F9A"><!-- --></a><p> <strong>SYMBIAN_EXCLUDE_LOCATION_SUPLv10_SMS</strong> excludes
the test SMS Trigger plug-in from ROM. </p>
 <p>Note that the SMS Trigger plug-in
is a test component for licensees to test <samp class="codeph">SUPL INIT</samp> messages
sent via Mobile Terminated SMS. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3A443D85-F1DD-59E3-BFD6-097BF60FE1BC"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-3A443D85-F1DD-59E3-BFD6-097BF60FE1BC"><!-- --></a><p> <strong>SYMBIAN_EXCLUDE_LOCATION_SUPLv10_WAP</strong> excludes
the WAP Push plug-in from ROM. </p>
 </li>

</ul>
 <p>To build a ROM image to include the SUPL Protocol Module, a licensee
uses a command as shown below: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-94114427-BB0F-5C14-8B06-9858336BE059"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-94114427-BB0F-5C14-8B06-9858336BE059"><!-- --></a>
buildrom lbs.oby -DSYMBIAN_INCLUDE_LOCATION_SUPLv10
</pre>
 <p>where <samp class="codeph">lbs.oby</samp> contains the following files: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5F40AC8D-04FC-56D9-A732-09BDD86FBAE1"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5F40AC8D-04FC-56D9-A732-09BDD86FBAE1"><!-- --></a>
#if !defined(SYMBIAN_EXCLUDE_LOCATION)

#include "lbsadmin.iby"

#include "lbslocserver.iby" 

#include "lbsagpslocmanager.iby" 

#include "LbsNetworkLocationManager.iby"

#include "lbsnetworkrequesthandler.iby"

#include "lbsnetgateway.iby" 

#include "lbssupl.iby" //  Includes checks for SUPL ROM build macros

#include "sirfdatasource.iby" // Only required to include the Symbian reference A-GPS module

#endif // SYMBIAN_EXCLUDE_LOCATION
</pre>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FBE89F3C-7D98-528F-8DF4-93077A604C65"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-FBE89F3C-7D98-528F-8DF4-93077A604C65"><!-- --></a><strong>Test the SUPL Protocol Module</strong> </p>
 <p>This
section describes how the SUPL Protocol Module was tested for SET initiated
location requests (MO-LRs) and network initiated location requests (MT-LRs).
A set of OMA SUPL conformance test cases [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">2</a>] have also been used to test the SPM. </p>
 <p>Symbian licensees can use
the Symbian tests as the basis for testing the SPM with their own SLP. The
SPM was tested by Symbian with a commercial SUPL server using the Symbian
Test Execute Framework (TEF). TEF runs individual test steps (test cases or
part test cases) defined by test scripts and provides logging containing the
test results in html (or xml) files on the device. </p>
 <p>TEF is invoked
by the command <samp class="codeph">testexecute.exe              &lt;FullFilePath\xxx.script&gt;</samp> which
can be invoked from <samp class="codeph">eshell</samp> in the emulator. <samp class="codeph">testexecute.exe</samp> interprets
the script commands within the <samp class="codeph">.script</samp> file passed to it
as an argument. </p>
 <p><strong>SUPL TEF test suites </strong> </p>
 <p>The TEF test suites that were used by
Symbian to test the SPM can be found in the SUPL test directory <span class="filepath">&lt;LBS_ROOT&gt;\test\testproduct\supl</span> where <span class="filepath">&lt;LBS_ROOT&gt;</span> is the LBS subsystem source distribution root directory. Some of these tests
were performed using Symbian simulation components and others were performed
using a commercial SUPL server. </p>
 <p>A number of sub-directories for different
categories of tests exist within this SUPL test directory: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-52AA248B-7262-517F-88A5-EF34DE842B92"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-52AA248B-7262-517F-88A5-EF34DE842B92"><!-- --></a><p> <span class="filepath">.\molr\real</span> contains
tests for SET initiated location requests. </p>
 <p>The TEF script file for
these tests can be found at <span class="filepath">.\molr\real\scripts\suplmolrrealtest.script</span>. </p>
 <p>It
should be noted that the test scripts are customised for internal Symbian
testing. In particular they use a Symbian test A-GPS Integration Module. Licensees
may need to modify test scripts and test cases to meet their own needs. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-48006F0C-6769-5B30-818B-6DBECCAD853F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-48006F0C-6769-5B30-818B-6DBECCAD853F"><!-- --></a><p> <span class="filepath">.\mtlr\real</span> contains
tests for network initiated location requests. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-07DA731B-B32E-5D2A-BA61-7A523C2E122A"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-07DA731B-B32E-5D2A-BA61-7A523C2E122A"><!-- --></a><p> <span class="filepath">.\omaconformance</span> contains
OMA defined tests as described in [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">2</a>]. </p>
 </li>

</ul>
 <p><strong>MLP Module </strong> </p>
 <p>The MLP Module is released to licensees as an
unsupported test component that may assist them in testing the SUPL Protocol
Module with a SUPL Location Platform. </p>
 <p>OMA defines the Mobile Location
Protocol (MLP) specification [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">3</a>]
for sending requests for location from a client to a server and for receiving
location responses. MLP can be used to cause an SLP to start a network initiated
location request. </p>
 <p>Symbian has developed an MLP test module for SUPL
Protocol Module testing within Symbian. It is delivered as part of the LBS
source distribution at <span class="filepath">&lt;LBS_ROOT&gt;\test\testproduct\supl\tools\mlpmodule</span>.
The MLP module is used by the Symbian SUPL TEF tests to drive SUPL servers
for testing. The MLP is packaged in <span class="filepath">lbsmlpmodule.dll</span>.
The MLP module interface is defined in <span class="filepath">lbsmlpmodule.h</span>. </p>
 <p>The
MLP Module is not required to test the SUPL Protocol Module with an SLP. It
does not have a published interface but can be used by licensees to send an
MLP Standard Location Immediate Request (SLIR) via HTTP Post to an SLP to
initiate a network initiated location request. The server responds with a
Standard Location Immediate Answer (SLIA) that can be parsed by the MLP. </p>
 <p>To
use the MLP Module a client opens a server connection and uses one of several
request methods to send an SLIR to an SLP. The method <samp class="codeph">SendParseLocRequestFromFileL()</samp> can
be used to read an SLIR document (which must conform to the SLIR DTD [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">3</a>])
from a file, send the contents to an SLP and parse the returned SLIA to extract
a returned handset number and reference position. </p>
 <p>If the contents
of the SLIR are correctly defined, the SLP will respond by sending a <samp class="codeph">SUPL
INIT</samp> message to the handset number (MSID) specified in the SLIR. </p>
 <p>The
example code shown below outlines how to use the MLP module to start a <samp class="codeph">SUPL
INIT</samp>. </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-4972DF0E-0A08-57D9-8616-37F7EE37A2B9"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-4972DF0E-0A08-57D9-8616-37F7EE37A2B9"><!-- --></a>
#include &lt;lbsmlpmodule.h&gt;

...    

_LIT(KTestSLIRFile1, "c:\\testdata\\configs\\slir1.txt"); // Set this to the location of SLIR data file
_LIT8(KTheURL, "http://slp_hostname:port/"); // Set this to the SLP host &amp; port

TPtrC theFile(KTestSLIRFile1);
TPtrC8 url(KTheURL);

HBufC8* handset = NULL; 
TPosition pos;
TInt timeout = 300; // MLP times out if no SLIA received from SLP
TInt error;
    
TAny* serverState = OpenServerL(url);
error = SendParseLocRequestFromFileL(serverState, theFile, timeout, handset, pos);
 
// Can check the handset and pos variables to verify what the SLP returned in the SLIA
// If all is well, SLP should send SUPL INIT messsage to the handset specified in the SLIR
// WAP Push plug-in or SMS Trigger plug-in will process the SUPL INIT and SPM will open a connection to the SLP...
 
// Cleanup
if (handset)
 {
 delete handset;
 }

CloseServer(serverState);
</pre>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A0D16304-B733-5CE8-9038-70DDF8C6493E"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A0D16304-B733-5CE8-9038-70DDF8C6493E"><!-- --></a><strong>SUPL Protocol Module development
logging</strong> </p>
 <p>The LBS subsystem contains a logging component in <span class="filepath">lbspartnercommon.dll</span>.
The logging component is used by many LBS subsystem components to write logs
to a file. The source file <span class="filepath">&lt;LBS_ROOT&gt;\LbsPartnerCommon\inc\lbsdevloggermacros.h</span> contains
logging macro definitions wrapped in the following <samp class="codeph">#ifdef</samp> statement: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-42D8E23B-B560-5C01-BB9F-63BCCF7B860A"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-42D8E23B-B560-5C01-BB9F-63BCCF7B860A"><!-- --></a>
#if defined(ENABLE_LBS_DEV_LOGGER) &amp;&amp; (defined(_DEBUG)||defined(__WINS__))

// LBS logging macro definitions - details omitted

#endif
</pre>
 <p>The SUPL Protocol Module contains its own logging component
in <span class="filepath">supldevlogger.dll</span>. The source file <span class="filepath">&lt;LBS_ROOT&gt;\LbsSuplProtocolModule\SuplDevLogger\inc\supldevloggermacros.h</span> contains the logging macro definitions wrapped in the following <samp class="codeph">#ifdef</samp> statement: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-27F2E716-9BF3-5BDC-8422-91EB07628DE7"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-27F2E716-9BF3-5BDC-8422-91EB07628DE7"><!-- --></a>
#if defined(ENABLE_SUPL_DEV_LOGGER) &amp;&amp; (defined(_DEBUG)||defined(__WINS__))

// SUPL logging macro definitions - details omitted

#endif
</pre>
 <p>The logging macros are used for debugging only and are not
part of a published interface. </p>
 <p>For an emulator build, log messages
from the SUPL Protocol Module and other LBS components are written to <span class="filepath">\epoc32\winscw\c\logs\lbs\lbs.txt</span>.
Logging is also enabled for hardware debug builds. </p>
 <p>The macro <samp class="codeph">ENABLE_LBS_DEV_LOGGER</samp> is
defined in several LBS subsystem MMP files. The macro <samp class="codeph">ENABLE_SUPL_DEV_LOGGER</samp> is
defined in the SUPL Protocol Module MMP files. Logging is turned on for emulator
builds and for hardware debug builds. It is necessary to modify the <samp class="codeph">#if</samp> condition
in <span class="filepath">lbsdevloggermacros.h </span> and <span class="filepath">supldevloggermacros.h</span> and
recompile the LBS codebase to obtain logging messages for hardware release
builds. Development logging should not be permanently enabled for release
builds. </p>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-98ADB801-5665-5677-8A46-EB9F3BE40B45"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-98ADB801-5665-5677-8A46-EB9F3BE40B45"><!-- --></a><h2 class="sectiontitle">Optional tasks</h2> <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1B8100CB-B9C2-5C7E-8973-EC0FF06E06C5"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-1B8100CB-B9C2-5C7E-8973-EC0FF06E06C5"><!-- --></a><strong>Create an application for
managing SLP host settings</strong> </p>
 <p><a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54">Configure
the SUPL Location Platform host settings</a> describes how to configure
SLP host settings using a central repository initialisation file. </p>
 <p>Symbian
licensees may have previously created a settings application for configuring
LBS subsystem behaviour at runtime using the <a href="GUID-9348D79B-D4BF-50B0-B787-DDA2765CE058.html" title="This document describes the LBS administration service and the API that it supports.">LBS
Administration API</a>. Such an application can be extended to allow users
to configure SLP host settings using the <a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host
Settings API</a>. </p>
 <p>This is an optional task because it is not necessary
to give device users any visibility of the host settings or control over them. </p>
 <p>See <a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host Settings API</a> for
details of how to configure the host settings at runtime. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6E2ED828-D1D6-5FA8-9508-058360932E1B"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6E2ED828-D1D6-5FA8-9508-058360932E1B"><!-- --></a><strong>Create a handler for SUPL
INIT messages received via SMS Trigger</strong> </p>
 <p>The <a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL
Protocol Module Overview</a> describes the WAP Push plug-in and test SMS
Trigger plug-in that can be used to process <samp class="codeph">SUPL INIT</samp> messages
to begin network initiated location requests (MT-LRs). </p>
 <p>The WAP Push
plug-in can be used to receive <samp class="codeph">SUPL INIT</samp> messages sent using
WAP Push. The plug-in is packaged in <samp class="codeph">lbssuplwappush.dll</samp> and
is automatically built into an <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C99DDA3C-FB8D-5C87-95EB-787BC4E58651">LBS
SUPL ROM image</a> unless it is deliberately excluded. The WAP Push plug-in
is loaded by the WAP Push Framework. </p>
 <p>The SMS Trigger plug-in can be
used to receive <samp class="codeph">SUPL INIT</samp> messages sent using SMS. The SMS
Trigger plug-in is a Symbian <em>test component</em>. The plug-in is packaged
in <samp class="codeph">lbssuplsmstrigger.dll</samp> and is automatically built into
an <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-C99DDA3C-FB8D-5C87-95EB-787BC4E58651">LBS
SUPL ROM image</a> unless it is deliberately excluded. The SMS Trigger
plug-in is loaded by the Symbian messaging Watcher Framework. </p>
 <p>It is
possible for Symbian licensees to build their own handler for processing <samp class="codeph">SUPL
INIT</samp> messages received via SMS. The only requirement for any licensee-implemented <samp class="codeph">SUPL
INIT</samp> message handler is that it uses the <a href="GUID-E7DD9CFD-F477-5D25-BC10-BEBFB1022F7E.html" title="The SUPL Push API is used to process SUPL INIT messages sent from a SUPL Location Platform (SLP).">SUPL
Push API</a> to send the SUPL INIT message into the SUPL Protocol Module. </p>
 <p>The
source code of the test Symbian SUPL SMS Trigger plug-in can be found in the
LBS source code tree at <span class="filepath">&lt;LBS_ROOT&gt;/LbsSuplProtocolModule/SuplSmsTrigger/</span>. </p>
 <p>The
source code of the WAP Push plug-in can be found in the LBS source code tree
at <span class="filepath">&lt;LBS_ROOT&gt;/LbsSuplProtocolModule/SuplWapPush/</span>. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-9F4E4AED-4276-5587-81FF-E43883A51971"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-9F4E4AED-4276-5587-81FF-E43883A51971"><!-- --></a><strong>Provision SLP root certificate
for TLS</strong> </p>
 <p>To use Transport Level Security (TLS) for communication
encryption between the mobile device and the SLP it is necessary to import
the SLP root certificate into a certificate store on the mobile device. While
using TLS is not required for simple testing, it is required for SET - SLP
communications in production deployments [<a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254">1</a>]. </p>
 <p>Certificate stores are managed using the Symbian <span class="filepath">certtool</span> application.
The tool is used to import certificates for use in the Symbian emulator and
allows them to be exported to ROM. </p>
 <p>The document <a href="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544.html">Example
for Creating a Default Certificate Store</a> describes how to use certtool
to create certificate stores for the Symbian emulator and a ROM. Briefly the
steps required are as follows: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-578067EA-905A-5382-89B6-994496EE5A08"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-578067EA-905A-5382-89B6-994496EE5A08"><!-- --></a><p>Obtain the certificate
that the SLP uses for TLS. </p>
 <p>The SLP vendor, or the network operator
that owns the SLP should be able to provide a certificate. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-75471AC1-F1EA-510B-B9C5-A7DCEED47948"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-75471AC1-F1EA-510B-B9C5-A7DCEED47948"><!-- --></a><p>Import the certificate
into a Symbian certificate store. </p>
 <p>The certificate is imported using
the <samp class="codeph">certtool                   -import</samp> command as follows: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-78C197FD-9017-5122-A00F-A11C1746172F"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-78C197FD-9017-5122-A00F-A11C1746172F"><!-- --></a>
certtool -label &lt;label-name&gt; –import &lt;certificate-file&gt;
</pre>
 <p>where <em>label-name</em> is a name used to identify the certificate
and <em>&lt;certificate-file&gt;</em> is the filename of the certificate provided
by the SLP vendor. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2865169D-A3CB-5999-9562-E3F2061E2309"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-2865169D-A3CB-5999-9562-E3F2061E2309"><!-- --></a><p>Trust the SLP vendor
certificate for use with TLS. </p>
 <p>The certificate is trusted for use with
TLS using the <samp class="codeph">certtool -setapps -apps</samp> command as follows: </p>
 <pre class="codeblock" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6BC6A9F2-E0B6-5BFE-9F36-F83860273AC5"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6BC6A9F2-E0B6-5BFE-9F36-F83860273AC5"><!-- --></a>certtool –setapps –apps SSL/TLS &lt;label-name&gt;</pre>
 <p>where <em>label-name</em> is
the label given to the certificate when it was imported into the certificate
store. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5805699D-A0C3-50F9-82F8-B67B14387BDB"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5805699D-A0C3-50F9-82F8-B67B14387BDB"><!-- --></a><p>The host settings must
be modified to specify that TLS must be used between the SUPL Protocol Module
and the SUPL Location Platform as described in the section <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54">Configure the SUPL Location Platform host settings</a>. </p>
 </li>

</ul>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-62ECFF09-BBED-59FF-A835-057A67309E62"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-62ECFF09-BBED-59FF-A835-057A67309E62"><!-- --></a><strong>Create a plug-in to obtain
a pre-shared key for PSK-TLS</strong> </p>
 <p> <strong>Note: The Pre-Shared Keys API
is not yet implemented and it is not yet possible to use PSK-TLS with the
SUPL Protocol Module.</strong>  </p>
 <p>A future release of the SUPL Protocol Module
will include support to retrieve a pre-shared key via the Pre-Shared Keys
(PSK) API, which will enable the use of PSK-TLS. When the PSK API is implemented
this section will describe how to configure LBS to use it. It is not yet possible
to use PSK-TLS with the SUPL Protocol Module. </p>
 <p>Alternative Client Authentication
(ACA-TLS) is currently supported by the SUPL Protocol Module. </p>
 <p id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F4BA8794-2F67-5AE3-B099-FFCC156F6722"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-F4BA8794-2F67-5AE3-B099-FFCC156F6722"><!-- --></a><strong>Define conflict control
rules</strong> </p>
 <p> <strong>Configurable conflict control is not yet suported by
the SUPL Protocol Module.</strong>  </p>
 <p>Currently a simple set of rules is
built into the SUPL Protocol Module for the following situations when a second
location request is received by LBS while a previously received location request
is still being processed: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-694BE785-64ED-550D-8870-9EBEC643F8CA"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-694BE785-64ED-550D-8870-9EBEC643F8CA"><!-- --></a><p>SET initiated location
request followed by a second SET initiated location request from a new client
(two MO-LRs). </p>
 <p>Figure 1 illustrates the discussion that follows, which
assumes the LBS subsystem is configured to use terminal based GPS. </p>
 <p>A <em>new
client</em> is one that opens a subsession by calling <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-AF3D9B5F-8025-3AFF-A101-82025520EBD6"><span class="apiname">RPositioner::Open()</span></a> and
makes its first position update request by calling <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-321F6046-3551-3ACE-B0A3-26D51FAEB477"><span class="apiname">RPositioner::NotifyPositionUpdate()</span></a>. </p>
 <p>As
shown in figure 1 the location request from each client causes a call to <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> to
be made on the SUPL Protocol Module by the LBS subsystem. </p>
 <p>For the
first request (from Client 1 in figure 1) the SUPL Protocol Module requests
and receives assistance data from the network and this is used by the LBS
subsystem (by an A-GPS Positioning Module) to begin to calculate a position. </p>
 <p>A
second location request (from Client 2 in figure 1) causes another call to <samp class="codeph">RequestSelfLocation()</samp> to
be made on the SUPL Protocol Module, but it is not processed if the first
request is still being processed. The SUPL Protocol Module rejects the request
by simply calling <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-ACBFB09B-D4D1-36A0-A9D6-FD3207E93E30"><span class="apiname">MLbsNetworkProtocolObserver::ProcessSessionComplete()</span></a> on
the LBS subsystem with status <samp class="codeph">KErrServerBusy.</samp>  </p>
 <p>If
the request is rejected by the SUPL Protocol Module the LBS Location Server
completes ALL client application requests and sets their status to <samp class="codeph">KErrServerBusy</samp>.
In figure 1 both Client 1 and Client 2 receive status <samp class="codeph">KErrServerBusy</samp>. </p>
 <div class="fignone" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCD0CDE1-EA45-53D3-A2DE-F38786408881"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-DCD0CDE1-EA45-53D3-A2DE-F38786408881"><!-- --></a><span class="figcap">Figure 1.                       Figure 1. Processing of two SET initiated requests
from                      different clients.                    </span>

<img src="GUID-09EFBBDE-780D-5A16-8E3B-78DEFF1F8938_d0e457572_href.png"/>
</div>
 <p> <em>Making a location request after receiving KErrServerBusy</em>  </p>
 <p>A
client that receives the error <samp class="codeph">KErrServerBusy</samp> will usually
want to make the request again to obtain a position update. </p>
 <p>In many
cases all that is required is to make another call to <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-321F6046-3551-3ACE-B0A3-26D51FAEB477"><span class="apiname">RPositioner::NotifyPositionUpdate()</span></a>.
The LBS subsystem calls <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> on
the SUPL Protocol Module with the new client flag set to false. </p>
 <p>When
the new client flag is false the Protocol Module simply completes the request
by calling <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-ACBFB09B-D4D1-36A0-A9D6-FD3207E93E30"><span class="apiname">MLbsNetworkProtocolObserver::ProcessSessionComplete()</span></a> with
return code<samp class="codeph"> KErrNone</samp> and does not request assistance data
from the network. </p>
 <p>The behaviour that a client observes depends on
whether LBS previously received assistance data that allowed the A-GPS Positioning
Module to calculate a position. There are two possibilities: </p>
 <ul>
<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5B33A0DE-6B61-5E3C-A8C7-805243D662DB"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-5B33A0DE-6B61-5E3C-A8C7-805243D662DB"><!-- --></a><p>The A-GPS Positioning
Module has calculated a position and has returned it to LBS. </p>
 <p>This
position can be returned to the client. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6777B793-077B-5E2E-8D4D-82E5133A975C"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-6777B793-077B-5E2E-8D4D-82E5133A975C"><!-- --></a><p>The A-GPS Positioning
Module has not calculated a position because it has no assistance data. </p>
 <p>A
position cannot be returned to the client and the request may time out (if
the client specified a request timeout). </p>
 <p>To get assistance data from
the network the client must be identified to the SUPL Protocol Module as a
new client. To do this a client calls <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-DE09BADB-6D90-3995-A893-F949F9C37A2B"><span class="apiname">RPositioner::Close()</span></a> and <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-AF3D9B5F-8025-3AFF-A101-82025520EBD6"><span class="apiname">RPositioner::Open()</span></a> before
calling <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-321F6046-3551-3ACE-B0A3-26D51FAEB477"><span class="apiname">RPositioner::NotifyPositionUpdate()</span></a>. </p>
 </li>

</ul>
 <p>Note that in general a second SET initiated request made by a new
client soon after the successful completion of a different new client request
may also complete with status <samp class="codeph">KErrServerBusy</samp> because the
SUPL Protocol Module has not yet received a <samp class="codeph">SUPL END</samp> message
from the network. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-762747F6-FBA7-5486-A43D-DEA978D7E9DB"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-762747F6-FBA7-5486-A43D-DEA978D7E9DB"><!-- --></a><p>Network initiated location
request followed by a second network initiated location request (two MT-LRs). </p>
 <p>The
second location request is not processed. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A161782D-7716-5241-BE3C-D2691A8B3F80"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A161782D-7716-5241-BE3C-D2691A8B3F80"><!-- --></a><p>SET initiated location
request followed by a network initiated location request (MO-LR then MT-LR). </p>
 <p>The
SET initiated location request is completed. The second location request is
not processed. </p>
 </li>

<li id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-87F72D74-524B-5D51-861E-F7CBEF31E872"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-87F72D74-524B-5D51-861E-F7CBEF31E872"><!-- --></a><p>Network initiated location
request followed by a SET initiated location request (MT-LR then MO-LR). </p>
 <p>The
outstanding network initiated location request (MT-LR) is cancelled, and the
SET initiated location request (MO-LR) is completed. </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-89156A75-D752-51FE-9949-DF080B4C8EB0"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-89156A75-D752-51FE-9949-DF080B4C8EB0"><!-- --></a><h2 class="sectiontitle">See also</h2> <p><a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL Protocol Module Overview</a>  </p>
 <p><a href="GUID-E7DD9CFD-F477-5D25-BC10-BEBFB1022F7E.html" title="The SUPL Push API is used to process SUPL INIT messages sent from a SUPL Location Platform (SLP).">SUPL Push API</a>  </p>
 <p><a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host Settings API</a>  </p>
 <p><a href="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544.html">Example for Creating a Default
Certificate Store</a>  </p>
 </div>

<div class="section" id="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254"><a name="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-A3C8C7E8-981F-5CF1-A69C-0C1110951254"><!-- --></a><h2 class="sectiontitle">References</h2> <p>[1] <a href="http://www.openmobilealliance.org" target="_blank">Open Mobile Alliance</a> Secure
User Plane Location (SUPL) Architecture OMA-AD-SUPL-V1_0-20070615-A </p>
 <p>[2] <a href="http://www.openmobilealliance.org" target="_blank">Open Mobile Alliance</a> Enabler
Test Specification for SUPL OMA-ETS-SUPL-V1_0-20070116-C </p>
 <p>[3] <a href="http://www.openmobilealliance.org" target="_blank">Open Mobile Alliance</a> Mobile
Location Protocol OMA-LIF-MLP-V3_1-20040316-C </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>