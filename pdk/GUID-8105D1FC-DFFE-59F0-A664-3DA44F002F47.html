<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Enabling File Server Tracing"/>
<meta name="abstract" content="This document describes how to enable trace points in the file server client API (EFSRV.DLL), the file system API (*.FSY) , and/or the proxy drive API."/>
<meta name="description" content="This document describes how to enable trace points in the file server client API (EFSRV.DLL), the file system API (*.FSY) , and/or the proxy drive API."/>
<meta name="DC.Relation" scheme="URI" content="GUID-D3DD5F07-A383-5285-8C68-9F6C1C3E715B.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BB9760B4-4F3F-5326-81FB-B644C82F0E65.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-198DCED1-F429-5C95-A51D-53AE416687E8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D3DD5F07-A383-5285-8C68-9F6C1C3E715B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7B477BA5-CC5B-56A2-82BC-E1BC0049FECB.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Enabling File Server Tracing</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2399034 id2399048 id2399063 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-BB9760B4-4F3F-5326-81FB-B644C82F0E65.html" title="Symbian platform manages the basic permanent storage of data through file systems. Drives and file systems are common resources used by many programs, and access to them is managed by the File Server. The File Server is flexible, and can use many different file system formats and physical storage media. Applications and services access files, directories, and drives through the File Server client side API.">File Server</a> &gt; <a href="GUID-198DCED1-F429-5C95-A51D-53AE416687E8.html">File Server Client Side</a> &gt; <a href="GUID-D3DD5F07-A383-5285-8C68-9F6C1C3E715B.html">File Server tracing concepts</a> &gt; </div>
<h1 class="topictitle1">Enabling File Server Tracing</h1>
<div><p>This document describes how to enable trace points in the
file server client API (EFSRV.DLL), the file system API (*.FSY) ,
and/or the proxy drive API. </p>

<div class="section" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-E4208794-E751-4626-A457-FB81B330AC9E"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-E4208794-E751-4626-A457-FB81B330AC9E"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>Enabling a trace point results in trace data being output to
the trace buffer. </p>
 <p>Tracing can be enabled or disabled (i.e.
compiled in or out) at build time. By default file server tracing
is enabled in debug builds of EFSRV.DLL and EFILE.EXE and disabled
in release builds. To enable tracing in release builds, there are
two options: </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-CE4CBA1C-D699-568D-B97D-98CD01E7ADAC"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-CE4CBA1C-D699-568D-B97D-98CD01E7ADAC"><!-- --></a><p>replace the
release builds of <span class="filepath">EFSRV.DLL</span> /<span class="filepath">EFILE.EXE</span> with their debug equivalents. </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-76F59D55-BE9A-54E2-9A77-068F292334B0"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-76F59D55-BE9A-54E2-9A77-068F292334B0"><!-- --></a><p>rebuild <span class="filepath">EFSRV.DLL</span> /<span class="filepath">EFILE.EXE</span> using <span class="filepath">efsrv_instrumented.mmp</span> /<span class="filepath">efile_instrumented.mmp</span>. </p>
 </li>

</ul>
 <p>Tracing can also be enabled or disabled at run time or at
device startup. For more information, see <strong>Symbian^3 Tools Guide
&gt; Debugging</strong>. </p>
 <p>The level of tracing required may be configured
by selecting one or more of the primary filters and one or more of
the secondary filters from the list below: </p>
 <pre class="codeblock" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-DDA48DE7-651D-54D4-A3EA-81C053D5F4BC"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-DDA48DE7-651D-54D4-A3EA-81C053D5F4BC"><!-- --></a>//Primary filters
EPanic = 192            // to trace panics
EError = 193            // to trace errors
EBorder = 195,            // to trace API calls</pre>
 <pre class="codeblock" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-3253FF5A-ABAC-5A2D-9CE9-D420B855FB88"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-3253FF5A-ABAC-5A2D-9CE9-D420B855FB88"><!-- --></a>//Secondary filters
EF32TraceUidEfsrv         =     0x100039e4 //    (268450276 in decimal)
EF32TraceUidFileSys        =    0x10286575 //    (271082869 in decimal)
EF32TraceUidProxyDrive    =    0x10286576 //    (271082870 in decimal)</pre>
<p> For more information on capturing the trace data, see <strong>Symbian^3
Tools Guide &gt; Debugging</strong>.  </p>
 </div>

<div class="section" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-AF241F65-5BCA-4BDA-9852-EF6033574A5E"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-AF241F65-5BCA-4BDA-9852-EF6033574A5E"><!-- --></a><h2 class="sectiontitle">APIs </h2> <p>The following table lists the classes to which the trace points
have been added. It has been divided into three broad categories as
shown below. </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-930F772C-DC22-5D44-92D5-1EED6CDC02A9"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-930F772C-DC22-5D44-92D5-1EED6CDC02A9"><!-- --></a><p> <strong>File system</strong>  </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-938ED57F-0365-56BA-BD78-854CAE8BC344"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-938ED57F-0365-56BA-BD78-854CAE8BC344"><!-- --></a><p> <a href="GUID-0012B043-9FC4-3953-928E-CB6107E0486A.html"><span class="apiname">CFileSystem</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-5A54ADD0-2F79-54A2-8725-EE738F51FC5F"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-5A54ADD0-2F79-54A2-8725-EE738F51FC5F"><!-- --></a><p> <a href="GUID-FADDE053-CC1C-39BC-A52D-27093041BE20.html"><span class="apiname">CMountCB</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-87CD0966-EE3B-5517-B69D-024B308EB4B1"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-87CD0966-EE3B-5517-B69D-024B308EB4B1"><!-- --></a><p> <a href="GUID-63DF657C-434D-353D-A536-8AF9D97C8260.html"><span class="apiname">CFileCB</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-08DCCC4C-2A4B-560C-96C2-55C949086F4B"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-08DCCC4C-2A4B-560C-96C2-55C949086F4B"><!-- --></a><p> <a href="GUID-B19ADEA9-5018-3773-92BC-C16306D15043.html"><span class="apiname">CDirCB</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-901B069A-A234-5238-94C0-B88723DA0698"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-901B069A-A234-5238-94C0-B88723DA0698"><!-- --></a><p> <a href="GUID-E0C22CEA-845F-37A2-85DE-0ACD7927FA41.html"><span class="apiname">CFormatCB</span></a>  </p>
 </li>

</ul>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-54DAF9C2-385A-5C5D-B808-DD42BD96D2B2"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-54DAF9C2-385A-5C5D-B808-DD42BD96D2B2"><!-- --></a><p> <strong>Proxy drive</strong>  </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-D082BF1C-A7F1-597D-BE7E-19FDAFE25368"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-D082BF1C-A7F1-597D-BE7E-19FDAFE25368"><!-- --></a><p> <a href="GUID-F47F56E4-3754-365B-B529-53C1D2A29503.html"><span class="apiname">CLocalProxyDrive</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-7115117E-68B1-5CCB-BEAE-668CF45DE9AD"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-7115117E-68B1-5CCB-BEAE-668CF45DE9AD"><!-- --></a><p> <a href="GUID-FAFF712B-2295-3907-B839-D77F052160DA.html"><span class="apiname">CBaseExtProxyDrive</span></a>  </p>
 </li>

</ul>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-ABC75EC4-EBBE-5F85-AA09-A1E77B121FBC"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-ABC75EC4-EBBE-5F85-AA09-A1E77B121FBC"><!-- --></a><p> <strong>File server</strong>  </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-54E6118B-454D-50B6-8BA1-6C5A74E6A70C"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-54E6118B-454D-50B6-8BA1-6C5A74E6A70C"><!-- --></a><p> <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html"><span class="apiname">RFile</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-E9839BE3-3F7B-54BE-A52A-ECEBC4CE7691"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-E9839BE3-3F7B-54BE-A52A-ECEBC4CE7691"><!-- --></a><p> <a href="GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html"><span class="apiname">RFs</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-5D365808-C2C1-5CC3-9E69-1423C47CBCE5"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-5D365808-C2C1-5CC3-9E69-1423C47CBCE5"><!-- --></a><p> <a href="GUID-12AE154F-7741-38C0-ADFE-9784FCF5E516.html"><span class="apiname">RDir</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-D4F74F2A-F919-5AB9-89EA-1C45420E4391"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-D4F74F2A-F919-5AB9-89EA-1C45420E4391"><!-- --></a><p> <a href="GUID-9D7E765B-6872-3EB9-9D5B-1503FA466EC1.html"><span class="apiname">RFormat</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-39021B3E-2F79-51A7-8158-4D08B94CCF4D"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-39021B3E-2F79-51A7-8158-4D08B94CCF4D"><!-- --></a><p> <a href="GUID-118CCC9E-C58B-3AA0-86A8-219914E7E7BC.html"><span class="apiname">RPlugin</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-264C14C5-69D3-5662-9BFD-15B7FCB22F00"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-264C14C5-69D3-5662-9BFD-15B7FCB22F00"><!-- --></a><p> <a href="GUID-82CEC14F-1479-3922-846A-9FCDB6465EF7.html"><span class="apiname">CFileMan</span></a>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-817F4158-5F9F-5D21-9FA1-42D5EC6F774F"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-817F4158-5F9F-5D21-9FA1-42D5EC6F774F"><!-- --></a><p> <a href="GUID-C657AF2D-1183-3CD2-ACAF-3B0B00FC91BB.html"><span class="apiname">CDirScan</span></a>  </p>
 </li>

</ul>
 </li>

</ul>
 <p>Trace points have been added to the public exported functions
of the classes listed above. As an example, the code fragment below
illustrates how the tracepoints have been added and what type of information
is output for the Open function of the <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html"><span class="apiname">RFile</span></a> class: </p>
 <pre class="codeblock" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-44DCCB86-9835-5A03-A17C-A78F43A58FD6"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-44DCCB86-9835-5A03-A17C-A78F43A58FD6"><!-- --></a>
EFSRV_EXPORT_C TInt RFile::Open(RFs&amp; aFs,const TDesC&amp; aName,TUint aMode)
{
TRACEMULT3(UTF::EBorder, UTraceModuleEfsrv::EFileOpen, MODULEUID, aFs.Handle(), aMode, aName);

aMode &amp;= ~EFileBigFile;
TInt r = CreateSubSession(aFs,EFsFileOpen,TIpcArgs(&amp;aName,aMode));

TRACERET2(UTF::EBorder, UTraceModuleEfsrv::EFileOpenReturn, MODULEUID, r, SubSessionHandle());

return r;
}</pre>
 <p>A sample trace output is as shown: </p>
 <pre class="codeblock" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-A7782683-9A99-5B9B-AD52-81CC236CB7D1"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-A7782683-9A99-5B9B-AD52-81CC236CB7D1"><!-- --></a>RFile::Open() sess 0x00008000 mode 0x00000100 FileName Z:\SYS\DATA\ESTARTFILESYSTEMS.TXT</pre>
 </div>

<div class="section" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-A46311CE-B4C4-4BE9-A698-5DC1C18D6C60"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-A46311CE-B4C4-4BE9-A698-5DC1C18D6C60"><!-- --></a><h2 class="sectiontitle">Interpretation
of the trace data</h2> <p>Symbian does not currently provide a
tool for decoding file server trace data (though hopefully this will
change in the near future). The data can, however, be interpreted
by examining the following two publicly exported header files which
provides detail of what fields are output by each tracepoint. </p>
 <ul>
<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-3032957A-5D64-57AD-98FD-DF82D6959C10"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-3032957A-5D64-57AD-98FD-DF82D6959C10"><!-- --></a><p> <span class="filepath">\epoc32\include\utraceefsrv.h </span>  </p>
 </li>

<li id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-8C8C91AD-757A-5A79-861B-2686178FB154"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-8C8C91AD-757A-5A79-861B-2686178FB154"><!-- --></a><p> <span class="filepath">\epoc32\include\utraceefile.h</span>  </p>
 </li>

</ul>
 <p>For example: </p>
 <pre class="codeblock" id="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-2B0DD8BA-5AC5-5369-8410-4A21B987D926"><a name="GUID-8105D1FC-DFFE-59F0-A664-3DA44F002F47__GUID-2B0DD8BA-5AC5-5369-8410-4A21B987D926"><!-- --></a>
/** @SYMTraceFormatString "RFile::Replace() sess %x mode %x FileName %*S" */
EFileReplace</pre>
 <p>In the above example the trace record
will contain the session <a href="GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html"><span class="apiname">RFs</span></a> handle, the file open
mode and the filename. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D3DD5F07-A383-5285-8C68-9F6C1C3E715B.html">File Server tracing concepts</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-7B477BA5-CC5B-56A2-82BC-E1BC0049FECB.html" title="The kernel trace tool is a user-side client DLL which provides an interface for extracting trace data from a memory buffer">Kernel
Trace Tool Overview</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>