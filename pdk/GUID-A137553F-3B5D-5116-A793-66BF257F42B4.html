<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Rights Manager API Tutorial"/>
<meta name="abstract" content="Applications can use the ContentAccess::CRightsManager class to manage Digital Rights Management (DRM) rights within a particular DRM agent."/>
<meta name="description" content="Applications can use the ContentAccess::CRightsManager class to manage Digital Rights Management (DRM) rights within a particular DRM agent."/>
<meta name="DC.Relation" scheme="URI" content="GUID-8F457DE7-DAC2-56DF-8D6D-76D86584CC79.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E6C91CF2-A616-5E52-8BB2-630C42C8D540.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7EE46FD9-DC9E-5C1F-9AC5-48F5212AF0CA.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8F457DE7-DAC2-56DF-8D6D-76D86584CC79.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-A137553F-3B5D-5116-A793-66BF257F42B4"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Rights Manager API Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2858692 id2858712 id2858786 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-E6C91CF2-A616-5E52-8BB2-630C42C8D540.html">Content Management</a> &gt; <a href="GUID-7EE46FD9-DC9E-5C1F-9AC5-48F5212AF0CA.html">Content Access Framework</a> &gt; <a href="GUID-8F457DE7-DAC2-56DF-8D6D-76D86584CC79.html">Content Access Framework Tutorials</a> &gt; </div>
<h1 class="topictitle1">Rights
Manager API Tutorial</h1>
<div><p>Applications can use the <samp class="codeph">ContentAccess::CRightsManager</samp> class
to manage Digital Rights Management (DRM) rights within a particular DRM agent. </p>

<div class="section" id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-B080A3A2-FDD5-4F98-B3FE-D68D5A49B237"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-B080A3A2-FDD5-4F98-B3FE-D68D5A49B237"><!-- --></a><h2 class="sectiontitle">Required background</h2> <p>Before you start, you must
understand: </p>
 <ul>
<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-07B8B672-591F-5188-A6B6-A8369627CCA0"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-07B8B672-591F-5188-A6B6-A8369627CCA0"><!-- --></a><p> <a href="GUID-84B6389A-55CC-53EB-8725-65F753FD7217.html"> Content
Access Framework for DRM</a> </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-DB0B1394-6A5F-50DD-B730-9B7D70EDEE6F"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-DB0B1394-6A5F-50DD-B730-9B7D70EDEE6F"><!-- --></a><p> <a href="GUID-29677CD7-DC09-590E-85AC-FF563233A205.html"> Digital
Rights Management</a> </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A89F8ADE-7820-4867-8BE8-0165E3A4BB35"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A89F8ADE-7820-4867-8BE8-0165E3A4BB35"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>Rights Manager API gives simple access
to the rights within a CAF agent implementing a DRM scheme. The rights are
represented in a generic form using the <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-1C5F342A-2425-33C6-9769-90B3EC98A213"><span class="apiname">ContentAccess::CRightsInfo</span></a> class.
This class holds a text description of the rights and some simple properties
associated with these rights. </p>
 <p>Rights Manager API also allows applications
to determine which content files are associated with each rights object and
vice versa. </p>
 </div>

<div class="section" id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-B18DBC90-1E91-41E8-8153-5BEEEEAA5559"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-B18DBC90-1E91-41E8-8153-5BEEEEAA5559"><!-- --></a><h2 class="sectiontitle">Procedure</h2> <a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-0DAC3612-40B3-5CA7-A931-D06A94658C40"><!-- --></a><ol id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-0DAC3612-40B3-5CA7-A931-D06A94658C40">
<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-AB4439A9-3CF6-51F8-AB1B-381E7A8CD399"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-AB4439A9-3CF6-51F8-AB1B-381E7A8CD399"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A5D2126D-E744-5376-88E4-40AC9BFF92A4">Create a DRM rights management object</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A0E3D75A-BFC7-5F7D-A58D-00B0C0323642"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A0E3D75A-BFC7-5F7D-A58D-00B0C0323642"><!-- --></a><p>Perform one or more
of the following tasks as per your requirement: </p>
 <ul>
<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-340B8678-49FF-5B40-B9B2-BA5FD6E60CA2"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-340B8678-49FF-5B40-B9B2-BA5FD6E60CA2"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-1E57BE18-5EFF-587C-A263-2606BE557DC4">List all rights objects</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-23853DD9-B8F1-5EF3-A462-C08BF134C563"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-23853DD9-B8F1-5EF3-A462-C08BF134C563"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-080F1FCA-ACC0-52F6-8BA7-7CC2DB52F2E0">List the rights associated with a content file</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-4E40636C-B3D7-5D73-A97C-09B306606CD4"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-4E40636C-B3D7-5D73-A97C-09B306606CD4"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6E6BC94B-7C94-53AD-9A21-73FAE10C2C9B">List the rights associated with a content object</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-1646306D-47A8-5AAB-A4A2-11DC2FA19403"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-1646306D-47A8-5AAB-A4A2-11DC2FA19403"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B5A514E-4399-5292-9D3D-1E1DBB861338">List the content associated with a rights object</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-0AB8C520-52A7-5CDB-9AD3-E1B67558D659"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-0AB8C520-52A7-5CDB-9AD3-E1B67558D659"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-29DC21D6-900C-5EF3-84D6-1FE89FE8FD1D">Retrieve a rights object</a>. </p>
 </li>

<li id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-7572CDFF-15B8-505F-B762-1A67B0A1457C"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-7572CDFF-15B8-505F-B762-1A67B0A1457C"><!-- --></a><p> <a href="GUID-A137553F-3B5D-5116-A793-66BF257F42B4.html#GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B934FC5-76EC-599E-914C-7AB1D553F171">Delete a rights object</a>. </p>
 </li>

</ul>
 </li>

</ol>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A5D2126D-E744-5376-88E4-40AC9BFF92A4"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-A5D2126D-E744-5376-88E4-40AC9BFF92A4"><!-- --></a>Create a DRM rights
management object</strong></p>
<p>The <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-2CBEF3AA-7101-3247-BAED-79B624CEBBD1"><span class="apiname">ContentAccess::CRightsManager</span></a>object
is created by the <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-671191B1-B249-3DD3-A5E8-6F1A41A371C8"><span class="apiname">ContentAccess::CManager</span></a> object to look
at the rights stored by a particular content access agent. </p>
<pre class="codeblock">// create the CManager object
CManager manager = CManager::NewL(); 

// Create RPointerArray to store pointers to the agents 
RPointerArray &lt;CAgent&gt; agentArray; 
		
// Get the list of agents 
manager-&gt;ListAgentsL(agentArray); 
				
// Create a CRightsManager for the first agent	
CRightsManager *rightsManager = manager-&gt;CreateRightsManagerL(agentArray[0]);</pre>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-1E57BE18-5EFF-587C-A263-2606BE557DC4"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-1E57BE18-5EFF-587C-A263-2606BE557DC4"><!-- --></a>List all rights objects</strong></p>
<p>The <a href="GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49.html#GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49__GUID-35127771-EAC1-3DB7-9B53-53898C75ECF0"><span class="apiname">CRightsManager::ListAllRightsL()</span></a> function
produces a list of all the rights stored in the given DRM agent. </p>
<pre class="codeblock">// Create the array to store rights objects 
RStreamablePtrArray&lt;CRightsInfo&gt; myArray; 
CleanupClosePushL(myArray); 

// Get the rights objects from the agent 
rightsManager-&gt;ListAllRightsL(myArray); 
			
// count the number of rights objects 
TInt numRights = myArray.Count(); 
				
// clear the contents of the array
myArray.ResetAndDestroy();</pre>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-080F1FCA-ACC0-52F6-8BA7-7CC2DB52F2E0"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-080F1FCA-ACC0-52F6-8BA7-7CC2DB52F2E0"><!-- --></a>List
the rights associated with a content file</strong></p>
<p>The<a href="GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49.html#GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49__GUID-A2EFFC6C-13B6-33BD-82B1-57CBBCA19F8C"><span class="apiname"> CRightsManager::ListRightsL()</span></a> function
produces a list of all the rights stored in the given DRM agent that are associated
with the file at a given URI. </p>
<pre class="codeblock">// Get the rights objects associated with the content 
rightsManager-&gt;ListRightsL(myArray, uri); 
		  
// Count the number of rights objects associated with the content 
TInt numRights = myArray.Count(); 
			 
// clear the contents of the array 
myArray.ResetAndDestroy();</pre>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6E6BC94B-7C94-53AD-9A21-73FAE10C2C9B"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6E6BC94B-7C94-53AD-9A21-73FAE10C2C9B"><!-- --></a>List
the rights associated with a content object</strong></p>
<p>The <a href="GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49.html#GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49__GUID-A2EFFC6C-13B6-33BD-82B1-57CBBCA19F8C"><span class="apiname">CRightsManager::ListRightsL()</span></a> function
produces a list of all the rights stored in the given DRM agent that are associated
with the content object at a given virtual path.</p>
<pre class="codeblock">// Get the rights objects assocated with the content 
rightsManager-&gt;ListRightsL(myArray, virtualPath); 

// Count the number of rights objects associated with the content 
TInt numRights = myArray.Count(); 

// clear the contents of the array 
myArray-&gt;ResetAndDestroy();</pre>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B5A514E-4399-5292-9D3D-1E1DBB861338"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B5A514E-4399-5292-9D3D-1E1DBB861338"><!-- --></a>List
the content associated with a rights object</strong></p>
<div class="p">The CRightsManager::ListContentL()
function produces a list of all the content that is associated with the given
rights object. <pre class="codeblock">rightsManager-&gt;ListAllRightsL(myArray);

// get the first CRightsInfo object 
CRightsInfo* aRightsObject = myArray[0]; 

RStreamablePtrArray&lt;CVirtualPath&gt; array;
CleanupClosePushL(array);

// Get the array of content objects associated with the rights 
rightsManager-&gt;ListContentL(array, aRightsObject); 
				  
// count the number of content objects
TInt numContentObjects = array.Count();</pre>
</div>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-29DC21D6-900C-5EF3-84D6-1FE89FE8FD1D"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-29DC21D6-900C-5EF3-84D6-1FE89FE8FD1D"><!-- --></a>Retrieve
a rights object</strong></p>
<p>The CRightsManager::GetRightsDataL() function allows
an application to retrieve a pointer to a rights object. The rights object
is derived from MAgentRightsBase.  </p>
<pre class="codeblock">// Retrieve the full rights object
// The application needs to cast it to the agent's derived Rights class before using it. 

MAgentRightsBase *rightsObject = rightsManager-&gt;GetRightsDataL(aRightsObject);</pre>
<p><strong id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B934FC5-76EC-599E-914C-7AB1D553F171"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-6B934FC5-76EC-599E-914C-7AB1D553F171"><!-- --></a>Delete a rights object</strong></p>
<div class="p">The <a href="GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49.html#GUID-C4B8AE31-6ABD-3FEA-88DD-3B4EE13ACF49__GUID-1F0BE582-5C12-3880-9951-56B7B209FEC1"><span class="apiname">CRightsManager::DeleteRightsObject()</span></a> function
allows an application to delete rights stored by the agent. <pre class="codeblock">// Delete the rights object 
TInt result = rightsManager-&gt;DeleteRightsObject(aRightsObject);</pre>
 </div>
<p>It
is also possible to delete all the rights associated with a particular content
object.  </p>
<pre class="codeblock">// Delete all the rights objects associated with the given content object 
TInt result = rightsManager-&gt;DeleteAllRights(virtualPath);</pre>
 </div>

<div class="section" id="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-64D1E9E3-775F-4B50-8469-78F6600E4852"><a name="GUID-A137553F-3B5D-5116-A793-66BF257F42B4__GUID-64D1E9E3-775F-4B50-8469-78F6600E4852"><!-- --></a><h2 class="sectiontitle">See also</h2> <p> <a href="GUID-920CF819-645B-5705-8017-C1FAD7C6ABAF.html">Manager
API Tutorials</a> </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-8F457DE7-DAC2-56DF-8D6D-76D86584CC79.html">Content Access Framework Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>