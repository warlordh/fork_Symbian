<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Single and Multiple Threads"/>
<meta name="DC.Relation" scheme="URI" content="GUID-39FA0ECE-D403-5F02-AC5D-7BC8E1669E8E.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E2DE2C6F-E071-5E88-96F1-D71DDED84609.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-440FDF7D-B9A0-5767-9FF8-412803C0D2A9.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-39FA0ECE-D403-5F02-AC5D-7BC8E1669E8E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BBBFC0AF-2E35-5F5C-A3A5-57C4196A6CDA.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-890F06C6-DE32-5EB1-BF0F-D41794F47AE1.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Single and Multiple Threads</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711"><a name="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2381103 id2381193 id2381831 id2381851 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html">Generic OS Services Guide</a> &gt; <a href="GUID-E2DE2C6F-E071-5E88-96F1-D71DDED84609.html">Generic Open Libraries</a> &gt; <a href="GUID-440FDF7D-B9A0-5767-9FF8-412803C0D2A9.html">C Standard Library</a> &gt; <a href="GUID-39FA0ECE-D403-5F02-AC5D-7BC8E1669E8E.html" title="This section explains the concepts and functionality of C Standard Library such as the CRT0 library, threads, Unicode support and so on.">C Standard Library Concepts</a> &gt; </div>
<h1 class="topictitle1">Single
and Multiple Threads</h1>
<div>
<p>This section describes the threads used in C programs. </p>

<div class="section" id="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-1EF3A0B4-E737-4BAA-8F1A-10F8BB39B5F5"><a name="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-1EF3A0B4-E737-4BAA-8F1A-10F8BB39B5F5"><!-- --></a><h2 class="sectiontitle">Threads</h2> <p>The POSIX interface is designed for a single
thread of execution within a process. Many aspects of this interface do not
apply to a typical Symbian program in which multiple threads of execution
share the same address space. For information about threads and processes,
see <a href="GUID-BBBFC0AF-2E35-5F5C-A3A5-57C4196A6CDA.html" title="These documents describe thread and process management.">Threads and processes</a>. </p>
 <p>STDLIB
allows for multiple threads, but each thread owns its own instance of the <samp class="codeph">_reent</samp> structure
which contains private data such as the thread's <samp class="codeph">errno</samp> variable.
Each thread's STDIO <samp class="codeph">FILE</samp> structures are completely separate
from other threads', even if those structures eventually share the same underlying
file descriptor. A consequence of this is that different threads will buffer
their output to <samp class="codeph">stdout</samp> separately, even though the eventual
output will be combined together when the STDIO layer flushes the buffers
out to the corresponding file descriptor. </p>
 <p>It is unclear how some POSIX
functions should be used in a multiple thread environment. An example is the <samp class="codeph">exit()</samp> function.
Although each thread should have separate <samp class="codeph">atexit()</samp> processing,
which should include closing all open STDIO files, it is unclear whether closing
the STDIO file should also close the underlying descriptor. STDLIB's current
implementation is to close the files, as would be expected to happen in a
normal POSIX process. However, this implementation may be changed. Note that <samp class="codeph">exit()</samp> does
not attempt to free memory which was obtained by <samp class="codeph">malloc()</samp>. </p>
 <p>The
user of STDLIB can take control over thread termination by implementing <samp class="codeph">exit()</samp>, <samp class="codeph">_exit()</samp>, <samp class="codeph">abort()</samp> and <samp class="codeph">_assert()</samp> in their own program, so that all of the
user's own code which calls these functions will invoke the user's routines
instead of the STDLIB versions. A helper function, <samp class="codeph">_atexit_processing_r()</samp>,
can be called from the user's version of <samp class="codeph">exit()</samp> to do the
normal <samp class="codeph">atexit</samp> processing, if desired. See <samp class="codeph">stdlib_r.h</samp> for
details. </p>
 </div>

<div class="section" id="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-3E022252-3471-41AB-BE87-2690B6DA9374"><a name="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-3E022252-3471-41AB-BE87-2690B6DA9374"><!-- --></a><h2 class="sectiontitle">Single-threaded programs</h2> <p>Simple C programs may
not need to support file descriptors shared between threads, or the execution
of sub-processes. Such programs may use the default implementation of STDLIB,
in which the library code opens files, sockets etc. in the context of the
calling thread, and provides a per-thread table of open file descriptors. </p>
 <p>Multiple
threads may still be used, but each thread's resources are private and cannot
be shared with other threads. For example, a <samp class="codeph">setenv()</samp> call
in one thread will not be seen by a <samp class="codeph">getenv()</samp> call in another
and each thread will have a separate console window (created on demand when
the console is first read from or written to). </p>
 </div>

<div class="section" id="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-19D6688E-F2B3-4AA1-89E5-7CA9FA72648B"><a name="GUID-1261F3A3-6F27-5A85-81FF-A6858F03F711__GUID-19D6688E-F2B3-4AA1-89E5-7CA9FA72648B"><!-- --></a><h2 class="sectiontitle">Multi-threaded programs; the CPosixServer</h2> <p>More
complex programs may need to use process-wide resources. This is often true
of programs which assume the existence of support for multiple threads within
a POSIX process. To meet this requirement, STDLIB can operate in a mode in
which all shareable resources are owned by a single <samp class="codeph">CPosixServer</samp> thread.
In this mode, library routines such as <samp class="codeph">open()</samp>, <samp class="codeph">read()</samp> and <samp class="codeph">write()</samp> operate
by passing an appropriate request to the <samp class="codeph">CPosixServer</samp>. </p>
 <p>The
program's mode of operation is determined when it first tries to use STDLIB's
services. If a <samp class="codeph">CPosixServer</samp> is running for the Symbian platform
process, the thread will use it; otherwise the program will operate in the
single-threaded mode. </p>
 <p>The <samp class="codeph">CPosixServer</samp> is a Symbian
platform active object, and can be started either in the context of an existing
active scheduler, or by spawning a separate thread to run an active scheduler.
The functions for doing this have a C++ interface, defined in <samp class="codeph">estlib.h</samp>.
For more information on active objects, see <a href="GUID-890F06C6-DE32-5EB1-BF0F-D41794F47AE1.html" title="This document describes the functionality and class membership of active objects.">active
objects</a>. </p>
 <p>Communication between <samp class="codeph">CPosixServer</samp> s
is used to establish the POSIX process hierarchy and to communicate resources
from parent to child. Programs which require multiple processes must use the
multi-threaded mode of operation. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-39FA0ECE-D403-5F02-AC5D-7BC8E1669E8E.html" title="This section explains the concepts and functionality of C Standard Library such as the CRT0 library, threads, Unicode support and so on.">C Standard Library Concepts</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-BBBFC0AF-2E35-5F5C-A3A5-57C4196A6CDA.html" title="These documents describe thread and process management.">Threads and
                processes</a></div>
<div><a href="GUID-890F06C6-DE32-5EB1-BF0F-D41794F47AE1.html" title="This document describes the functionality and class membership of active objects.">Active  
              objects</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>