<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Enabling MTP over USB using the Symbian USB Manager"/>
<meta name="abstract" content="This section describes the steps to enable MTP over USB using the Symbian USB Manager."/>
<meta name="description" content="This section describes the steps to enable MTP over USB using the Symbian USB Manager."/>
<meta name="DC.Relation" scheme="URI" content="GUID-9EC375CD-A021-5DD0-93A9-748AC80356EE.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B9709F2F-C53A-5455-B19E-23B9B40101B4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C527EE7-140B-5E52-95FD-DAB1890B7E6D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F574AEA9-88AE-55B4-8CF4-CBD7AF402A1A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9EC375CD-A021-5DD0-93A9-748AC80356EE.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Enabling MTP over USB using the Symbian USB Manager</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51"><a name="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2534806 id2535110 id2535170 id2535185 id2535199 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html">Remote Connectivity Guide</a> &gt; <a href="GUID-B9709F2F-C53A-5455-B19E-23B9B40101B4.html">MTP Transports</a> &gt; <a href="GUID-7C527EE7-140B-5E52-95FD-DAB1890B7E6D.html" title="This section describes the MTP USB transport components and how to enable MTP over USB.">MTP USB Transport</a> &gt; <a href="GUID-F574AEA9-88AE-55B4-8CF4-CBD7AF402A1A.html">Enabling MTP over USB Tutorials</a> &gt; <a href="GUID-9EC375CD-A021-5DD0-93A9-748AC80356EE.html" title="This section describes two ways to enable MTP over USB, using the USB Manager and writing an MTP client application.">Enabling MTP over USB</a> &gt; </div>
<h1 class="topictitle1">Enabling
MTP over USB using the Symbian USB Manager</h1>
<div><p>This section describes the steps to enable MTP over USB using the
Symbian USB Manager.</p>

<div class="section">       <p>The USB Manager provides functions to enable MTP over USB.</p>
 
   </div>

<a name="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-12E76F69-4DA0-4F58-8B02-68180F2576ED"><!-- --></a><ol id="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-12E76F69-4DA0-4F58-8B02-68180F2576ED"><li class="stepexpand" id="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-B66CE19F-A6A0-46BD-AE1F-D93B773858D6"><a name="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-B66CE19F-A6A0-46BD-AE1F-D93B773858D6"><!-- --></a><span>In the user application which requests USB services, create a USB
Manager session by using the RUsb::Connect() function.</span>
 <p/>

</li>
<li class="stepexpand" id="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-6B178935-1C5F-496F-8EF2-10CCE25C1C61"><a name="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-6B178935-1C5F-496F-8EF2-10CCE25C1C61"><!-- --></a><span>Call the function RUsb::TryStart() and pass the personality ID
of the USB Still Image Class to the method. For more information about Personality
ID, see <a href="GUID-92976123-FA75-5B55-B86E-F7B404E762CF.html">Discovering
details of USB personalities</a></span>
</li>
<li class="stepexpand" id="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-B013CA86-3A98-445E-AC7A-D6DA31DD73B0"><a name="GUID-FD4BD57B-99EE-41AE-BAB6-C422CA3B1E51__GUID-B013CA86-3A98-445E-AC7A-D6DA31DD73B0"><!-- --></a><span>The USB Manager automatically loads the USB Still Image Class Controller
which is a client of the MTP server. The Controller starts the MTP server
and asks it to load the USB MTP Transport plug-in.</span>
</li>
</ol>

<div class="example"><pre class="codeblock">RUsb usb;
TInt err = usb.Connect();
if( err != KErrNone)
   {
    // Error in connecting with the USB Manager
   }

// Find the personality that supports MTP USB SIC 
TInt personalityId(KErrNotFound);
RArray&lt;TInt&gt; personalityIds;

err = usb.GetPersonalityIds(personalityIds);
if ( err != KErrNone)
   {
   // Error handling
   }
        
TInt count = personalityIds.Count();    
for (TInt i(0); i &lt; count; i++)
   {
   TBool supported(EFalse);
   err = usb.ClassSupported(personalityIds[i], KUsbMTPUsbSicClassControllerUID, supported);
   if (err != KErrNone)
      {
      // Error handling
      }

   if (supported)
      {
      personalityId = personalityIds[i];    
      break;
      }
   }
personalityIds.Close();

if (personalityId != KErrNotFound)
   {
   TRequestStatus status ;
   usb.TryStart(personalityId, status);
   User::WaitForRequest(status);
   if(status.Int() != KErrNone)
      {
       // Error in trying to start the MTP service
      }
    }
...

usb.Close();
</pre>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-9EC375CD-A021-5DD0-93A9-748AC80356EE.html" title="This section describes two ways to enable MTP over USB, using the USB Manager and writing an MTP client application.">Enabling MTP over USB</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>