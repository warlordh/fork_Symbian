<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Surfaces"/>
<meta name="abstract" content="This topic provides an introduction to graphics composition surfaces, which are usually simply called surfaces. Surfaces are pixel buffers that have associated metadata describing the width, height, stride and pixel format and are used as input to the composition components. Surfaces can be multi-buffered and are identified by a 128-bit identifier (called the surface ID)."/>
<meta name="description" content="This topic provides an introduction to graphics composition surfaces, which are usually simply called surfaces. Surfaces are pixel buffers that have associated metadata describing the width, height, stride and pixel format and are used as input to the composition components. Surfaces can be multi-buffered and are identified by a 128-bit identifier (called the surface ID)."/>
<meta name="DC.Relation" scheme="URI" content="GUID-783086B9-D6FE-539C-90F1-D745253A640D.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-63CB6C7E-44EC-5D0B-A37D-FE78F7D76592.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-783086B9-D6FE-539C-90F1-D745253A640D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DC3E5AA-1706-5255-ACD6-E7AB732E1095.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-55EF3CEB-AF3E-5A32-96F3-F146D1A06C8F.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E238B1FE-BBD8-5C6D-AE04-258188EFF9FF.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Surfaces</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2384330 id2387228 id2387242 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html">Graphics Guide</a> &gt; <a href="GUID-63CB6C7E-44EC-5D0B-A37D-FE78F7D76592.html" title="The Graphics Composition collection is a key part of ScreenPlay. The collection is made up of components that are concerned with composition. This is the process of putting together the output elements from various different sources to create the display that the viewer sees on the screen.">Graphics Composition Collection</a> &gt; <a href="GUID-783086B9-D6FE-539C-90F1-D745253A640D.html" title="This section covers some important graphics composition topics, such as scene elements (sometimes known as layers) and surfaces.">Graphics Composition Concepts</a> &gt; </div>
<h1 class="topictitle1">Surfaces</h1>
<div><p>This topic provides an introduction to <strong>graphics composition surfaces</strong>, which are usually simply called <strong>surfaces</strong>. Surfaces are pixel buffers that have associated metadata describing the width, height, stride and pixel format and are used as input to the composition components. Surfaces can be multi-buffered and are identified by a 128-bit identifier (called the surface ID). </p>
<p> <strong>Variant</strong>: <a href="GUID-D93978BE-11A3-5CE3-B110-1DEAA5AD566C.html" title="This topic provides an introduction to ScreenPlay and its architecture. ScreenPlay is a new graphics architecture, introduced in Symbian^3 (S^3). ScreenPlay enables device creators to take advantage of improved software performance, hardware acceleration and third party graphics engines. ScreenPlay is sometimes known as the New Graphics Architecture (NGA).">ScreenPlay</a>. <strong>Target audience</strong>: Device creators. </p>
 <p>Surfaces that are used as input to the composition engine are shared between at least two processes: the Window Server process (in which the composition engine runs) and a <strong>renderer</strong>, which is responsible for rendering the content to the surface. The camera viewfinder, the video renderer and EGL are examples of renderers. Each process needs to access the surface to read or write (draw) data. Other processes may also need one or both types of access. Each of these processes uses the surface ID to gain access to the surface or its properties. </p>
 <p>The <a href="GUID-8E8FE99A-5F4D-5B0F-87AB-A58EB4BEB6E9.html" title="Each graphics composition surface has at least two interested stakeholders: the process responsible for drawing and maintaining the content and the composition engine, which uses the surface for creating the display. When one of the stakeholders does something to the surface, it usually means that another stakeholder needs to do something too. The Surface Update component provides a channel for the stakeholders to inform each other of changes.">Surface Update component</a> provides a two-way communication channel between the composition engine and the renderers. This allows a renderer to notify the composition engine when the content of a buffer within the surface has been updated and a scene composition is required. Similarly, the Surface Update Server allows the composition engine to notify the renderer of the composition status. </p>
 <div class="section" id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-AD75C13E-389E-5A06-83D7-A49079B5052B"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-AD75C13E-389E-5A06-83D7-A49079B5052B"><!-- --></a><h2 class="sectiontitle"> The surface ID </h2> <p>The surface ID is a 128-bit number used to identify a surface. It is represented by the <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">TSurfaceId</span></a> class which comprises four 32-bit integers. One byte is used to store a number representing the <strong>surface type</strong>. Symbian defines the following surface types: </p>
 <ul><li id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-83FAB870-74E2-535E-9D2D-A40E90FF69BB"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-83FAB870-74E2-535E-9D2D-A40E90FF69BB"><!-- --></a><p>An invalid surface (<samp class="codeph">EInvalidSurface</samp>, type 0), </p>
 </li>
 <li id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-887582F5-D235-5B2F-930C-C706A2FE4186"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-887582F5-D235-5B2F-930C-C706A2FE4186"><!-- --></a><p>A screen surface (<samp class="codeph">EScreenSurface</samp>, type 1) </p>
 </li>
 <li id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-9ED41171-5EBF-5103-A198-1E9BBB9D69F6"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-9ED41171-5EBF-5103-A198-1E9BBB9D69F6"><!-- --></a><p>A Surface Manager surface (<samp class="codeph">ESurfaceManagerSurface</samp>, type 33). </p>
 </li>
 </ul>
 <p>In addition types 34 to 255 are available for device creators to define their own types of rendered surfaces. Screen surface types are enumerated in <span class="filepath">Surface.h</span>. Rendered surface types are enumerated in <span class="filepath">SurfaceTypes.h</span>. </p>
 <p>The other 120 bits uniquely identify the surface and are used according to the surface type. Surface Manager IDs are generated automatically by the <a href="GUID-55EF3CEB-AF3E-5A32-96F3-F146D1A06C8F.html" title="The Surface Manager is responsible for creating graphics composition surfaces (called surfaces) in system memory and controlling access to them.">Surface Manager</a> when new surfaces are created. The reference implementation generates them randomly in order to minimize the possibility of the IDs being guessed. </p>
 </div>
 <div class="section" id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-67176ED3-D91F-5FDB-9D6A-F32DD7403F75"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-67176ED3-D91F-5FDB-9D6A-F32DD7403F75"><!-- --></a><h2 class="sectiontitle"> A typical life cycle </h2> <p><strong>Creating a surface </strong> </p>
 <p>Surfaces can be created by using the Surface Manager API. To do this, you first create an instance of the client-side class <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">RSurfaceManager</span></a>. This encapsulates the complexities of device driver communication, memory management and thread safety. To create a surface, you must specify the number of buffers and low-level properties, such as pixel format, stride and memory contiguity. See <a href="GUID-E238B1FE-BBD8-5C6D-AE04-258188EFF9FF.html" title="This tutorial first shows you how to create a composition surface using the Surface Manager API. It then shows you how to create second surface that shares the same memory.">Creating a Graphics Surface Tutorial</a> for more information. </p>
 <p><strong>Binding the surface to a window </strong> </p>
 <p>You bind a surface to a window by calling <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">RWindowBase::SetBackgroundSurface()</span></a>. You can apply a number of <strong>configuration</strong> settings to the surface, such as viewport, rotation and extent. These crop, scale and rotate the surface content. If the configuration is not set, the entire surface is mapped to the window extent with normal orientation. See <a href="GUID-495EA1C8-E95F-54AE-B4D1-0F463003C2D7.html" title="This topic provides an introduction to displaying an external surface on a window. The surface is then known as a background surface. This feature is available in ScreenPlay only.">External Surfaces Overview</a> for more information. </p>
 <p><strong>Rendering content to the surface and composition </strong> </p>
 <p>The renderer renders the graphics content directly to a buffer within the surface. The renderer then sends a request to the composition engine through the <a href="GUID-8E8FE99A-5F4D-5B0F-87AB-A58EB4BEB6E9.html" title="Each graphics composition surface has at least two interested stakeholders: the process responsible for drawing and maintaining the content and the composition engine, which uses the surface for creating the display. When one of the stakeholders does something to the surface, it usually means that another stakeholder needs to do something too. The Surface Update component provides a channel for the stakeholders to inform each other of changes.">Surface Update component</a> to indicate that the surface is ready for composition. The renderer specifies the surface ID, the ID of the current buffer within the surface and optionally the dirty rectangle and the screen on which the surface is to be displayed. Alternatively the request can be broadcast to all screens (this is called a <a href="GUID-D2ECF215-B53C-5659-BA86-5B658C0C2D2F.html" title="Global surface updates are surface composition update commands that are submitted to all displays rather than to a single one. This causes the Surface Update Server to broadcast the update to all of the registered composition engine instances. Each of these then determines whether the surface is displayed on its associated screen and if so, forces an update.">global surface update</a>). </p>
 <p>The composition engine then includes the surface in the next composition cycle. Because this can take some time, the composition engine carries out the composition asynchronously. The composition engine can notify the client when the buffer is available for rendering into again, in order to prevent tearing or artefacts. The composition engine can also notify the client when the buffer has been displayed a specified number of times, in order to ensure that each frame gets displayed for at least a given period of time. For more information, see <a href="GUID-8E8FE99A-5F4D-5B0F-87AB-A58EB4BEB6E9.html" title="Each graphics composition surface has at least two interested stakeholders: the process responsible for drawing and maintaining the content and the composition engine, which uses the surface for creating the display. When one of the stakeholders does something to the surface, it usually means that another stakeholder needs to do something too. The Surface Update component provides a channel for the stakeholders to inform each other of changes.">Surface Update Component Overview</a>. </p>
 <p> <em>Note</em>: In graphics, the term <strong>artefact</strong> is used to refer to an error that occurs when displaying or drawing an image on the screen. <strong>Tearing</strong> is a particular type of error in which part of the current frame and part of the previous frame are seen on the screen at the same time. This makes the image appear torn. Tearing is considered a serious error. </p>
 <p><strong>Removing the surface from window </strong> </p>
 <p>You remove a surface from a window by calling <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">RWindowBase::RemoveBackgroundSurface()</span></a>. This removes the surface and redraws the window. </p>
 <p><strong>Registering the surface for use on a screen </strong> </p>
 <p>You can optionally register a surface as a separate step before adding it as a background to a window. This enables the client to send a surface update to set up the first buffer that will be displayed when the surface is attached to a window. You register a surface by using <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">RWsSession::RegisterSurface()</span></a>. </p>
 <p>A given surface can be registered in multiple sessions and on multiple screens. However, you must not call <samp class="codeph">RWsSession::RegisterSurface()</samp> more than once per session for a given combination of surface and screen, without explicitly unregistering the surface first. </p>
 <p>Explicitly registered surfaces can be unregistered in two ways: </p>
 <ul><li id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-66C7BAC5-5973-5630-BC36-71B2D8A39CCE"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-66C7BAC5-5973-5630-BC36-71B2D8A39CCE"><!-- --></a><p>A call to <a href="GUID-733B8BFA-7BC2-3A6D-A66F-F788413D25A9.html"><span class="apiname">RWsSession::UnregisterSurface()</span></a>. </p>
 </li>
 <li id="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-4280F80D-E226-5AD5-BE3A-74802C6ABA5F"><a name="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13__GUID-4280F80D-E226-5AD5-BE3A-74802C6ABA5F"><!-- --></a><p>Closing the session. </p>
 </li>
 </ul>
 <p>When the session is closed, all of the surfaces explicitly registered with that session are unregistered. Closing a session also closes any windows associated with that session. Any surfaces directly assigned to those windows are also unregistered. </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-783086B9-D6FE-539C-90F1-D745253A640D.html" title="This section covers some important graphics composition topics, such as scene elements (sometimes known as layers) and surfaces.">Graphics Composition Concepts</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-0DC3E5AA-1706-5255-ACD6-E7AB732E1095.html" title="This topic provides an introduction to the Graphics Composition collection.">Graphics Composition Collection Overview</a></div>
<div><a href="GUID-55EF3CEB-AF3E-5A32-96F3-F146D1A06C8F.html" title="The Surface Manager is responsible for creating graphics composition surfaces (called surfaces) in system memory and controlling access to them.">Surface Manager Overview</a></div>
<div><a href="GUID-E238B1FE-BBD8-5C6D-AE04-258188EFF9FF.html" title="This tutorial first shows you how to create a composition surface using the Surface Manager API. It then shows you how to create second surface that shares the same memory.">Creating a Graphics
                Surface Tutorial</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>