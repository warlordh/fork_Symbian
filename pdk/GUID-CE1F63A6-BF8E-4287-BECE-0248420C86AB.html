<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="mtpexampledp: MTP Data Provider Example"/>
<meta name="abstract" content="This example demonstrates how an MTP data provider plug-in can be created ."/>
<meta name="description" content="This example demonstrates how an MTP data provider plug-in can be created ."/>
<meta name="DC.Relation" scheme="URI" content="GUID-EBFEC84C-08D1-5710-B0DA-55BE2AB9A84F.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-EBFEC84C-08D1-5710-B0DA-55BE2AB9A84F.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>mtpexampledp: MTP Data Provider Example</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2534806 id2535042 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html">Remote Connectivity Guide</a> &gt; <a href="GUID-EBFEC84C-08D1-5710-B0DA-55BE2AB9A84F.html">MTP Data Providers</a> &gt; </div>
<h1 class="topictitle1">mtpexampledp: MTP Data Provider Example</h1>
<div><p>This example demonstrates how an MTP data provider plug-in
can be created .</p>

<div class="section" id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-A6DEF7A0-ED6E-4950-B614-5F19B56FD681"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-A6DEF7A0-ED6E-4950-B614-5F19B56FD681"><!-- --></a><h2 class="sectiontitle">Purpose</h2><p> </p>
<div class="p">The example shows the following use cases:<ol>
<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-B5E11A63-4A93-49AA-A83A-149C0ABDA31E"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-B5E11A63-4A93-49AA-A83A-149C0ABDA31E"><!-- --></a><p>How to create
a data provider plug-in class.</p>
</li>

<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-A4F2C91D-3EA1-46A0-A9A5-79BA1D64DA3F"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-A4F2C91D-3EA1-46A0-A9A5-79BA1D64DA3F"><!-- --></a><p>How to register
it with the ECOM plug-in framework.</p>
</li>

<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-3C709BD4-F4DC-4033-91C2-DD122141CDFB"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-3C709BD4-F4DC-4033-91C2-DD122141CDFB"><!-- --></a><p>How to create
an MTP framework data provider configuration file.</p>
</li>

<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-F2AA7515-53D6-4464-AA77-532F88E0D287"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-F2AA7515-53D6-4464-AA77-532F88E0D287"><!-- --></a><p>How to register
an MTP data provider with the MTP Framework at the time of activation.</p>
</li>

<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-15C182A0-5996-431F-8D76-F7940D7DB8D9"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-15C182A0-5996-431F-8D76-F7940D7DB8D9"><!-- --></a><p>How to load
vendor defined operations and support them with the data provider.</p>
</li>

<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-D72C0EB3-BF09-4790-B2E7-408D5D53A86A"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-D72C0EB3-BF09-4790-B2E7-408D5D53A86A"><!-- --></a><p>How to process
transactions.</p>
</li>

</ol>
</div>
<p> </p>
<p>The example delivers the following project: </p>
<p><span class="filepath">mtpdataproviderexample</span>: The example data
provider plug-in.</p>
<p> </p>
</div>

<div class="section" id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-6539B4B0-1A5E-4F08-A69C-810DABB85010"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-6539B4B0-1A5E-4F08-A69C-810DABB85010"><!-- --></a><h2 class="sectiontitle">Description</h2><p><strong>1. Creating a data provider plug-in class:</strong> A data provider
plug-in class is created by defining a <a href="GUID-53D6BD66-D8D3-3202-BD80-95D5CE6FAF4D.html"><span class="apiname">CMTPExampleDataProvider</span></a> class that derives from the<a href="GUID-710B9980-7EF5-3E20-954B-795241D1D479.html"><span class="apiname"> CMTPDataProviderPlugin</span></a> class. The <a href="GUID-53D6BD66-D8D3-3202-BD80-95D5CE6FAF4D.html"><span class="apiname">CMTPExampleDataProvider</span></a> class represents
a unique data provider that is being created. The example class implements
all of the pure virtual<a href="GUID-706C058C-6562-33F6-A923-4AD31C6233E3.html"><span class="apiname">MMTPDataProvider</span></a> SPI methods.</p>
<p> </p>
<div class="p"><strong>2. Registering a data provider plug-in with the ECOM
plug-in framework: </strong><ul>
<li><p>The example data provider registers itself with the ECOM plug-in
framework by creating and exporting a standard ECOM plug-in framework
registration file. The <span class="filepath">mtpexampledp.rss</span> file
is the required registration file for the example data provider.</p>
</li>

<li><p>In addition to the registration file the example data provider
plug-in DLL exports an ECOM implementation proxy table that links
the <a href="GUID-5EB8A621-CFF8-3F53-8697-E124629A2348.html"><span class="apiname">implementation_uid</span></a> defined in the <span class="filepath">mtpexampledp.rss</span> file with <a href="GUID-53D6BD66-D8D3-3202-BD80-95D5CE6FAF4D.html#GUID-53D6BD66-D8D3-3202-BD80-95D5CE6FAF4D__GUID-62AE2202-C6F5-34F4-8728-8F6F25A8D2CE"><span class="apiname">CMTPExampleDataProvider::NewL()</span></a> function, which is used for loading the example.</p>
</li>

</ul>
</div>
<p> </p>
<p><strong>3. Creating an MTP framework data provider
configuration file:</strong> Along with the ECOM registration file, the
example data provider has a separate data provider configuration file,
which provides information on the operational modes supported by the
data provider. The file containing this information is <span class="filepath">mtpdataproviderpluginexample_config.rss</span>. The example data provider supports <a href="GUID-C92AB231-32C4-3F52-BD0F-151C0DAA9ACA.html"><span class="apiname">KMTPModeMTP</span></a>, which specifies it as having an MTP operational mode.</p>
<p> </p>
<p><strong>4. Registering an MTP data provider with the MTP Framework
at the time of activation:</strong> For registration, the example data
provider supplies information on the various operations it supports
and defines them in the implementation of the <a href="GUID-7EB1EA3B-5EF2-338C-A3D1-3F865028E83E.html"><span class="apiname">Supported()</span></a> function. The example supports two operations, <a href="GUID-83F80D52-63E5-3F0E-8CA4-D88BB13C826A.html"><span class="apiname">EMTPOpVendorDefined1</span></a> and <a href="GUID-7C0EF26F-BCEE-3DE7-AF51-3036F4A89E21.html"><span class="apiname">EMTPOpVendorDefined2</span></a>, defined in<span class="filepath"> cmtpexampledpconst.h</span>. Any vendor extension information
for the example data provider is defined by implementing the<a href="GUID-E865785A-3908-3620-A0F8-B6216C2A59F5.html"><span class="apiname">SupportedL() </span></a>function. The example data provider does not
support objects, hence there is no object and store enumeration. </p>
<p> </p>
<p><strong>5. Using vendor defined operations:</strong> The operations
supported specify the functionality of the data provider. The example
data provider supports <a href="GUID-83F80D52-63E5-3F0E-8CA4-D88BB13C826A.html"><span class="apiname">EMTPOpVendorDefined1</span></a> and <a href="GUID-7C0EF26F-BCEE-3DE7-AF51-3036F4A89E21.html"><span class="apiname">EMTPOpVendorDefined2</span></a> operations. These are dummy operations
that send an <a href="GUID-099793F2-3DD4-3530-B981-D9BE32C3A63E.html"><span class="apiname">EMTPRespCodeOK</span></a> response as and when
invoked. These dummy operations are implemented using the <a href="GUID-C45F88CC-C229-3A06-B8EF-A854CB03F5A6.html"><span class="apiname">CMTPExampleDpVendorDefinedOp1 </span></a>and <a href="GUID-318575F3-32D3-39F6-8E39-78805DE695F4.html"><span class="apiname">CMTPExampleDpVendorDefinedOp2</span></a> classes. Both these classes are derived from the <samp class="codeph">CMTPExampleDpRequestProcessor</samp> class, which encapsulates differing operation handling. For handling
any unexpected operation sent by the PC, the <a href="GUID-3108685A-D20C-3F58-814B-0F0AE5279B07.html"><span class="apiname">CMTPRequestUnknown</span></a> class has been defined.</p>
<p>The example data provider implements
the <span class="filepath">mtpexamplerequestprocessor.cpp</span> file, which
is designed to dispatch the operations to a concrete request processor.</p>
<p> </p>
<p><strong>6. Transaction processing: </strong>The Responder to Initiator
data phase is implemented where the Responder will send object data
to the Initiator.  Here, the example data provider plug-in is the
responder and the PC acts as an initiator. </p>
<p>An incoming request
can be processed using the <a href="GUID-C5666D10-954A-315D-AAEF-ACBE79E04D88.html"><span class="apiname">HandleRequestL() </span></a>function
. Once the request is handled, <a href="GUID-57A64BE5-04A6-308A-B20F-088FD8DF1979.html"><span class="apiname">CompleteRequestL()</span></a> is called to signal the framework about the completion of the request
transaction.</p>
 </div>

<div class="section" id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-FD878DE5-3565-46BF-BE26-5AA8296DEEA8"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-FD878DE5-3565-46BF-BE26-5AA8296DEEA8"><!-- --></a><h2 class="sectiontitle">Download</h2><p>Click on the following link to download the example:  <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/zips/guid-c759da23-1dae-4854-b5a1-1e58d2125594 .zip" target="_blank">MtpDataProvider.zip</a>.</p>
<p>Click  <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/guid-c759da23-1dae-4854-b5a1-1e58d2125594.html">browse</a> to view the example code.</p>
</div>

<div class="section" id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-F0AB5245-1934-4F8F-84C3-2806C20DF096"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-F0AB5245-1934-4F8F-84C3-2806C20DF096"><!-- --></a><h2 class="sectiontitle">Building and configuring</h2><p> </p>
<p>You can build the example from
your IDE or the command line: </p>
 <ul>
<li id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-0D86ECCB-1501-52D9-A52E-A016AB6710A2-GENID-1-12-1-28-1-1-6-1-4-1-3-4-4-1"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-0D86ECCB-1501-52D9-A52E-A016AB6710A2-GENID-1-12-1-28-1-1-6-1-4-1-3-4-4-1"><!-- --></a><p> </p>
<p>If you
use an IDE, import the <span class="filepath">bld.inf</span> file of the example
into your IDE, and use the build command of the IDE. </p>
</li>

<li> <p>If you use the command line, open a command prompt, and set
the current directory to the source code directory of the example.
You can then build the example with the SBSv1 build tools using the
following commands: </p>
<ul>
<li><p><span class="cmdname">bldmake bldfiles</span></p>
</li>

<li><p><span class="cmdname">abld build</span></p>
</li>

</ul>
 </li>

</ul>
 <div class="p"> The example builds the following DLL:<ul>
<li><p><span class="filepath">mtpexampledp.dll</span> : example data provider
plug-in. </p>
</li>

</ul>
</div>
<p> in the <span class="filepath">epoc32\release\winscw\&lt;udeb or urel&gt;\</span> folder. </p>
<p> </p>
</div>

<div class="section" id="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-9E4754AA-2B3F-421B-A213-0F1EA35C07F5"><a name="GUID-CE1F63A6-BF8E-4287-BECE-0248420C86AB__GUID-9E4754AA-2B3F-421B-A213-0F1EA35C07F5"><!-- --></a><h2 class="sectiontitle">Running
the example</h2><p>For testing the data provider plug-in functionality
the DLL needs to be integrated into the MTP Framework.</p>
<p>For information
on installing a data provider please refer to these topics:</p>
<p><a href="GUID-DB82D140-AB1B-5AA9-89CB-A5F68F328C85.html">Data provider
built in ROM</a>.</p>
<p><a href="GUID-DB82D140-AB1B-5AA9-89CB-A5F68F328C85.html">Data provider installed
via SIS file</a>.</p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-EBFEC84C-08D1-5710-B0DA-55BE2AB9A84F.html">MTP Data Providers</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>