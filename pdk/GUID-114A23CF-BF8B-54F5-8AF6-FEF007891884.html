<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="SD Controller"/>
<meta name="abstract" content="Describes the Secure Digital (SD) controller supported on the Symbian platform."/>
<meta name="description" content="Describes the Secure Digital (SD) controller supported on the Symbian platform."/>
<meta name="DC.Relation" scheme="URI" content="GUID-F15DBB8B-A79D-5C3B-BE07-F0356936A2DC.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CFD2236E-7775-5532-89CD-7D0E1E219FD8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2F114BC9-9B5D-5989-9CF3-37A43377DC58.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F15DBB8B-A79D-5C3B-BE07-F0356936A2DC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0E5A241A-19F5-5754-B454-45747A8D80E1.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E194A923-99E7-5DC1-BB78-D050A4793A60.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>SD Controller</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2400576 id2400607 id2400744 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-CFD2236E-7775-5532-89CD-7D0E1E219FD8.html" title="Provides an overview of generic driver support.">Generic Driver Support</a> &gt; <a href="GUID-2F114BC9-9B5D-5989-9CF3-37A43377DC58.html" title="Provides the physical device drivers, called media drivers, and associated libraries that manage storage media hardware.">Media Drivers</a> &gt; <a href="GUID-F15DBB8B-A79D-5C3B-BE07-F0356936A2DC.html" title="Describes the Secure Digital (SD) Controller to support SD cards on the Symbian platform.">SD Controller</a> &gt; </div>
<h1 class="topictitle1">SD Controller </h1>
<div><p>Describes the Secure Digital (SD) controller supported on the Symbian
platform. </p>

<p>The SD controller provided by the Symbian platform is based on the <a href="http://www.sdcard.org/developers/tech/sdcard/pls/Simplified_Physical_Layer_Spec.pdf" target="_blank">Physical Layer Simplified Specification Version 2.00</a> from
the SD Card Association. </p>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-8A734E8C-CB18-48C8-9C8F-71AA6693B782"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-8A734E8C-CB18-48C8-9C8F-71AA6693B782"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>The
Secure Digital (SD) card protocol is implemented as a superâ€“set of multimedia
cards on the Symbian platform. The Multi Media Card (MMC) controller also
supports the SD cards. The SD card controller functionality is very similar
to the MMC controller and hence the SD card controller is provided by a set
of SD card classes which are derived from the MMC controller classes. </p>
 </div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D41588EF-12DA-5E50-8FF4-FCE13CA81409"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D41588EF-12DA-5E50-8FF4-FCE13CA81409"><!-- --></a><h2 class="sectiontitle">SD Card</h2> <p>The
SD cards are flash based memory cards used in high capacity data storage in
handheld devices like digital cameras, mobile phones and PDAs. The SD cards
contain 9 pins and support a 4-bit data bus. SD cards are forward compatible
with MMC and hence a device with SD card support will also support MMC cards.
SD cards use star topology with dedicated command and data signals. </p>
 <p>There
are two versions of SD cards: the standard capacity SD card which has a memory
capacity of up to 2GB; and high capacity SD cards which have a maximum memory
capacity of up to 32GB. The SD card functionality is provided by a layered
architecture. The 3 layers are: </p>
 <ul>
<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-86ED75DF-68C4-5D0A-B11F-C9B52CEEC6ED"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-86ED75DF-68C4-5D0A-B11F-C9B52CEEC6ED"><!-- --></a><p>File System Layer provides
high level file operations </p>
 </li>

<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-3741FA6C-6324-59CB-B460-5BF38C87C260"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-3741FA6C-6324-59CB-B460-5BF38C87C260"><!-- --></a><p>Media Driver layer provides
an interface to the file system and enables low level file operations like
read and write to a storage area </p>
 </li>

<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-2F9CA759-FCE0-57FB-B7C4-5B93D94CAEF3"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-2F9CA759-FCE0-57FB-B7C4-5B93D94CAEF3"><!-- --></a><p>SD controller provides
the low level data operations </p>
 </li>

</ul>
 <p>The SD card stack is responsible for sending the command sequences
to enable the communication between the SD card and file system of the Symbian
platform. </p>
 </div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D53D0828-5579-4A4B-A611-395A3CBB34E4"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D53D0828-5579-4A4B-A611-395A3CBB34E4"><!-- --></a><h2 class="sectiontitle">SD Card Controller</h2> <p>The <a href="GUID-F3BD37EC-0CCB-5859-908F-215E22C9FC20.html" title="The File Server component manages all files on a Symbian platform phone. This section describes how to extend the File Server for your phone hardware.">File Server</a> uses the <a href="GUID-2F114BC9-9B5D-5989-9CF3-37A43377DC58.html" title="Provides the physical device drivers, called media drivers, and associated libraries that manage storage media hardware.">Media Driver</a> to access
user data from the SD cards. The Multi Media Card (MMC) Media Driver supports
the SD cards on the Symbian platform. The MMC media drivers are implemented
in <span class="filepath">MEDMMC.PDD</span>. The Media Driver uses the services of
the SD controller. The SD controller is implemented as a peripheral bus controller
in <span class="filepath">EPBUSSD.DLL </span> to support SD cards. The difference between
the MMC controller and the SD controller is the default partition information
and the initialization sequence used. The main functions of an SD controller
are : </p>
 <ul>
<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-9F6B9620-8F40-532E-88AD-DEDDC1BD1A03"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-9F6B9620-8F40-532E-88AD-DEDDC1BD1A03"><!-- --></a><p>Support the SD memory
card initialization protocol. </p>
 </li>

<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-EAD5FB6D-8DBB-53E2-A895-13539C73F002"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-EAD5FB6D-8DBB-53E2-A895-13539C73F002"><!-- --></a><p>Reading and writing
one or more blocks from/to an SD memory card. </p>
 </li>

<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-022E3749-1739-58ED-B875-343B7048E4BA"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-022E3749-1739-58ED-B875-343B7048E4BA"><!-- --></a><p>Support for 4-bit wide
data bus option </p>
 </li>

<li id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D30CAD38-3897-5899-8761-A1DEB3DBDB92"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-D30CAD38-3897-5899-8761-A1DEB3DBDB92"><!-- --></a><p>Support for Erase commands
on SD cards </p>
 </li>

</ul>
 <p>The SD controller first detects the card present in the card port.
There can be more than one card port available in a device. When more than
one card is present, the controller switches between the ports to identify
them. When it detects an SD card, the SD card initialization protocol is loaded.
The initialization protocol is a sequence of commands as described in the <a href="http://www.sdcard.org/developers/tech/sdcard/pls/Simplified_Physical_Layer_Spec.pdf" target="_blank">SD Association</a> specification. </p>
 </div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-0EA05AC0-557D-573F-B907-41752445DC60"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-0EA05AC0-557D-573F-B907-41752445DC60"><!-- --></a><h2 class="sectiontitle">SD controller
classes</h2> <div class="fignone" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-F044A820-5E7E-5A99-83D5-7CA47EBABBC8"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-F044A820-5E7E-5A99-83D5-7CA47EBABBC8"><!-- --></a><span class="figcap">Figure 1.               SD controller classes            </span>

<img src="GUID-58A5C008-88B6-5C91-8BE5-E98CA5E5A438_d0e403824_href.png"/>
</div>
 </div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-25A29720-A91E-49FA-8E60-3060F25536EA"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-25A29720-A91E-49FA-8E60-3060F25536EA"><!-- --></a><h2 class="sectiontitle">SD Stack </h2><p>The SD controller is implemented through
a set of classes derived from the MMC controller. The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DMMCStack</span></a> maintains
a state machine and is responsible for detecting the new cards and initializing
the necessary stack. The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDStack</span></a> is
initialised when the controller detects a new SD card. The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDStack</span></a> sends
the commands to acquire the cards as described in the SD topology. <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDStack::InitialiseMemoryCardSM()</span></a> is used to
initialize the SD cards and <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDStack::ConfigureMemoryCardSM()</span></a> is
used to configure the card. </p>
</div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-23D87A40-614C-4F4D-A35E-B02216097C1A"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-23D87A40-614C-4F4D-A35E-B02216097C1A"><!-- --></a><h2 class="sectiontitle">TSDCard</h2><p>The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">TSDCard</span></a> class
provides the functions to read and write information about the card. The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">PreferredWriteGroupLength</span></a> returns the Erase Sector
size of the SD card. Clients of the SD controller should use <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DMMCStack::CardP()</span></a> to
get a pointer to the card object.<a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname"> TSDCard::IsCard()</span></a> function
is used to detect a SD card. </p>
</div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-9D9AE44F-1E6F-4D09-9B3E-76AB3BFC42F2"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-9D9AE44F-1E6F-4D09-9B3E-76AB3BFC42F2"><!-- --></a><h2 class="sectiontitle">Omissions</h2> <p>The
Symbian platform does not support SPI mode in SD cards. </p>
 </div>

<div class="section" id="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-8B7FCAA7-3A62-4CEA-917E-27CC571E6FAF"><a name="GUID-114A23CF-BF8B-54F5-8AF6-FEF007891884__GUID-8B7FCAA7-3A62-4CEA-917E-27CC571E6FAF"><!-- --></a><h2 class="sectiontitle">Session</h2><p>The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDSession</span></a> class
provides the session related functions for the SD cards. The <a href="GUID-3DC34D4F-E693-3BF0-B5D6-DF22FCE37340.html"><span class="apiname">DSDSession</span></a> class
creates the descriptors with command data. These commands are then sent to
the SD cards by the controller. </p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F15DBB8B-A79D-5C3B-BE07-F0356936A2DC.html" title="Describes the Secure Digital (SD) Controller to support SD cards on the Symbian platform.">SD Controller</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-0E5A241A-19F5-5754-B454-45747A8D80E1.html" title="Description of SD card features available to application developers and what a device creator must write to provide SD card support.">SD Card Overview</a></div>
<div><a href="GUID-E194A923-99E7-5DC1-BB78-D050A4793A60.html" title="Describes how to implement the Platform-Specific Layer (PSL) of the SD controller.">SD Controller
PSL Implementation</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>