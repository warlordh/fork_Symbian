<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Network Protocol Module API"/>
<meta name="abstract" content="This document describes the Network Protocol Module API that device creators use to develop their own Network Protocol Modules."/>
<meta name="description" content="This document describes the Network Protocol Module API that device creators use to develop their own Network Protocol Modules."/>
<meta name="DC.Relation" scheme="URI" content="GUID-8985B028-4BCD-5858-B22F-EECC52B7B9EB.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-55F5F029-6A00-5894-8892-90836DE4BA40.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-45980E0C-4DA4-5AC1-8721-490442DA7F3C.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8985B028-4BCD-5858-B22F-EECC52B7B9EB.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Network Protocol Module API</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2402946 id2402960 id2403115 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-55F5F029-6A00-5894-8892-90836DE4BA40.html" title="The Location Management collection contains components to manage location requests and to interface with a network. It also contains several common core LBS libraries that are used by many components of the LBS subsystem.">Location Management</a> &gt; <a href="GUID-45980E0C-4DA4-5AC1-8721-490442DA7F3C.html" title="Location Admin is an LBS component that contains several common LBS libraries grouped for convenience in a single system component.">Location Admin</a> &gt; <a href="GUID-8985B028-4BCD-5858-B22F-EECC52B7B9EB.html" title="The documents in this section describe the Network Protocol Module API.">Network Protocol Module API</a> &gt; </div>
<h1 class="topictitle1">Network Protocol Module API</h1>
<div><p>This document describes the Network Protocol Module API that device creators use to develop their own Network Protocol Modules. </p>
<div class="section"><h2 class="sectiontitle">Contents</h2> <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-E10D1711-CDF1-5D84-B31C-9EABA33EDA13"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-E10D1711-CDF1-5D84-B31C-9EABA33EDA13"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-0474B8C6-C136-5106-B1D7-F9C9D29C4B5C">Purpose</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-03A88FE5-E7FF-5419-A918-AB7281214B36"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-03A88FE5-E7FF-5419-A918-AB7281214B36"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-770450CB-F7A8-52CF-8567-D4C2A10C093A">Introduction</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F76EA1F7-8592-563F-8ADD-4C3D5DC73C70"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F76EA1F7-8592-563F-8ADD-4C3D5DC73C70"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-78FAF5FC-FE2E-580B-A937-EFA61834CD0E">Network Protocol Module API description</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2F039FA6-737B-5F03-891B-840DF39E0CFB"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2F039FA6-737B-5F03-891B-840DF39E0CFB"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FE060846-86FD-5E89-99CB-10E6433120F4">Using the Network Protocol Module API</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-A131C0D2-F71E-5AD2-BF16-A491408F153B"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-A131C0D2-F71E-5AD2-BF16-A491408F153B"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F4DA8C85-7F74-5FA6-BF05-1DC2636AD764">Network Protocol Module configuration</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-90F0A861-8E04-5B37-B63A-EFC88C18FFFE"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-90F0A861-8E04-5B37-B63A-EFC88C18FFFE"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CF0C5893-5871-51FA-8AA5-9889010ED031">Loading the Network Protocol Module</a>  </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-EC92600E-E7BF-57B4-9D19-14849183F414"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-EC92600E-E7BF-57B4-9D19-14849183F414"><!-- --></a><p><a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-6CCBFCC2-0948-5929-BDB8-B91E479C79F9">See also</a>  </p>
 </li>
 </ul>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-0474B8C6-C136-5106-B1D7-F9C9D29C4B5C"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-0474B8C6-C136-5106-B1D7-F9C9D29C4B5C"><!-- --></a><h2 class="sectiontitle">Purpose</h2> <p>A Network Protocol Module is an ECOM plug-in that provides network connectivity for the LBS subsystem. A Network Protocol Module typically supports one Location Based Services network protocol. Location Based Services network protocols are used by the LBS subsystem for the following purposes: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-E10F3069-67E0-5AE5-8A53-F8707C5BB027"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-E10F3069-67E0-5AE5-8A53-F8707C5BB027"><!-- --></a><p>To receive location requests from the network. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-61D90CB4-6F74-5B85-B1B3-EC246937BDBA"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-61D90CB4-6F74-5B85-B1B3-EC246937BDBA"><!-- --></a><p>To send requests for A-GPS assistance data to the network and to receive it. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-41E09C92-B6A9-5071-92F2-CE6BA23E05CA"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-41E09C92-B6A9-5071-92F2-CE6BA23E05CA"><!-- --></a><p>To send GPS-calculated positions and GPS measurements to the network and to receive calculated positions from the network. </p>
 </li>
 </ul>
 <p>Network Protocol Modules can be classified into two groups, depending on the network operator's network architecture that they are intended to interface with: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-7D75D9E5-E825-5E40-8C84-F77A16D83E98"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-7D75D9E5-E825-5E40-8C84-F77A16D83E98"><!-- --></a><p> <em>Control plane architectures</em> use the circuit-switched mobile network and signalling layer to support Location Based Services. </p>
 <p>To integrate the Symbian LBS subsystem with a control plane architecture, a Symbian licensee must implement their own control plane Network Protocol Module using the Network Protocol Module API described in this document. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-6A3526E2-8C80-56F7-912C-3A892DEBCDEE"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-6A3526E2-8C80-56F7-912C-3A892DEBCDEE"><!-- --></a><p> <em>User plane architectures</em> use IP bearers independently of the circuit-switched signalling layer. SMS or WAP Push can also be used to initiate location requests. The OMA Secure User Plane Location (SUPL) architecture describes a model for supporting IP-based Location Based Services. </p>
 <p>Symbian provides a reference <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a> that supports the OMA SUPL v1.0 standard, using the 3GPP Radio Resource LCS Protocol (RRLP) as the protocol payload. The reference SUPL Protocol Module implements the Network Protocol Module API. </p>
 </li>
 </ul>
 <p><a href="GUID-7233BC33-6060-5D6B-A5D2-01135F059337.html" title="This document describes the major components and interfaces of the Symbian platform Location Based Services (LBS) subsystem. It is intended to give device creators an appreciation of the LBS subsystem architecture. It also provides links to other documentation that provides more detailed information about the LBS components and APIs.">LBS architecture overview</a> gives more details of how a Network Protocol Module fits into the LBS subsystem. </p>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-770450CB-F7A8-52CF-8567-D4C2A10C093A"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-770450CB-F7A8-52CF-8567-D4C2A10C093A"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>A Network Protocol Module is an ECOM plug-in DLL. It communicates with the LBS Network Gateway process via the Network Protocol API and with the network via either the ETel or ESock APIs as shown in figure 1. </p>
 <div class="fignone" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-4E4828B3-2EB3-507B-A2EC-85FA3B096D34"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-4E4828B3-2EB3-507B-A2EC-85FA3B096D34"><!-- --></a><span class="figcap">Figure 1. 
             Figure 1. The Network Gateway Framework 
          </span> <img src="GUID-749B7949-8731-519E-8948-CA3E1C5D6861_d0e449588_href.png"/></div>
 <p>A Network Protocol Module has several functions: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B0D80EFC-7B08-5387-88E4-78E814CA1C33"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B0D80EFC-7B08-5387-88E4-78E814CA1C33"><!-- --></a><p>Translating method calls from the LBS subsystem into protocol specific messages which are sent over the network </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8B537CB1-B74A-5CCD-A3C4-518362A4866E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8B537CB1-B74A-5CCD-A3C4-518362A4866E"><!-- --></a><p>Translating protocol specific messages received from the network into method calls on the LBS subsystem </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-9EEB1554-CA73-5DB4-91AA-48470B808207"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-9EEB1554-CA73-5DB4-91AA-48470B808207"><!-- --></a><p>Queueing and prioritising messages received from the network and messages to be sent to the network </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1299C065-7AF9-5AB8-9ED0-EB3E8CCBC4FC"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1299C065-7AF9-5AB8-9ED0-EB3E8CCBC4FC"><!-- --></a><p>Performing conflict resolution when a request is made which conflicts with ongoing location requests being processed by the LBS subsystem </p>
 </li>
 </ul>
 <p>Licensees can configure the LBS subsystem to load a different Network Protocol Module when the mobile device is in the home network and when roaming. For example, it is possible to configure LBS to load a licensee control plane Network Protocol Module in the home network and the Symbian reference SUPL Protocol Module when roaming. See <a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CF0C5893-5871-51FA-8AA5-9889010ED031">Loading the Network Protocol Module</a> for more details. </p>
 <p>A Symbian licensee must create a Network Protocol Module to integrate the Symbian LBS subsystem with a control plane architecture. A control plane Network Protocol Module uses the ETel API and the telephony stack for network communications. Symbian does not provide a reference control plane Network Protocol Module. </p>
 <p>Symbian provides a reference Network Protocol Module that implements the SUPL v1.0 user plane architecture with RRLP as the protocol data payload. See <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a> documentation for more information about this reference module. The SUPL Protocol Module may meet the requirements of Symbian licensees and network operators and so it may not be necessary for licensees to create a custom Network Protocol Module using the API described in this document. </p>
 <p>Symbian also provide a <em>Test Network Protocol Module</em> as part of the LBS subsystem code distribution which can be found at <span class="filepath">&lt;LBS_ROOT&gt;\LbsProtocolModule</span>. The test protocol module is not a production quality module for use in a mobile device, neither is it a reference implementation. Its main purpose is to facilitate Symbian's own testing of the LBS subsystem. </p>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-78FAF5FC-FE2E-580B-A937-EFA61834CD0E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-78FAF5FC-FE2E-580B-A937-EFA61834CD0E"><!-- --></a><h2 class="sectiontitle">Network Protocol Module API description</h2> <p>This section describes the classes of the Network Protocol Module API. </p>
 <p><strong>API class diagram </strong> </p>
 <p>A Network Protocol Module and the LBS Network Gateway process communicate using the Network Protocol Module API. The API consists of classes in an observer/observable design pattern. </p>
 <p>Figure 2 shows the main classes of the Network Protocol Module API. Note that this diagram does not list all of the classes of the API and excludes numerous T classes that are used as method parameters. </p>
 <p> <strong>Note that the virtual methods of CLbsNetworkProtocolBase and CLbsNetworkProtocolBase2 are synchronous and their implementations must return quickly (for example by queueing requests and returning immediately).</strong>  </p>
 <div class="fignone" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2B79661F-CE43-5A59-B966-AA7024A5D5E1"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2B79661F-CE43-5A59-B966-AA7024A5D5E1"><!-- --></a><span class="figcap">Figure 2. 
             Figure 2. Main classes of the Network Protocol API 
          </span> <img src="GUID-A6E7C805-0515-5F3F-97DB-B5E1A84162B2_d0e449668_href.png"/></div>
 <p><strong>API classes and types </strong> </p>
 <p>Table 1 lists the main classes of the Network Protocol Module API. Further details about the classes can be found by following the links to reference documentation. </p>
 <p>The main classes are defined in <span class="filepath">lbsnetprotocolbase.h</span>. Additional API classes and types that are used as API method parameters are defined in <span class="filepath">lbsnetcommon.h</span> and <span class="filepath">lbsnetclasstypes.h</span>. </p>
 <p>The Network Protocol Module API has <samp class="codeph">publishedPartner</samp> interface access. </p>
 
<div class="tablenoborder"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-76FAD546-57EB-5046-872A-B551AA94B3E7"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-76FAD546-57EB-5046-872A-B551AA94B3E7" frame="border" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" id="d1828529e277">Class/type name</th>
 <th class="cellrowborder" valign="top" id="d1828529e280">Description</th>
 <th class="cellrowborder" valign="top" id="d1828529e283">Header file</th>
 </tr>
 </thead>
 <tbody><tr><td class="cellrowborder" valign="top" headers="d1828529e277 "><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html"><span class="apiname">CLbsNetworkProtocolBase</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e280 "><p>The original base class for Network Protocol Module implementations. This class is extended by <a href="GUID-AD071127-974A-35B4-A39F-340CDC6A1A81.html"><span class="apiname">CLbsNetworkProtocolBase2</span></a> which should be used for new Network Protocol Module implementations. </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e283 "><p> <span class="filepath">lbsnetprotocolbase.h</span>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e277 "><p> <a href="GUID-AD071127-974A-35B4-A39F-340CDC6A1A81.html"><span class="apiname">CLbsNetworkProtocolBase2</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e280 "><p>Extended base class for Network Protocol Module implementations that should be used for new Network Protocol Module implementations. </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e283 "><p> <span class="filepath">lbsnetprotocolbase.h</span>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e277 "><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html"><span class="apiname"> MLbsNetworkProtocolObserver</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e280 "><p>The observer interface implemented by the LBS Network Gateway and used by a Network Protocol Module to forward network requests and information to the LBS subsystem. It is also the interface that a protocol module uses to provide responses to requests made by the LBS subsystem via <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html"><span class="apiname">CLbsNetworkProtocolBase</span></a>. </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e283 "><p> <span class="filepath">lbsnetprotocolbase.h</span>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e277 "><p> <a href="GUID-D7707B28-D173-3F41-899C-6BEE3C8C3D74.html"><span class="apiname"> MLbsNetworkProtocolObserver2</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e280 "><p>An extended observer interface. This is not yet implemented by the LBS subsystem. </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e283 "><p> <span class="filepath">lbsnetprotocolbase.h</span>  </p>
 </td>
 </tr>
 </tbody>
 </table>
</div>
 <p> <em>Table 1 Classes of the Network Protocol Module API.</em>  </p>
 <p>Network Protocol Modules derive from <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html"><span class="apiname">CLbsNetworkProtocolBase</span></a> or <a href="GUID-AD071127-974A-35B4-A39F-340CDC6A1A81.html"><span class="apiname">CLbsNetworkProtocolBase2</span></a>. The LBS subsystem implements the <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html"><span class="apiname">MLbsNetworkProtocolObserver</span></a> interface to interact with a Network Protocol Module. </p>
 <p><strong>Libraries </strong> </p>
 <p>The main classes of the Network Protocol Module API are packaged in <span class="filepath">lbsnetprotocol.dll</span>. Network Protocol Module implementations link to <span class="filepath">lbsnetprotocol.lib</span>. </p>
 <p><strong>LBS configuration </strong> </p>
 <p>In addition to creating and installing a Network Protocol Module, the <a href="GUID-23BBC1D8-B3A0-5148-A4F1-22ECF3043E4E.html" title="The documents in this section explain how to configure LBS by using the LBS Administration API or by using a repository initialisation file.">LBS administration settings</a> <samp class="codeph">KLbsSettingHomeProtocolModule</samp> and <samp class="codeph">KLbsSettingRoamingProtocolModule</samp> must be set to the implementation UIDs of the appropriate Network Protocol Module ECOM plug-ins for LBS to load and use them. See <a href="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782.html#GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CF0C5893-5871-51FA-8AA5-9889010ED031">Loading the Network Protocol Module</a> for more information. </p>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FE060846-86FD-5E89-99CB-10E6433120F4"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FE060846-86FD-5E89-99CB-10E6433120F4"><!-- --></a><h2 class="sectiontitle"> Using the Network Protocol Module API</h2> <p>A Network Protocol Module communicates with two other software components: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-D48F33D4-1BF4-53AE-A86F-CF70F90D5FAF"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-D48F33D4-1BF4-53AE-A86F-CF70F90D5FAF"><!-- --></a><p>The LBS Network Gateway process </p>
 <p>The Network Gateway process communicates with the other components of the LBS subsystem. It is responsible for: </p>
 <a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-856B4F05-80D0-5810-942B-FDAD39418EF7"><!-- --></a><ol id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-856B4F05-80D0-5810-942B-FDAD39418EF7"><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CDCA4733-48C3-5DE9-9A9C-E16BC77F32B4"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CDCA4733-48C3-5DE9-9A9C-E16BC77F32B4"><!-- --></a><p>Handling requests for location from the LBS subsystem and sending them to the network via the Network Protocol Module </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CBC7AD37-EED9-5ACD-8788-AB90C3D3E436"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CBC7AD37-EED9-5ACD-8788-AB90C3D3E436"><!-- --></a><p>Receiving a reference position (based on Cell ID) from the network via the Network Protocol Module and sending it into LBS in response to 1. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-87B83DC3-F431-55BC-A4DF-3B984A11F2AF"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-87B83DC3-F431-55BC-A4DF-3B984A11F2AF"><!-- --></a><p>Handling requests for A-GPS assistance data from an A-GPS Integration Module and sending them to the network via the Network Protocol Module </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-BECEF30D-3D49-56FF-B61C-F9AF6BD820CB"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-BECEF30D-3D49-56FF-B61C-F9AF6BD820CB"><!-- --></a><p>Receiving A-GPS assistance data from the network via the Network Protocol Module and sending it to the A-GPS Location Manager in response to 3. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-53719E58-C76F-5D75-A874-0C361E14FB15"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-53719E58-C76F-5D75-A874-0C361E14FB15"><!-- --></a><p>Handling requests from the LBS subsystem to send device location data to a third party over the network (MO-LR transmit to third party). </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-589FDE9F-9012-5857-81E8-676C33513685"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-589FDE9F-9012-5857-81E8-676C33513685"><!-- --></a><p>Receiving privacy requests and location requests from the network (MT-LR and Emergency MT-LR) via the Network Protocol Module and forwarding them to the LBS subsystem. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-7A8AD974-6545-5B2A-8DDC-5A6AF619104F"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-7A8AD974-6545-5B2A-8DDC-5A6AF619104F"><!-- --></a><p>Sending responses to MT-LR privacy requests and location requests to the network via the Network Protocol Module in response to 6. </p>
 </li>
 </ol>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-55F2693F-2F1C-553C-A5E2-41F47D802061"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-55F2693F-2F1C-553C-A5E2-41F47D802061"><!-- --></a><p>A network communications stack </p>
 <p>A Network Protocol Module that integrates with the control plane uses the Symbian ETel API. </p>
 <p>A Network Protocol Module that integrates with the user plane uses the Symbian ESock API. The Symbian reference <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a> is a user plane Network Protocol Module. </p>
 </li>
 </ul>
 <p>Figures 3, 4 and 5 show simple sequences of interaction between the LBS Network Gateway process, the Network Protocol Module and the network for MO-LR (self locate), MO-LR (transfer to third party) and MT-LR. </p>
 <p>The behaviour of a Network Protocol Module can be complex when it is linked to a A-GPS Integration Module. Several detailed end-to-end sequence diagrams that document the behaviour of the LBS subsystem including the behaviour expected from a Network Protocol Module can be found in <a href="GUID-D9EA897E-71FB-5012-8208-49300A19D22C.html">LBS Sequence Diagrams</a>. </p>
 <p> </p>
 <div class="fignone" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-C3A0E3A3-4111-5F0D-ACF2-60DF51FED49C"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-C3A0E3A3-4111-5F0D-ACF2-60DF51FED49C"><!-- --></a><span class="figcap">Figure 3. 
             Figure 3. Simple MO-LR self locate sequence (for terminal based
             positioning) 
          </span> <img src="GUID-D98DA21C-B0F4-5267-AF00-94B789AE302A_d0e449962_href.png"/></div>
 <div class="fignone" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-74F19B87-DE33-5DEC-A15B-C5DEB4A864BF"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-74F19B87-DE33-5DEC-A15B-C5DEB4A864BF"><!-- --></a><span class="figcap">Figure 4. 
             Figure 4. Simple MO-LR transfer to third party sequence (for terminal
             based positioning) 
          </span> <img src="GUID-CE49EF9C-C87A-5D4C-91F3-5C2950A5553B_d0e449968_href.png"/></div>
 <div class="fignone" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CAB47FC4-249B-5256-90E1-EE94F9577C8E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CAB47FC4-249B-5256-90E1-EE94F9577C8E"><!-- --></a><span class="figcap">Figure 5. 
             Figure 5. Simple MT-LR sequence (for terminal based positioning) 
          </span> <img src="GUID-C103A584-3498-5F0A-8F0B-F97D33749CEF_d0e449974_href.png"/></div>
 <p><strong>CLbsNetworkProtocolBase </strong> </p>
 <p>The following briefly describes the <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html"><span class="apiname">CLbsNetworkProtocolBase</span></a> methods grouped according to their function. The LBS Network Gateway process calls these methods on the licensee Network Protocol Module. More detailed information about the purpose of these methods and their parameter lists can be found by following the links to the Symbian platform reference documentation. </p>
 <p> <strong>Setting tracking mode (if necessary)</strong>  </p>
 <p>For MO-LR self locate, an application client can ask the LBS subsystem for periodic location updates. This is known as tracking and is described in the Location Acquisition API document <a href="GUID-F6B5F777-D12F-5913-AECE-047DF8C72F1F.html" title="This document demonstrates how a client application uses the Location Acquisition API to get a position.">How to get location information</a>. </p>
 <p>When a client requests tracking, the LBS subsystem notifies a Network Protocol Module of this requirement by calling <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-367DC79E-CB61-3EFB-9928-104F5B6A0021"><span class="apiname">CLbsNetworkProtocolBase::AdviceSystemStatus()</span></a> with a parameter value <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-1546BC54-76FC-3C4C-BA99-CB13027687EE"><span class="apiname">CLbsNetworkProtocolBase::ESystemStatusClientTracking</span></a>. This method is called before the first location request <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> described below. </p>
 <p>When there are no longer any tracking LBS clients, the LBS subsystem notifies a Network Protocol Module by calling <samp class="codeph">AdviceSystemStatus()</samp> with a parameter value <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-B71C5F74-2673-3AFE-813C-41A91E661FD8"><span class="apiname">CLbsNetworkProtocolBase::ESystemStatusNone</span></a>. </p>
 <p> <strong>Requesting and cancelling MO-LR (self locate)</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-712CCD16-B4B3-55A7-8B25-8B39DBD1867E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-712CCD16-B4B3-55A7-8B25-8B39DBD1867E"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> </p>
 <p>This method is called to initiate an MO-LR (self locate) when GPS is to be used to obtain a location. In cases where the precision of a GPS fix is not required (for example because of less demanding location quality criteria), the method <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-E52AC2F2-6E42-370B-93EB-48389E062E33"><span class="apiname">CLbsNetworkProtocolBase::RequestNetworkLocation()</span></a> may be called instead for MO-LR (see below). </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-ED729CC1-01D9-5420-9A5E-F448D7960F89"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-ED729CC1-01D9-5420-9A5E-F448D7960F89"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-D2C7B03B-8EB8-3CEB-B35E-2EC0B1DB4A04"><span class="apiname">CLbsNetworkProtocolBase::CancelSelfLocation()</span></a>  </p>
 <p>This method is called to cancel an outstanding MO-LR which was made by calling <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a>. </p>
 </li>
 </ul>
 <p> <strong>Requesting and cancelling MO-LR (self locate) from the network</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1CF3D7CE-C425-573A-8659-EB7DB6D17050"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1CF3D7CE-C425-573A-8659-EB7DB6D17050"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-E52AC2F2-6E42-370B-93EB-48389E062E33"><span class="apiname">CLbsNetworkProtocolBase::RequestNetworkLocation()</span></a> </p>
 <p>This method is called to initiate an MO-LR when the precision of GPS is not required. In cases where the precision of a GPS fix is required, the method <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> is called instead. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-0185B725-39EA-5CEC-AA64-00A877791A03"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-0185B725-39EA-5CEC-AA64-00A877791A03"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-6AA30D7B-3281-39BE-B314-8666809D80A9"><span class="apiname">CLbsNetworkProtocolBase::CancelNetworkLocation()</span></a> </p>
 <p>This method is called to cancel an outstanding MO-LR which was made by calling <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-E52AC2F2-6E42-370B-93EB-48389E062E33"><span class="apiname">CLbsNetworkProtocolBase::RequestNetworkLocation()</span></a>. </p>
 </li>
 </ul>
 <p> <strong>Requesting and cancelling of MO-LR (transmit to third party)</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F414CB99-1A53-511B-9A59-1E10E4C57D54"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F414CB99-1A53-511B-9A59-1E10E4C57D54"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-EF593B81-667B-36CB-9457-0B683B76468F"><span class="apiname">CLbsNetworkProtocolBase::RequestTransmitLocation()</span></a> </p>
 <p>This method is called to send location to a third party. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-906C761E-E497-5AA8-AA93-202FD446BF09"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-906C761E-E497-5AA8-AA93-202FD446BF09"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-70188A68-C4CD-3079-B64F-AF3D10CB990D"><span class="apiname">CLbsNetworkProtocolBase::CancelTransmitLocation()</span></a> </p>
 <p>This method is called to cancel an outstanding request to send location to a third party. </p>
 </li>
 </ul>
 <p> <strong>Responding to MT-LR privacy requests</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B30ED2D0-5353-51F8-A311-B5D00C250AF4"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B30ED2D0-5353-51F8-A311-B5D00C250AF4"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-452D97D6-D54C-359C-B193-E152C3690351"><span class="apiname">CLbsNetworkProtocolBase::RespondPrivacyRequest()</span></a> </p>
 <p>This method is called in response to an MT-LR privacy request in order to accept or reject the request. </p>
 <p>See <a href="GUID-CDE5CC9D-F6DE-5A21-97C3-59A2F3398A15.html" title="A privacy request is a request for permission to obtain the mobile device's location. Privacy requests are usually sent from the network to the mobile device as part of an MT-LR.">Privacy requests</a> for more information about how privacy requests are handled by the LBS subsystem. </p>
 </li>
 </ul>
 <p> <strong>Processing location requests</strong>  </p>
 <p>As shown in figures 3, 4 and 5, MO-LR self locate, MO-LR transfer to third party and MT-LR cause the Network Protocol Module to call <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-676C6200-0A3A-331D-9776-17CA53E8A1D7"><span class="apiname">MLbsNetworkProtocolObserver::ProcessLocationRequest()</span></a> on the LBS Network Gateway process. </p>
 <p>An instance of <a href="GUID-346C477F-005A-311D-A920-8C0F40E391CE.html"><span class="apiname">TLbsNetPosRequestMethod</span></a> is passed when the Protocol Module calls <samp class="codeph">MLbsNetworkProtocolObserver::ProcessLocationRequest()</samp>. It defines the type(s) of positioning method the LBS subsystem should use to calculate the device location. </p>
 <p>A Network Protocol Module can specify up to two positioning methods, if required: <a href="GUID-346C477F-005A-311D-A920-8C0F40E391CE.html"><span class="apiname">TLbsNetPosRequestMethod</span></a> contains an array of elements of type <a href="GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35.html"><span class="apiname">TLbsNetPosMethod</span></a>. Each <samp class="codeph">TLbsNetPosMethod</samp> element specifies a technology type and the positioning mode that should be used by the LBS subsystem to calculate location. </p>
 <p>If the array contains two elements, the first element contains the preferred technology type and positioning mode. The second element contains an alternative positioning mode. </p>
 <p>If the array contains only one element then this specifies the technology type and positioning mode that must be used by the LBS subsystem. </p>
 <p>Examples of how a Network Protocol Module specifies the positioning mode follows: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-D6A828D2-C209-58DF-8272-49996E4DF68C"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-D6A828D2-C209-58DF-8272-49996E4DF68C"><!-- --></a><p> <strong>Terminal based positioning mode only</strong>  </p>
 <p>The Protocol Module creates a single <samp class="codeph">TLbsNetPosMethod</samp> element and calls <a href="GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35.html#GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35__GUID-E1A14CDB-267B-3B4D-8C21-6BD85F23AFCB"><span class="apiname">TLbsNetPosMethod::SetPosMethod()</span></a> passing the parameters: </p>
 <p> <samp class="codeph">aPosMeans = KLbsPositioningMeansGps</samp>  </p>
 <p> <samp class="codeph">aPosMode = TPositionModuleInfo::ETechnologyTerminal |
                TPositionModuleInfo::ETechnologyAssisted</samp>  </p>
 <p>In this case, the LBS subsystem attempts to calculate a GPS location fix using assistance data from the network. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B25E613C-18D3-5026-8F9A-5EB3CFC0490A"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-B25E613C-18D3-5026-8F9A-5EB3CFC0490A"><!-- --></a><p> <strong>Terminal assisted positioning mode only</strong>  </p>
 <p>The Protocol Module creates a single <samp class="codeph">TLbsNetPosMethod</samp> element and calls <a href="GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35.html#GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35__GUID-E1A14CDB-267B-3B4D-8C21-6BD85F23AFCB"><span class="apiname">TLbsNetPosMethod::SetPosMethod()</span></a> passing the parameters: </p>
 <p> <samp class="codeph">aPosMeans = KLbsPositioningMeansGps</samp>  </p>
 <p> <samp class="codeph">aPosMode = TPositionModuleInfo::ETechnologyNetwork |
                TPositionModuleInfo::ETechnologyAssisted</samp>  </p>
 <p>In this case, the LBS subsystem attempts to calculate a GPS location fix using assistance data from the network. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-BC446ED6-9800-5B21-A702-A4C5A011C6BE"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-BC446ED6-9800-5B21-A702-A4C5A011C6BE"><!-- --></a><p> <strong>Terminal based positioning mode (1st choice) &amp; terminal assisted positioning mode (2nd choice)</strong>  </p>
 <p>The Protocol Module creates two <samp class="codeph">TLbsNetPosMethod</samp> elements and calls <a href="GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35.html#GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35__GUID-E1A14CDB-267B-3B4D-8C21-6BD85F23AFCB"><span class="apiname">TLbsNetPosMethod::SetPosMethod()</span></a> for each: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FECD0D61-9C99-5C94-A6B9-113DD85571E7"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FECD0D61-9C99-5C94-A6B9-113DD85571E7"><!-- --></a><p>1st Element: </p>
 <p> <samp class="codeph">aPosMeans = KLbsPositioningMeansGps</samp>  </p>
 <p> <samp class="codeph">aPosMode = TPositionModuleInfo::ETechnologyTerminal |
                     TPositionModuleInfo::ETechnologyAssisted</samp>  </p>
 </li>
 </ul>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8FC84A75-96A9-5C76-B059-B0D70C36531E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8FC84A75-96A9-5C76-B059-B0D70C36531E"><!-- --></a><p>2nd Element: </p>
 <p> <samp class="codeph">aPosMeans = KLbsPositioningMeansGps</samp>  </p>
 <p> <samp class="codeph">aPosMode = TPositionModuleInfo::ETechnologyNetwork |
                     TPositionModuleInfo::ETechnologyAssisted</samp>  </p>
 </li>
 </ul>
 <p>In this case, the LBS subsystem attempts to calculate a GPS location fix using assistance data from the network. While LBS is calculating a GPS fix it also returns GPS measurements to the Network Protocol Module. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-89A1F4A4-0FA6-518C-AB8B-FC72A0E67C6F"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-89A1F4A4-0FA6-518C-AB8B-FC72A0E67C6F"><!-- --></a><p> <strong>Position from the network (cell based positioning)</strong>  </p>
 <p>The Protocol Module creates a single <samp class="codeph">TLbsNetPosMethod</samp> element and calls <a href="GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35.html#GUID-1278D006-4DF8-3908-A0A5-9F9FD2CC4C35__GUID-E1A14CDB-267B-3B4D-8C21-6BD85F23AFCB"><span class="apiname">TLbsNetPosMethod::SetPosMethod()</span></a> passing the parameters: </p>
 <p> <samp class="codeph">aPosMeans = KLbsPositioningMeansCell</samp>  </p>
 <p> <samp class="codeph">aPosMode = TPositionModuleInfo::ETechnologyNetwork</samp>  </p>
 <p>In this case, the LBS subsystem uses the reference location from the network as the location fix. </p>
 </li>
 </ul>
 <p>Calling <samp class="codeph">MLbsNetworkProtocolObserver::ProcessLocationRequest()</samp> causes the LBS subsystem to begin to calculate a location (or begin to obtain GPS measurements necessary to calculate a location). When location data is available, the LBS Network Gateway process calls <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-D7F6BA26-00D4-3DF4-8E6D-D4E990FA1F04"><span class="apiname">CLbsNetworkProtocolBase::RespondLocationRequest()</span></a>. </p>
 <p> <strong>Requesting A-GPS assistance data</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-5F0513D3-7F52-59E9-8EE7-40B81CE13E22"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-5F0513D3-7F52-59E9-8EE7-40B81CE13E22"><!-- --></a><p> <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-9530C97E-DBA4-3253-8C26-8E5300FD812F"><span class="apiname">CLbsNetworkProtocolBase::RequestAssistanceData()</span></a> </p>
 <p>This method is called to get additional A-GPS assistance data as part of an MO-LR (self locate), MO-LR (transfer to third party) or an MT-LR. Assistance data identifies the satellites that should be visible from the current mobile device location and this reduces the time required to obtain GPS measurements. </p>
 </li>
 </ul>
 <p><strong>MLbsNetworkProtocolObserver </strong> </p>
 <p>The following briefly describes the <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html"><span class="apiname">MLbsNetworkProtocolObserver</span></a> methods grouped according to their function. A licensee Network Protocol Module calls these methods on the LBS Network Gateway process. More detailed information about the purpose of these methods and their parameter lists can be found by following the links to the Symbian platform reference documentation. </p>
 <p> <strong>Getting the current capabilities of the LBS subsystem</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-23A363FA-507C-52DB-969D-653C0B0A0123"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-23A363FA-507C-52DB-969D-653C0B0A0123"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-8187EB64-5AAA-34A3-B0E0-297A30A2E584"><span class="apiname">MLbsNetworkProtocolObserver::GetCurrentCapabilities()</span></a> </p>
 <p>This method is called by the Network Protocol Module to get the capabilities of the LBS subsystem, such as whether it can calculate a GPS location fix and the supported GPS modes. The method takes a single parameter of class <a href="GUID-90640AC2-12C6-3BBB-B620-71AA99F44BFA.html"><span class="apiname">TLbsNetPosCapabilities</span></a> (defined in <span class="filepath">lbsnetcommon.h</span>) that encapsulates methods to discover the protocols and positioning methods supported by the LBS subsystem. </p>
 <p>Note that the capabilities of the LBS subsystem can change at runtime (because of modification via the LBS Administration API) and therefore a licensee Network Protocol Module should call this method whenever it needs to check the current capabilities of the LBS subsystem. </p>
 </li>
 </ul>
 <p> <strong>Updating the LBS Network Gateway with the Network Protocol Module status </strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-51402E5F-EA73-5E02-8672-69A993027C50"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-51402E5F-EA73-5E02-8672-69A993027C50"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-318EE503-8EDF-3562-BD2A-24637B7CB505"><span class="apiname">MLbsNetworkProtocolObserver::ProcessStatusUpdate()</span></a> <strong/> </p>
 <p>This method is called to update the LBS subsystem with the current status of the Network Protocol Module. </p>
 <p>The method takes a single parameter of type <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-81AC4613-8227-3310-B535-A19FB29C7AAA"><span class="apiname">MLbsNetworkProtocolObserver::TLbsNetProtocolServiceMask</span></a>, a bitmask variable that indicates the types of requests currently being handled by the Network Protocol Module. This bitmask variable holds a bitwise OR of values of type <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-BA8E1132-CE35-3DD5-AF6B-B198646C2FB6"><span class="apiname">MLbsNetworkProtocolObserver::TLbsNetProtocolService</span></a>. </p>
 <p>A Network Protocol Module calls this method to inform the LBS subsystem whenever its state has changed, for example after the LBS subsystem has requested a new MO-LR or when an MT-LR is received from the network. </p>
 </li>
 </ul>
 <p> <strong>Notifying of MT-LR privacy requests</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-87A7B07A-5148-582B-8E06-55D0E5C6F1F6"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-87A7B07A-5148-582B-8E06-55D0E5C6F1F6"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-377A3D40-D844-35C4-8E79-39C819F1890E"><span class="apiname">
                MLbsNetworkProtocolObserver::ProcessPrivacyRequest()</span></a>  </p>
 <p>This method is called to indicate that an MT-LR privacy request has been received. </p>
 <p>See <a href="GUID-CDE5CC9D-F6DE-5A21-97C3-59A2F3398A15.html" title="A privacy request is a request for permission to obtain the mobile device's location. Privacy requests are usually sent from the network to the mobile device as part of an MT-LR.">Privacy requests</a> for more information about how privacy requests are handled by the LBS subsystem. </p>
 </li>
 </ul>
 <p> <strong>Requesting a location</strong>  </p>
 <p>For MO-LR (self locate) the LBS Network Gateway process calls <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-0E4234D2-D8B0-302F-8DE5-EA47ED5E594F"><span class="apiname">CLbsNetworkProtocolBase::RequestSelfLocation()</span></a> (for GPS positioning modes) or <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-E52AC2F2-6E42-370B-93EB-48389E062E33"><span class="apiname">CLbsNetworkProtocolBase::RequestNetworkLocation()</span></a> (for cell-based positioning modes). </p>
 <p>For MO-LR (transfer to third party) the LBS Network Gateway calls <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-EF593B81-667B-36CB-9457-0B683B76468F"><span class="apiname">CLbsNetworkProtocolBase::RequestTransmitLocation()</span></a>. In response to these, or when an MT-LR location request is received, the Network Protocol Module calls <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-676C6200-0A3A-331D-9776-17CA53E8A1D7"><span class="apiname">MLbsNetworkProtocolObserver::ProcessLocationRequest()</span></a> on the LBS Network Gateway. </p>
 <p>A <a href="GUID-346C477F-005A-311D-A920-8C0F40E391CE.html"><span class="apiname">TLbsNetPosRequestMethod</span></a> parameter specifies the method that should be used by the LBS subsystem to obtain the location fix. </p>
 <p> <strong>Handling receipt of A-GPS assistance data</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-82509F65-1BC8-55F9-9DF5-08341B81F5DF"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-82509F65-1BC8-55F9-9DF5-08341B81F5DF"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-24F29872-17BA-3B13-A7A3-B36113786964"><span class="apiname">MLbsNetworkProtocolObserver::ProcessAssistanceData()</span></a> </p>
 <p>This method is called when A-GPS assistance data is received from the network. The assistance data is delivered to LBS as an <a href="GUID-E250BCA2-381D-389E-A7F3-7F520B7CD326.html"><span class="apiname">RLbsAssistanceDataBuilderSet</span></a> object and is cached by the LBS subsystem. A licensee A-GPS Integration Module is notified when assistance data is delivered to LBS and may request it. </p>
 </li>
 </ul>
 <p> <strong>Resetting A-GPS assistance data for testing</strong>  </p>
 <p>If requested to do so by the network, a licensee's Network Protocol Module can instruct the LBS subsystem and the licensee's A-GPS Integration Module to reset any cached assistance data. It does this by calling <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-24F29872-17BA-3B13-A7A3-B36113786964"><span class="apiname">MLbsNetworkProtocolObserver::ProcessAssistanceData()</span></a>, with a <a href="GUID-0F4B82BB-37D6-35AD-993B-F766E1CF0637.html"><span class="apiname">KPositionAssistanceDataReset</span></a> parameter to tell LBS to reset its cached assistance data and a <a href="GUID-343E1FD7-9D75-3A41-84EC-B35030C06557.html"><span class="apiname">TLbsAssistanceDataGroup</span></a> bitmask parameter to specify the types of assistance data to be reset. Using <samp class="codeph">ProcessAssistanceData()
          </samp> in this way has two effects: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-450BB72B-6EB3-54F9-A676-66F25C01DF62"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-450BB72B-6EB3-54F9-A676-66F25C01DF62"><!-- --></a><p>LBS deletes the specified assistance data in its own assistance data cache. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2FC89FC0-2602-573F-A9D8-ABA6EAE39B5F"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2FC89FC0-2602-573F-A9D8-ABA6EAE39B5F"><!-- --></a><p>LBS calls the A-GPS Location DataSource API method <a href="GUID-A458AA58-8BD6-303B-89E5-C99000376615.html#GUID-A458AA58-8BD6-303B-89E5-C99000376615__GUID-0370A120-0222-3559-A4B5-89C997B192D7"><span class="apiname">CLbsLocationSourceGpsBase::AssistanceDataEvent()</span></a> with a <a href="GUID-0F4B82BB-37D6-35AD-993B-F766E1CF0637.html"><span class="apiname">KPositionAssistanceDataReset</span></a> parameter (to inform a licensee's A-GPS Integration Module that it must reset its assistance data) and a <a href="GUID-343E1FD7-9D75-3A41-84EC-B35030C06557.html"><span class="apiname">TLbsAssistanceDataGroup</span></a> bitmask parameter (to specify the types of assistance data that should be reset). </p>
 </li>
 </ul>
 <p> <strong>Updating location data</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-6D522100-FB50-5B57-902C-0EE1DCF4CB63"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-6D522100-FB50-5B57-902C-0EE1DCF4CB63"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-CAB9645E-91AD-326B-8803-45F28505CCCC"><span class="apiname">MLbsNetworkProtocolObserver::ProcessLocationUpdate()</span></a> </p>
 <p>This method is called to update the LBS subsystem either: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-05143F93-D3D7-5F09-9935-66B2C7D25E6E"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-05143F93-D3D7-5F09-9935-66B2C7D25E6E"><!-- --></a><p>When a reference position is returned from the network </p>
 <p> <samp class="codeph">ProcessLocationUpdate()</samp> returns a <a href="GUID-73D6F438-C270-33B9-974B-D4D1583E1738.html"><span class="apiname">TPositionInfoBase</span></a> parameter which contains the reference position. Calling <a href="GUID-73D6F438-C270-33B9-974B-D4D1583E1738.html#GUID-73D6F438-C270-33B9-974B-D4D1583E1738__GUID-AC9654DD-2FC8-3B27-8743-83D7B8C58B79"><span class="apiname">TPositionInfoBase::PositionMode()</span></a> returns <samp class="codeph">TPositionModuleInfo::ETechnologyNetwork</samp>. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F61EF0F4-25A8-5E89-9C3F-3494F7625EF9"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F61EF0F4-25A8-5E89-9C3F-3494F7625EF9"><!-- --></a><p>When the 'final position' is returned from the network (for MO-LR self locate and MO-LR transfer to third party) </p>
 <p>The final position is the last position returned from the network. For terminal based positioning, the final position is just the position that LBS sent to the network by calling <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-D7F6BA26-00D4-3DF4-8E6D-D4E990FA1F04"><span class="apiname">CLbsNetworkProtocolBase::RespondLocationRequest()</span></a>. For terminal assisted positioning, the final position is the one calculated by the network using GPS measurements from the device. </p>
 <p>For a final position calculated using terminal based positioning <a href="GUID-73D6F438-C270-33B9-974B-D4D1583E1738.html#GUID-73D6F438-C270-33B9-974B-D4D1583E1738__GUID-AC9654DD-2FC8-3B27-8743-83D7B8C58B79"><span class="apiname">TPositionInfoBase::PositionMode()</span></a> returns <samp class="codeph">TPositionModuleInfo::ETechnologyTerminal |
                     TPositionModuleInfo::ETechnologyAssisted</samp>. </p>
 <p>For a final position calculated using terminal assisted positioning <a href="GUID-73D6F438-C270-33B9-974B-D4D1583E1738.html#GUID-73D6F438-C270-33B9-974B-D4D1583E1738__GUID-AC9654DD-2FC8-3B27-8743-83D7B8C58B79"><span class="apiname">TPositionInfoBase::PositionMode()</span></a> returns <samp class="codeph">TPositionModuleInfo::ETechnologyNetwork |
                     TPositionModuleInfo::ETechnologyAssisted</samp>. </p>
 </li>
 </ul>
 </li>
 </ul>
 <p> <strong>Completing a session</strong>  </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FC05B479-8906-57B3-AAFD-044BF798C231"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FC05B479-8906-57B3-AAFD-044BF798C231"><!-- --></a><p> <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html#GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4__GUID-ACBFB09B-D4D1-36A0-A9D6-FD3207E93E30"><span class="apiname">MLbsNetworkProtocolObserver::ProcessSessionComplete()</span></a> </p>
 <p>This method is called to indicate that a session is complete (for example that a single MO-LR or MT-LR is complete). </p>
 </li>
 </ul>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F4DA8C85-7F74-5FA6-BF05-1DC2636AD764"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F4DA8C85-7F74-5FA6-BF05-1DC2636AD764"><!-- --></a><h2 class="sectiontitle">Network Protocol Module configuration</h2> <p>In addition to coding the Network Protocol Module, there are configuration steps that a device creator may need to complete: </p>
 <p><strong>Update the Network Location Manager .ini file</strong> </p>
 <p>The file <span class="filepath">networklocationmanager.ini</span> specifies the positioning capabilities of the network to LBS. It is exported to <span class="filepath">&lt;rom_drive&gt;:\private\10282253\lbs\locmods\</span> (<samp class="codeph">10282253</samp> is the UID3 of the LBS Root process) as part of the LBS build process. The contents of the file as delivered with the LBS subsystem are shown below: </p>
 <pre class="codeblock" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8B3E7412-56A7-58C8-AF2F-72309D0ADA10"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-8B3E7412-56A7-58C8-AF2F-72309D0ADA10"><!-- --></a>
# networklocationmanager.ini

[1]
Version= 0.1.1        #
ModuleId= 271064387    # dec
ModuleName= "NetLocManager"    # 
TechnologyType= 0010    # binary
DeviceLocation= 0010    # binary
Capabilities= 1111    # binary
ClassesSupported= 111111    # binary
TimeToFirstFix= 20000    # ms
TimeToNextFix= 20000    # ms
HorizontalAccuracy= 100 # real
VerticalAccuracy= 100 # real
CostIndicator= 3    # dec
PowerConsumption = 2 # dec
ExecutableName= "lbsnetlocmanager.exe"
</pre>
 <p> <strong>Device creators only need to change the contents of the file if the parameters of their Network Protocol Module and the network capabilities are significantly different to the values shown above. </strong>  </p>
 <p>The table below describes each of the values in <span class="filepath">networklocationmanager.ini</span>. </p>
 
<div class="tablenoborder"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-5E925482-2D67-59D3-9F02-0E8ED0E851AB"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-5E925482-2D67-59D3-9F02-0E8ED0E851AB" frame="border" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" id="d1828529e1423"> Parameter </th>
 <th class="cellrowborder" valign="top" id="d1828529e1426"> Type </th>
 <th class="cellrowborder" valign="top" id="d1828529e1429"> Description </th>
 </tr>
 </thead>
 <tbody><tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>Version </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A string </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The Network Protocol Module version. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>ModuleId </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A UID (decimal) </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The UID3 of the Network Location Manager process. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>TechnologyType </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A binary value from <a href="GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26.html#GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26__GUID-03AF8C51-1CAF-3F4C-BED1-17844FAE8423"><span class="apiname">TPositionModuleInfo::_TTechnologyType</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The technology types the module supports: one or more of handset based, network based or network assisted. In this file the value specifies network only. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>DeviceLocation </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A bitmask value from <a href="GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26.html#GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26__GUID-3AD1FF55-D635-3C41-AB06-EF426E0B6993"><span class="apiname">TPositionModuleInfo::_TDeviceLocation</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>Specifies whether the module is internal or external to the handset. Currently only internal modules are supported. Defined in <span class="filepath">LbsCommon.h</span>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>Capabilities </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A bitmask value from <a href="GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26.html#GUID-B098F3DB-E2FE-3C5A-8508-4B04D954AB26__GUID-C798CBA5-39BE-3072-9E9B-5910C4835DCC"><span class="apiname">TPositionModuleInfo::_TCapabilities</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>A bitmask value that defines the capabilities of this module (such as the ability to provide vertical position and speed data). Defined in <span class="filepath">LbsCommon.h</span>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>ClassesSupported </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A bitmask value from <a href="GUID-BC8B2D08-1B64-35BB-8F58-4E7123650BD7.html"><span class="apiname">_TPositionInfoClassType</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>A bitmask value that defines the class types that are supported by this module. Defined in <span class="filepath">LbsClassTypes.h</span>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>TimeToFirstFix </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>An integer value </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The time to get the first location fix (in milliseconds). </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>TimeToNextFix </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>An integer value </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The time to get subsequent location fixes after the first location fix (in milliseconds). </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>HorizontalAccuracy </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A real value </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The maximum accuracy of horizontal position that the module can supply (in metres). For example 100 if the location fix is accurate to within 100m. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>VerticalAccuracy </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A real value </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The maximum accuracy of vertical position that the module can supply (in metres). </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>CostIndicator </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A value from <a href="GUID-1AA235FA-CEC1-3853-8F96-C538C02B596D.html#GUID-1AA235FA-CEC1-3853-8F96-C538C02B596D__GUID-78C084A0-43F8-3040-BD98-70E2E62A5D45"><span class="apiname">TPositionQuality::TCostIndicator</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>A qualitative measure of the financial cost to the handset owner of using this module to obtain a location fix. Defined in <span class="filepath">LbsCommon.h</span>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>PowerConsumption </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A value from <a href="GUID-1AA235FA-CEC1-3853-8F96-C538C02B596D.html#GUID-1AA235FA-CEC1-3853-8F96-C538C02B596D__GUID-AD77543D-625A-39CF-A1D5-F5B5636E17F7"><span class="apiname">TPositionQuality::TPowerConsumption</span></a>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>A qualitative measure of the power consumption of using this module to obtain a location fix. Defined in <span class="filepath">LbsCommon.h</span>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1828529e1423 "><p>ExecutableName </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1426 "><p>A string </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1828529e1429 "><p>The name of the location manager process that uses this module. </p>
 </td>
 </tr>
 </tbody>
 </table>
</div>
 <p><strong> Create a Network Protocol Module .rss file</strong> </p>
 <p>A Network Protocol Module requires an ECOM resource file. The example below is the resource file for the Symbian reference SUPL Protocol Module. </p>
 <pre class="codeblock" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-07D94413-6611-5F3A-BD4A-3E1B4A06F904"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-07D94413-6611-5F3A-BD4A-3E1B4A06F904"><!-- --></a>
#include "ecom/registryinfov2.rh"

RESOURCE REGISTRY_INFO theInfo
    {
    resource_format_version = RESOURCE_FORMAT_VERSION_2;
    dll_uid = 0x10285A9C;
    interfaces = 
        {
        INTERFACE_INFO
            {
            // UID of interface that is implemented
            interface_uid = 0x10281D4A;
            implementations = 
                {
                IMPLEMENTATION_INFO
                    {
                    // UID of this interface implementation
                    implementation_uid = 0x10285A9D;
                    version_no = 1;
                    display_name = "SUPL V1 Protocol Module";
                    default_data = "";
                    opaque_data = "";
                    rom_only = 0;
                    }
                };
            }
        };
    }
             </pre>
 <p><strong>Update the LBS administration settings</strong> </p>
 <p>The implementation UIDs of the Network Protocol Module implementations must be defined in the <a href="GUID-852E58C1-EA5C-5B46-9020-4463D3FA06AD.html" title="This topic describes the LBS administration repository initialisation file.">LBS administration repository initialisation file</a>. The example below shows an initialisation file entry that configures LBS to load the Symbian reference SUPL Protocol Module when the handset is in the home network and also when roaming. </p>
 <p>Note that if the UID of the Network Protocol Module is changed at runtime by using the LBS Administration API, it is necessary to reboot the handset in order to restart the LBS subsystem and load the different module. </p>
 <pre class="codeblock" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-24D660DD-6FE2-53CD-B88D-FC75AD86D3FD"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-24D660DD-6FE2-53CD-B88D-FC75AD86D3FD"><!-- --></a>
#KSettingHomeProtocolModule. Use reference SUPL Protocol Module
0x0000000E  int  0x10285A9D
#KSettingRoamingProtocolModule.
0x0000000F  int  0x10285A9D
</pre>
 </div>
 <div class="section" id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CF0C5893-5871-51FA-8AA5-9889010ED031"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-CF0C5893-5871-51FA-8AA5-9889010ED031"><!-- --></a><h2 class="sectiontitle">Loading the Network Protocol Module</h2> <p>A licensee Network Protocol Module is an ECOM plug-in DLL and is loaded by the LBS Network Gateway process. </p>
 <a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2C8EF4F1-5227-5520-8811-746119385B54"><!-- --></a><ol id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-2C8EF4F1-5227-5520-8811-746119385B54"><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-4C441D35-8BD7-592B-B828-16DCB8B2B2C5"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-4C441D35-8BD7-592B-B828-16DCB8B2B2C5"><!-- --></a><p>On startup, the LBS Network Gateway process reads <samp class="codeph">KSettingHomeProtocolModule</samp> and <samp class="codeph">KSettingRoamingProtocolModule</samp> from the central repository using the <a href="GUID-23BBC1D8-B3A0-5148-A4F1-22ECF3043E4E.html" title="The documents in this section explain how to configure LBS by using the LBS Administration API or by using a repository initialisation file.">LBS Administration API</a>. </p>
 <p>LBS uses the ETel API to obtain the mobile device's registration status with the network and LBS uses this status to decide which Network Protocol Module to load. A Symbian licensee must implement the ETel API methods <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0251C53A-852B-3737-9131-E82C489A5EA9"><span class="apiname">RMobilePhone::GetNetworkRegistrationStatus()</span></a> and <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-0B567090-EA9A-3023-8229-EEE43C024D54"><span class="apiname">RMobilePhone::NotifyNetworkRegistrationStatusChange()</span></a> to report the current registration status of the device. </p>
 <p>Only one Network Protocol Module is loaded by LBS when the mobile device starts. If the network registration status is reported as <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-3ECBA96E-CE2C-39AA-ACE4-DEA68BC69607"><span class="apiname">RMobilePhone::ERegisteredOnHomeNetwork</span></a>, LBS loads the Protocol Module plug-in specified by <samp class="codeph">KSettingHomeProtocolModule</samp>. If the network registration status is reported as <a href="GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8.html#GUID-AA81AFA4-6FAC-3B0D-A082-BE0AEC58CCA8__GUID-57C20A21-974C-3D12-9351-7728C159A526"><span class="apiname">RMobilePhone::ERegisteredRoaming</span></a>, LBS loads the Protocol Module plug-in specified by <samp class="codeph">KSettingRoamingProtocolModule</samp>. </p>
 <p> <strong>Note that if the network registration status is not reported as ERegisteredOnHomeNetwork or ERegisteredRoaming, LBS does not load a Network Protocol Module and the LBS subsystem will not function.</strong>  </p>
 <p>LBS does not unload a Network Protocol Module once it is loaded. The module remains loaded by the LBS subsystem until the device is restarted. This means that if a different Network Protocol Module is specified for the home network and for roaming, it is necessary to restart the mobile device when changing networks in order to load the correct module. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F8307B8E-014D-5033-8EB0-740E00E8074C"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-F8307B8E-014D-5033-8EB0-740E00E8074C"><!-- --></a><p>The LBS Network Gateway process creates a <a href="GUID-691CF528-01DC-36BE-B6D3-9D3A8C9F05EB.html"><span class="apiname">TLbsNetProtocolModuleParams</span></a> object, passing a reference to itself in the <samp class="codeph">TLbsNetProtocolModuleParams</samp> constructor (the Network Gateway process is an <a href="GUID-A97ABAA7-46B0-3E26-97C6-123C92CCEEE4.html"><span class="apiname">MLbsNetworkProtocolObserver</span></a>). </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1B787BCD-16CA-549A-BF3B-8B47EF5D2093"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-1B787BCD-16CA-549A-BF3B-8B47EF5D2093"><!-- --></a><p>The LBS Network Gateway process calls <a href="GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5.html#GUID-479C43CF-8787-3596-93ED-F03A8E5CA2F5__GUID-98669CB7-73FC-3C45-985B-C02C7A883948"><span class="apiname">CLbsNetworkProtocolBase::NewL()</span></a>, passing the licensee Network Protocol Module implementation class UID and the <samp class="codeph">TLbsNetProtocolModuleParams</samp> object as parameters. The ECOM framework loads the licensee Network Protocol Module and supplies it with a reference to the LBS Network Gateway process. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-80F24790-77B7-51AA-8864-1455DC912CB5"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-80F24790-77B7-51AA-8864-1455DC912CB5"><!-- --></a><p> <em>The following describes the behaviour of a Network Protocol Module that uses the control plane (ETel) and does not describe the behaviour of the Symbian reference SUPL Protocol Module on startup.</em>  </p>
 <p>When a licensee control plane Network Protocol Module is loaded, there are several methods that it typically needs to call immediately in order to register to receive MT-LR and A-GPS assistance data from the network: </p>
 <ul><li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-A69D092D-8210-598F-8E51-FD56DAA77248"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-A69D092D-8210-598F-8E51-FD56DAA77248"><!-- --></a><p>The Network Protocol Module instructs the ETel server to pre-allocate memory to handle an Emergency MT-LR by calling <a href="GUID-7EBCDEF3-FA85-313C-8FA5-526808D40988.html#GUID-7EBCDEF3-FA85-313C-8FA5-526808D40988__GUID-EFF36B0F-EF6A-3F4E-A582-9FF412E41F50"><span class="apiname">RPhone::SetEmergencyClient()</span></a>, passing a parameter value <a href="GUID-7EBCDEF3-FA85-313C-8FA5-526808D40988.html#GUID-7EBCDEF3-FA85-313C-8FA5-526808D40988__GUID-27F15C18-D372-306C-861B-E7C9012630D9"><span class="apiname">RPhone::EEmergencyLCSRequest</span></a>. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FFBFE93E-65D6-5D64-AB4D-74B1AC844F9C"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-FFBFE93E-65D6-5D64-AB4D-74B1AC844F9C"><!-- --></a><p> <a href="GUID-79C0E667-C026-3652-A043-20818C2A99BE.html#GUID-79C0E667-C026-3652-A043-20818C2A99BE__GUID-3FE6131C-DFCA-3EF3-A6D8-E9A17C431193"><span class="apiname">RMobileLocationServices::NotifyMeasurementControl()</span></a> registers the module to receive A-GPS assistance data updates from the network. Note that each time this method notifies the caller that assistance data is received, this method must be called again to request further notifications. </p>
 </li>
 <li id="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-00C400B2-9108-5825-922A-AA850AB563BF"><a name="GUID-CB6B4D1A-ACB9-5571-8C23-4BC095209782__GUID-00C400B2-9108-5825-922A-AA850AB563BF"><!-- --></a><p> <a href="GUID-79C0E667-C026-3652-A043-20818C2A99BE.html#GUID-79C0E667-C026-3652-A043-20818C2A99BE__GUID-973EECAD-4D09-3C07-B3F5-5AB21DBCE14B"><span class="apiname">RMobileLocationServices::NotifyMtlr()</span></a> registers the protocol module to receive MT-LRs from the network. Note that each time this method notifies the caller that an MT-LR is received, this method must be called again to request further notifications. </p>
 </li>
 </ul>
 </li>
 </ol>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-8985B028-4BCD-5858-B22F-EECC52B7B9EB.html" title="The documents in this section describe the Network Protocol Module API.">Network Protocol Module API</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>