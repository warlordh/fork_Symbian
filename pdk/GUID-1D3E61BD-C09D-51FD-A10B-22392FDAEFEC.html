<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Inactivity Monitoring and Peripheral Low Power States"/>
<meta name="abstract" content="Peripheral inactivity can be defined as the state when that peripheral’s driver has no pending request and is not performing background tasks."/>
<meta name="description" content="Peripheral inactivity can be defined as the state when that peripheral’s driver has no pending request and is not performing background tasks."/>
<meta name="DC.Relation" scheme="URI" content="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A91C6359-E547-51AD-AA8C-45BCAFBA98AC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Inactivity Monitoring and Peripheral Low Power States</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2399872 id2400380 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-A91C6359-E547-51AD-AA8C-45BCAFBA98AC.html" title="EKA2 is the principal Hardware and Kernel Services module. It manages the CPU and memory resources of a phone, and provides an architecture for device drivers to manage other hardware resources.">Kernel Architecture (EKA2)</a> &gt; <a href="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html" title="This topic describes how to implement a power controller in a base port.">Power Management Tutorials</a> &gt; </div>
<h1 class="topictitle1">Inactivity
Monitoring and Peripheral Low Power States</h1>
<div><p>Peripheral inactivity can be defined as the state when that peripheral’s
driver has no pending request and is not performing background tasks.</p>

<p>It is recommended that peripheral drivers monitor peripheral inactivity
because they are in the best position to understand the current hardware requirement. </p>

<p>The preferred approach is to implement inactivity monitoring in the platform
specific portion of peripheral drivers. However it is not always possible
to safely do it that way. In this case, an interface between the platform
specific and generic portions of the driver might need to be devised leading
to, in the future, inactivity monitoring functionality or assistance being
included in generic components. </p>

<p>In some cases the developer of the driver might decide to implement inactivity
monitoring with a grace delay, using timers. For example, consider a peripheral
used as a data input device. If the only way that the platform specific layer
of the peripheral driver has any knowledge that an input request is pending,
and that data is arriving, is when an incoming unit of data causes an interrupt,
then the resulting ISR (or deferred DFC) could re-start a timer with a suitable
period. Inactivity could be monitored in the timer callback. This guarantees
that if another unit of data arrives before the timer expiration, the peripheral
is still in its operational power state. </p>

<ul>
<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-D72B1509-0CFD-55D2-B4D3-84A6130AC3C8"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-D72B1509-0CFD-55D2-B4D3-84A6130AC3C8"><!-- --></a><p> <a href="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC.html#GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1817A738-2351-526F-881D-7EB479E93C4C">Peripheral Power States</a> </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-C6CAE535-2406-53FF-85C6-18552831DB94"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-C6CAE535-2406-53FF-85C6-18552831DB94"><!-- --></a><p> <a href="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC.html#GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1E31C6B9-6F69-50C5-908A-BCC648D4D8B1">Peripheral standby</a> </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-36E6FC1E-C3E8-5A78-AF77-D54486719BFF"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-36E6FC1E-C3E8-5A78-AF77-D54486719BFF"><!-- --></a><p> <a href="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC.html#GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-DCB8EA90-9B5F-5BA1-8D22-124980AC6B34">Moving peripherals to a low power state</a> </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-927DF4E2-18A3-51B5-9A46-02C63013954C"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-927DF4E2-18A3-51B5-9A46-02C63013954C"><!-- --></a><p> <a href="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC.html#GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-81231D49-0F35-582D-BDB3-DC1A08C2E448">High latency low power states and non-transparent transitions</a> </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-9DC49460-BE85-5979-B52D-DB6AC7E218D5"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-9DC49460-BE85-5979-B52D-DB6AC7E218D5"><!-- --></a><p> <a href="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC.html#GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-CA1BB80F-5A1C-5B66-8091-84625A0A9CFB">Peripheral power state diagram and transitions</a> </p>
 </li>

</ul>

<div class="section" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1817A738-2351-526F-881D-7EB479E93C4C"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1817A738-2351-526F-881D-7EB479E93C4C"><!-- --></a><h2 class="sectiontitle">Peripheral
Power States</h2> <p>It is possible that a particular ASSP allows peripheral
hardware blocks to be independently transitioned to a low power state. From
the point of view of power consumption, the base port might consider that
those peripherals have three logical power states: </p>
 <ul>
<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-49BC931A-15BE-5AC3-8F8F-1C3EFBFC0806"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-49BC931A-15BE-5AC3-8F8F-1C3EFBFC0806"><!-- --></a><p> <em>Operational Power</em> –
the peripheral is either processing some request, or performing a background
task with data transactions to or from it, or the peripheral is being kept
in this state in anticipation that data will be input to it, and is drawing
an amount of power corresponding to one of its possible modes of operation. </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-93AA050E-44F7-5B73-A8A2-4F70A2067E42"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-93AA050E-44F7-5B73-A8A2-4F70A2067E42"><!-- --></a><p> <em>Low Power</em> –
the peripheral is “idling” after a period of inactivity has been detected,
drawing a minimal amount of power required to preserve its internal state.
The peripheral should be able to keep its internal state and transition from
this to the Operational Power state with a negligible delay and with no impact
on the performance of either the peripheral driver or the upper layer components
that use it. </p>
 </li>

<li id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-8A39F42D-B928-5DE2-B79A-A1EABBF696E4"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-8A39F42D-B928-5DE2-B79A-A1EABBF696E4"><!-- --></a><p> <em>Off</em> – the peripheral
power has been cut off, and only leakage accounts for power consumption. No
state is preserved and the delay to a return to full power is not negligible. </p>
 </li>

</ul>
 <p>Note that peripheral power states are a notion that only applies
to the peripheral hardware block, and not to the driver. The peripheral driver
is the component that requests the peripheral to transition between these
states. </p>
 <p>Note also that both Operational and Low Power states are subsets
of the Peripheral "Active" state. In some cases the differences in power consumption
between the Operational and Low Power modes might not be significant as, with
some hardware, only part of the peripheral needs to be operational to service
a particular type of request. </p>
 </div>

<div class="section" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1E31C6B9-6F69-50C5-908A-BCC648D4D8B1"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-1E31C6B9-6F69-50C5-908A-BCC648D4D8B1"><!-- --></a><h2 class="sectiontitle">Peripheral
standby</h2> <p>Some ASSPs make provision for a peripheral standby mode,
where individual peripherals can be transitioned to a low power consumption
mode of operation under software control, usually by writing to an ASIC internal
register. </p>
 <p>If the peripheral is capable of keeping its internal state,
and the transition out of this mode is either done automatically on hardware,
or controlled by software, but has no impact on the performance of the peripheral
driver or on the users of this peripheral, and can be done with negligible
delay, then the peripheral standby mode could be considered a low power state
as above. </p>
 </div>

<div class="section" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-DCB8EA90-9B5F-5BA1-8D22-124980AC6B34"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-DCB8EA90-9B5F-5BA1-8D22-124980AC6B34"><!-- --></a><h2 class="sectiontitle">Moving peripherals
to a low power state</h2> <p>It is assumed that peripherals can be transitioned
between power states under the peripheral driver's software control. However,
transitioning peripherals to a low power state should only be performed if
it can be done transparently to the users and consumers of the services provided
by that peripheral. Negligible interactive delays may be acceptable, data
loss is not acceptable. </p>
 <p>The transition of a peripheral to a low power
state can be requested by the platform-dependent layers of that peripheral
driver after inactivity, as defined above, has been detected. That request
usually assumes the form of a request to turn a controllable power resource
off. The request should be handled by the ASSP/Variant component that manages
platform power resources (the resource manager). </p>
 <p>It can also assume
the form of an operation required to put the peripheral in standby mode. In
this case the peripheral driver is totally responsible for handling the transition
to the low power state. </p>
 </div>

<div class="section" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-81231D49-0F35-582D-BDB3-DC1A08C2E448"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-81231D49-0F35-582D-BDB3-DC1A08C2E448"><!-- --></a><h2 class="sectiontitle">High latency
low power states and non-transparent transitions</h2> <p>This guide is
only concerned with peripheral low power states that can be reached and left
with no impact on system performance. However, it is possible that transitions
to and from a peripheral low power state are long enough to have an impact
on system performance, or cause loss of data, or the peripheral is not capable
of detecting the hardware events required to guarantee correct operation while
in a low power state. If this is the case, then the decision to transition
to a low power state cannot be taken solely by the peripheral driver, and
will have to be taken in agreement with the users and consumers of the services
provided by this peripheral. </p>
 </div>

<div class="section" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-CA1BB80F-5A1C-5B66-8091-84625A0A9CFB"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-CA1BB80F-5A1C-5B66-8091-84625A0A9CFB"><!-- --></a><h2 class="sectiontitle">Peripheral
power state diagram and transitions</h2> <div class="fignone" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-A1F2E1D2-FA3B-55C3-B7A3-1AECBDC37453"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-A1F2E1D2-FA3B-55C3-B7A3-1AECBDC37453"><!-- --></a><span class="figcap">Figure 1. Peripheral power state diagram</span>

<img src="GUID-E55B594F-CC84-5984-9307-9819F6EBEB7F_d0e393592_href.png"/>
</div>
 <p>It can be assumed that when the peripheral driver is loaded, the
peripheral is put into the <em>Low Power</em> state. If a new request is asserted
on that peripheral driver from a user of that peripheral (which can include
another dependent peripheral driver or user side Engine/server/application),
the peripheral should move to its <em>Operational Power</em> state. The driver
can then start monitoring for peripheral inactivity, and when that is detected,
and no other dependent peripheral is using this peripheral, it can move the
peripheral back to the <em>Low Power</em> state. </p>
 <p>If, however, the power
manager requests the driver to power down the peripheral and no other dependent
peripheral is using it, it then moves into its <em>Off</em> state from which
it can only return to the <em>Operational Power</em> state when the power manager
issues a power up request. Moving from the <em>Off</em> state to the <em>Operational
Power</em> state is a relatively lengthy operation and requires resetting the
internal state of the peripheral. </p>
 <p>If another dependent peripheral
is using this peripheral, and the power manager issues a power down request,
then the driver keeps the peripheral in its operational power state until
the dependent peripheral relinquishes its request on it. </p>
 <p>From the <em>Low
Power</em> state, a peripheral can also be turned Off (unconditionally) if
the power manager so requests. It can be moved back to the <em>Operational
Power</em> state on an internal event (Interrupt, Timer). </p>
 <div class="fignone" id="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-C5AED7DE-18A1-5FBF-B1E4-44067F246CC2"><a name="GUID-1D3E61BD-C09D-51FD-A10B-22392FDAEFEC__GUID-C5AED7DE-18A1-5FBF-B1E4-44067F246CC2"><!-- --></a><span class="figcap">Figure 2. Peripheral power states</span>

<img src="GUID-EFEACBE5-B9E1-5315-88CA-DA3B7C1BFCE0_d0e393639_href.png"/>
</div>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html" title="This topic describes how to implement a power controller in a base port.">Power Management Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>