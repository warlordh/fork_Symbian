<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Specific Build Information"/>
<meta name="abstract" content="This document discusses the details of the build procedure which are specific to device drivers."/>
<meta name="description" content="This document discusses the details of the build procedure which are specific to device drivers."/>
<meta name="DC.Relation" scheme="URI" content="GUID-0F17BCDF-CF50-40D1-9048-793DC4442B50.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F78B7BF9-5FDD-4EF8-A921-71CCBB830A99.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C22974D8-CFB9-4A83-BE58-CCC97EA8DF13.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0F17BCDF-CF50-40D1-9048-793DC4442B50.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Specific Build Information</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5"><a name="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2387995 id2388032 id2388046 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-F78B7BF9-5FDD-4EF8-A921-71CCBB830A99.html" title="The device driver framework and how to implement a device driver.">Device Driver Guide</a> &gt; <a href="GUID-C22974D8-CFB9-4A83-BE58-CCC97EA8DF13.html" title="This set of documents explains how to write a device driver.">Device Driver Writing Guide</a> &gt; <a href="GUID-0F17BCDF-CF50-40D1-9048-793DC4442B50.html" title="This set of documents describes the device driver development process and provides links to example material.">Introduction</a> &gt; </div>
<h1 class="topictitle1">Specific
Build Information</h1>
<div><p>This document discusses the details of the build procedure which
are specific to device drivers.</p>

<div class="section" id="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-093E4B03-8B84-4088-BEC9-9F6E09594E6D"><a name="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-093E4B03-8B84-4088-BEC9-9F6E09594E6D"><!-- --></a><h2 class="sectiontitle">Building
device drivers</h2>              <p>Building a device driver is similar to building
any other component in Symbian platform. This section discusses the details
that are specific to drivers, and assumes that you are familiar with the Symbian
platform build tools. </p>
 <p>Device drivers can be built either by using
console commands (<span class="filepath">bldmake</span> and <span class="filepath">abld</span>)
or by using an IDE. Any project can be built for multiple platforms. Generally,
it is either ARM for the hardware target or WINSCW for the emulator target.
For hardware target builds, the build can be for ARMV5, ARMV6, and Thumb,
while for emulator builds, the platform is WINSCW. The compilers used for
ARM are the ARM RVCT compiler or, in earlier versions of the platform,
a version of the GNU GCC compiler. For the emulator, the compiler is the Carbide.c++
or Metrowerks CodeWarrior compiler. </p>
 <p>The <span class="filepath">.mmp</span> file
(project file) specifies the source files to build and the platform for which
the target binary will be built. </p>
     </div>

<div class="section" id="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-E42B5D1E-5244-4A30-AA83-FB7331EE1934"><a name="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-E42B5D1E-5244-4A30-AA83-FB7331EE1934"><!-- --></a><h2 class="sectiontitle">Variant specific target </h2> <p>When a target is specified
using the keyword <samp class="codeph">VariantTarget()</samp>, the build tools generate
a unique name for the binary by adding the variant name. This allows separate
binaries to be created for each variant, and prevents the current binary being
overwritten. </p>
 <p>For example, if the target to be built is <span class="filepath">d_expio_ldd.ldd</span>,
then <span class="filepath">VariantTarget(d_expio_ldd,ldd)</span> would be specified
in the <span class="filepath">.mmp</span> file. If the project is then built for the <samp class="codeph">h4hrp</samp> variant,
the final target binary built is called <span class="filepath">_h4hrp_d_expio_ldd.ldd</span>. </p>
</div>

<div class="section" id="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-F78A81DF-5482-4D63-934D-33AB078B831C"><a name="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-F78A81DF-5482-4D63-934D-33AB078B831C"><!-- --></a><h2 class="sectiontitle">ROM image build</h2> <p>To include a driver in a ROM image,
the driver's files must be included in the corresponding obey files (<span class="filepath">.oby</span>).
In the base subsystem, the binaries are specified in <span class="filepath">.iby</span> files,
and the <span class="filepath">.iby</span> files are then included in <span class="filepath">.oby</span> files. </p>
 <p>For
example, to include a driver in the H4 text shell ROM image, it should be
included in <span class="filepath">kernel.iby</span>. This file is located in <span class="filepath">base\omap_hrp\h4\rom\</span>,
and exported to <span class="filepath">epoc32\rom\h4hrp</span>. Similarly for the TechView
ROM build, the relevant file is <span class="filepath">base_h4hrp.iby</span> file,
which is located in <span class="filepath">base\omap_hrp_h4\rom\</span>, and exported
to <span class="filepath">epoc32\rom\include</span>. An example from an <span class="filepath">.iby</span> file
is shown below: </p>
 <pre class="codeblock" id="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-2A6C74C8-050F-555C-8E50-C92169A513B2"><a name="GUID-AF245763-EB25-49BC-90DC-0BD5F2D22AA5__GUID-2A6C74C8-050F-555C-8E50-C92169A513B2"><!-- --></a>// .iby file

/**
##KMAIN## gets the path for e32
##BUILD## gets the build – udeb/urel according to build
##VARIANT gets the target from corresponding variant  
*/

device[VARID]=\EPOC32\RELEASE\##KMAIN##\##BUILD##\d_expio_ldd.ldd sys\bin\d_expio_ldd.ldd 

device[VARID]=\EPOC32\RELEASE\##KMAIN##\##BUILD##\_##VARIANT##_d_expio_pdd.pdd sys\bin\d_expio_pdd.pdd</pre>
 <p>On
building the test .inf files, test <span class="filepath">.iby</span> files will be
generated. This includes the newly added binaries in the <span class="filepath">.iby</span> file. </p>
 <p>After
building the drivers, a ROM can be built. Device driver and base developers
generally build text shell ROM images for development and testing. These can
be built using the <span class="filepath">rom</span> tool (from <span class="filepath">base\e32\rombuild</span>).
By default, the ROM image is generated in that directory. An alternate path
can also be specified. </p>
 <p>For example, for the H4HRP variant, a text
shell ROM image is built using: </p>
 <p><kbd class="userinput">rom –v=h4hrp –I=armv5 udeb</kbd> </p>
 <p>This
builds a ROM called <span class="filepath">H4HRPARMV5D.IMG</span>, which can then be
downloaded to target hardware and tested. </p>
 <p>To include base test programs
in a ROM image, the option <samp class="codeph">–type</samp> can be used. For example: </p>
 <p><kbd class="userinput">rom
–v=h4hrp –I=armv5 udeb –type=e32tests</kbd> </p>
 <p>This includes the
tests from <span class="filepath">base\e32test</span>. The tool uses as input a generated
or precompiled <span class="filepath">oby</span> file, which includes all the generated
test <span class="filepath">.iby</span> files. </p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-0F17BCDF-CF50-40D1-9048-793DC4442B50.html" title="This set of documents describes the device driver development process and provides links to example material.">Introduction</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>