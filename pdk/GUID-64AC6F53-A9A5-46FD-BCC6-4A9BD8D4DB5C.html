<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Compensating Sensor Data for Display Orientation"/>
<meta name="abstract" content="You can use the sensor data compensator APIs to correct the display and device orientation data."/>
<meta name="description" content="You can use the sensor data compensator APIs to correct the display and device orientation data."/>
<meta name="DC.Relation" scheme="URI" content="GUID-7FB1B44E-B3FF-4765-88E3-A7FDB4FA8413.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8C8CE42-E7C9-5AFC-86BC-B78F677F1B05.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E3ADCC42-ACFC-49FC-88FF-8196CE61014B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7FB1B44E-B3FF-4765-88E3-A7FDB4FA8413.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Compensating Sensor Data for Display Orientation</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2519078 id2519748 id2519914 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-F8C8CE42-E7C9-5AFC-86BC-B78F677F1B05.html" title="Device Services provides device specific services to control phone resources and establish remote controlled connection with the external devices. It also monitors the phone resources and provides stage shutdown mechanism.">Device Services Guide</a> &gt; <a href="GUID-E3ADCC42-ACFC-49FC-88FF-8196CE61014B.html" title="The Sensors Services collection provides Sensors Framework, which allows clients to request and receive sensor information from the different sensors on a device.">Sensor Services</a> &gt; <a href="GUID-7FB1B44E-B3FF-4765-88E3-A7FDB4FA8413.html" title="The Sensor Data Compensator provides APIs to correct sensor data based on device or display orientation">Sensor Data Compensator</a> &gt; </div>
<h1 class="topictitle1">Compensating
Sensor Data for Display Orientation</h1>
<div><p>You can use the sensor data compensator APIs to correct the display
and device orientation data.</p>

<div class="p" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-A7AAEFBD-92F7-4143-AF04-CB7604C63B12"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-A7AAEFBD-92F7-4143-AF04-CB7604C63B12"><!-- --></a><p>Before you begin
using the sensor data compensator APIs, you must do the following:</p>
<ol>
<li id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-A2F385CE-1902-42DB-91F0-6359174BD31B"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-A2F385CE-1902-42DB-91F0-6359174BD31B"><!-- --></a><p>Open a Sensor Channel
for communication. For details, see <a href="GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B.html#GUID-4B709839-8EEF-4AD2-9868-9AF0176B1E5B__GUID-30E6033F-E316-4BDB-AF22-2369463DF709">Using
Sensor Channels APIs</a></p>
</li>

<li id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-D7CC2C9C-ADA4-4C20-9F83-1D194778D1A9"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-D7CC2C9C-ADA4-4C20-9F83-1D194778D1A9"><!-- --></a><p>Implement the data listener
interface. For details see, <a href="GUID-BA0D9DA9-3B54-4964-A4D6-9ADA4DEB7231.html" title="You can implement a data listener to receive data from the sensors. Based on the data received, you can perform specific actions on the Symbian device. For example, if you receive information from the sensor about the distance between the device and the user then based on this information, you can disable or enable the loudspeaker mode on the Symbian device.">Receiving
Data from Sensors</a></p>
</li>

<li id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-34B18C12-F93C-4509-8E6F-4A0C2998ADB7"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-34B18C12-F93C-4509-8E6F-4A0C2998ADB7"><!-- --></a><p>Register as a listener
with any of the sensor types using an instance of <span class="parmname">CSensrvChannel</span>.</p>
</li>

<li id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-527FEDAB-FAF3-4A8B-BF58-D300C0DC04E8"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-527FEDAB-FAF3-4A8B-BF58-D300C0DC04E8"><!-- --></a><p>Ensure that the data
received from the sensor channel is not already compensated using the <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-1E9D960B-23C4-30DF-A184-7E978AC9AC1B"><span class="apiname">CSensrvChannel::GetPropertyL()</span></a> function,
as shown in the following example:</p>
<pre class="codeblock">// 'iChannel' contains an open channel
TSensrvProperty property;
TRAPD( err, iChannel-&gt;GetPropertyL( KSensrvPropIdChannelDataCompensation, KSensrvItemIndexNone, property ) );
if ( err == KErrNone &amp;&amp; property.PropertyType() == ESensrvIntProperty )
     {
     // Channel data is compensated, check the compensation type
     TInt compensationType;
     property.GetValue( compensationType );
     // 'compensationType' contains now a value from TSensorCompensationType enumeration declared in sensordatacompensationtypes.h
     }
else
     {
     // Channel data is not compensated
     }</pre>
<p>For more information, see <a href="GUID-83630B57-D842-4B60-8AF0-D2965251DE29.html" title="A sensor channel is associated with properties such as channel availability status, data transmission rate, data format and so on. Also, each field in the data type supplied by a sensor channel can have its own properties. The channel properties can be retrieved using the CSensrvChannel::GetPropertyL() and CSensrvChannel::GetAllPropertiesL() functions.">Retrieving
channel properties</a> .</p>
</li>

</ol>
           </div>

<div class="section" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-02653FE0-162F-46A1-A4BC-7DD48350432B"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-02653FE0-162F-46A1-A4BC-7DD48350432B"><!-- --></a>       <p>The sensor
data compensator APIs allows you to compensate sensor data values, based on:</p>
<ul>
<li><p>Display Orientation, when the display is changed from portrait to landscape.</p>
</li>

<li><p>Device Orientation, when the keyboard is opened, resulting in the display
being set at an angle to the keyboard. For example, N97.</p>
</li>

</ul>
     </div>

<a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-1-12-1-11-1-1-8-1-5-1-4-1-3-3"><!-- --></a><ol id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-1-12-1-11-1-1-8-1-5-1-4-1-3-3"><li class="stepexpand" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-9A69E5AD-E938-4092-A8C2-CB65C37C8962-GENID-1-12-1-11-1-1-8-1-5-1-4-1-3-3-1"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-9A69E5AD-E938-4092-A8C2-CB65C37C8962-GENID-1-12-1-11-1-1-8-1-5-1-4-1-3-3-1"><!-- --></a><span>Create an instance
of <span class="parmname">CSensorDataCompensator</span>.</span>
 <pre class="codeblock">iCompensator = CSensorDataCompensator::NewL(TSensrvAccelerometerAxisData::KDataTypeId,ESensorCompensateDeviceAndUIOrientation);</pre>

</li>
<li class="stepexpand" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-AE833279-71EA-43FC-AB2E-E4CFAF277A02"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-AE833279-71EA-43FC-AB2E-E4CFAF277A02"><!-- --></a><span>Use the <a href="GUID-D32C68EB-AB82-3C2D-98F1-280401FD1763.html#GUID-D32C68EB-AB82-3C2D-98F1-280401FD1763__GUID-A400CB98-7D89-323F-92A8-EE5D581BEFA4"><span class="apiname">CSensorDataCompensator::Compensate()</span></a> function
to correct the sensor data received from the following channel types and related
classes:</span>
 
<div class="tablenoborder"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-1726B6BF-D170-4769-8E98-21BA6318E95F"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-1726B6BF-D170-4769-8E98-21BA6318E95F" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" id="d967367e120">Sensor Channel Type</th>

<th class="cellrowborder" valign="top" id="d967367e123">Data Class</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" headers="d967367e120 ">Accelerometer axis data</td>

<td class="cellrowborder" valign="top" headers="d967367e123 "><samp class="codeph">TSensrvAccelerometerAxisData</samp></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d967367e120 ">Magnetometer axis data</td>

<td class="cellrowborder" valign="top" headers="d967367e123 "><samp class="codeph">TSensrvMagnetometerAxisData</samp></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d967367e120 ">Accelerometer double-tap</td>

<td class="cellrowborder" valign="top" headers="d967367e123 "><samp class="codeph">TSensrvTappingData</samp></td>

</tr>

</tbody>

</table>
</div>

</li>
</ol>

<div class="example"><h2 class="sectiontitle">Example</h2><p>The following example illustrates the usage
of sensor data compensator APIs to correct axis data received from accelerometer
sensor.</p>
<pre class="codeblock">#include &lt;sensordatacompensator.h&gt; // link against sensordatacompensator.lib

void CMyClass::ConstructL()

   {
   // iSensorChannel already instantiated and registered
   if ( !AlreadyCompensated() )
          {
          iCompensator = CSensorDataCompensator::NewL( 
          TSensrvAccelerometerAxisData::KDataTypeId, 
           ESensorCompensateDeviceAndUIOrientation );
          }
   }

CMyClass::~CMyClass()

   {
   delete iCompensator;
   }

void CMyClass::DataReceived( CSensrvChannel&amp; aChannel,

                            TInt /*aCount*/, 
                            TInt /*aDataLost*/ )
   {
    
   TPckgBuf  &lt;TSensrvAccelerometerAxisData&gt; dataBuf;
   iSensorChannel -&gt; GetData( dataBuf );

   if ( iCompensator )
       {
       if ( iCompensator-&gt;Compensate( dataBuf ) == KErrNone )
           {
           // Now use the compensated data.
           }
       }</pre>
</div>

<div class="section" id="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-F834E8DF-C906-43E9-B49B-9B0ACB116E9B"><a name="GUID-64AC6F53-A9A5-46FD-BCC6-4A9BD8D4DB5C__GUID-F834E8DF-C906-43E9-B49B-9B0ACB116E9B"><!-- --></a><p>End the session
with the sensor channel using the <a href="GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844.html#GUID-22DC917F-D833-3531-AB2D-A6E2D52EF844__GUID-0B8F50A6-2CA1-316A-82AB-AA026005E810"><span class="apiname">CSensrvChannel::CloseChannel()</span></a> function.</p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-7FB1B44E-B3FF-4765-88E3-A7FDB4FA8413.html" title="The Sensor Data Compensator provides APIs to correct sensor data based on device or display orientation">Sensor Data Compensator</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>