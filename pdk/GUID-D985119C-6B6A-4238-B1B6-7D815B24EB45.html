<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Defining a Privacy Controller Observer Class"/>
<meta name="abstract" content="To write a Privacy Controller a licensee must define a Privacy Controller observer class derived from MLbsPrivacyObserver (or MLbsPrivacyObserver2 for a Privacy Controller that must be automatically shutdown by the LBS subsystem when all privacy requests have completed. This is required when the LBS subsystem is configured and built in the Standalone Privacy Mode configuration)."/>
<meta name="description" content="To write a Privacy Controller a licensee must define a Privacy Controller observer class derived from MLbsPrivacyObserver (or MLbsPrivacyObserver2 for a Privacy Controller that must be automatically shutdown by the LBS subsystem when all privacy requests have completed. This is required when the LBS subsystem is configured and built in the Standalone Privacy Mode configuration)."/>
<meta name="DC.Relation" scheme="URI" content="GUID-3078D198-0FCB-58A0-8152-9CD319906D58.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-710BC22B-E4F0-5E16-B970-E2D21F5571FC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CE970F0F-C922-516F-9D7E-EA1F4754A205.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CDE5CC9D-F6DE-5A21-97C3-59A2F3398A15.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-63681C76-3E0A-5A7A-9723-93F4142A7E7E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3078D198-0FCB-58A0-8152-9CD319906D58.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D985119C-6B6A-4238-B1B6-7D815B24EB45"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Defining a Privacy Controller Observer Class</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-D985119C-6B6A-4238-B1B6-7D815B24EB45"><a name="GUID-D985119C-6B6A-4238-B1B6-7D815B24EB45"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2402671 id2402731 id2402745 id2402794 id2402803 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-710BC22B-E4F0-5E16-B970-E2D21F5571FC.html" title="The Location Request Management collection contains components that handle requests for location request information both from installed applications and from the network.">Location Request Management</a> &gt; <a href="GUID-CE970F0F-C922-516F-9D7E-EA1F4754A205.html" title="The Network Request Handler processes privacy and location requests received from the network.">Network Request Handler</a> &gt; <a href="GUID-CDE5CC9D-F6DE-5A21-97C3-59A2F3398A15.html" title="A privacy request is a request for permission to obtain the mobile device's location. Privacy requests are usually sent from the network to the mobile device as part of an MT-LR.">Privacy Requests</a> &gt; <a href="GUID-63681C76-3E0A-5A7A-9723-93F4142A7E7E.html" title="This section contains links to topics that explain how to create a Privacy Controller and Privacy Notifiers.">Privacy Request Tutorials</a> &gt; <a href="GUID-3078D198-0FCB-58A0-8152-9CD319906D58.html" title="This section gives guidance on how a Symbian platform licensee can use the LBS Privacy Controller API to create a Privacy Controller.">Using the Privacy Controller API</a> &gt; </div>
<h1 class="topictitle1">Defining
a Privacy Controller Observer Class</h1>
<div><p>To write a Privacy Controller a licensee must define a Privacy
Controller observer class derived from <samp class="codeph">MLbsPrivacyObserver</samp> (or <samp class="codeph">MLbsPrivacyObserver2</samp> for
a Privacy Controller that must be automatically shutdown by the LBS subsystem
when all privacy requests have completed. This is required when the LBS subsystem
is configured and built in the Standalone Privacy Mode configuration).</p>

<p>On startup the Privacy Controller must register itself with the LBS subsystem
by calling <a href="GUID-DA9AD188-944E-36C0-98A6-4F9B6FB2A091.html#GUID-DA9AD188-944E-36C0-98A6-4F9B6FB2A091__GUID-DB38D39A-780E-3F36-BD02-E770AC1C513B"><span class="apiname">CLbsPrivacyController::NewL()</span></a>, passing a reference
to its observer class as a parameter. This is explained in more detail in
the code examples later in this document. </p>

<p>The code below shows an outline declaration of two Privacy Controller observer
classes. </p>

<ul>
<li><p><samp class="codeph">CMyLbsPrivacyControllerObserver</samp> implements <a href="GUID-76C6B540-DCA5-33CB-9ABD-8951A2F1DD5D.html"><span class="apiname">MLbsPrivacyObserver</span></a>. </p>
</li>

<li><p><samp class="codeph">CMyLbsPrivacyControllerObserver2</samp> implements <samp class="codeph">MLbsPrivacyObserver2</samp> to
receive a shutdown notification when the LBS subsystem is shutdown down in
the Standalone Privacy Mode configuration. </p>
</li>

</ul>

<div class="note"><span class="notetitle">Note:</span> It is only necessary to create one observer class for the Privacy Controller
and it is only necessary to derive from <a href="GUID-BF88837F-1ADC-3DB2-98E5-CFBF75E2BE86.html"><span class="apiname">MLbsPrivacyObserver2</span></a> if
the licensee Privacy Controller process lifecycle must be controlled by the
LBS subsystem. This is only supported when the LBS subsystem is built in the <a href="GUID-3618ECE9-C22B-5AE2-837E-FEBC55D42330.html" title="This document describes the steps necessary to configure the LBS subsystem with the Privacy Protocol Module.">Standalone Privacy Mode</a> configuration.</div>

<pre class="codeblock">/*
============================================================================
 Name		: MyLBSPrivacyController.h
 Description : Header file for example Privacy Controller
============================================================================
*/

#ifndef __MYLBSPRIVACYCONTROLLER_H__
#define __MYLBSPRIVACYCONTROLLER_H__


//  Include Files
#include &lt;e32base.h&gt;
#include &lt;lbsloccommon.h&gt;
#include &lt;lbsprivacycontroller.h&gt;

// Simple Privacy Controller class
class CMyLbsPrivacyControllerObserver : public CBase, MLbsPrivacyObserver
	{
	public:
		static CMyLbsPrivacyControllerObserver* NewL();
		~CMyLbsPrivacyControllerObserver();
	
	public:
		// From MLbsPrivacyObserver
		void ProcessNetworkLocationRequest(TUint aRequestId, const TLbsExternalRequestInfo&amp; aRequestInfo,
                                     const TNotificationType&amp; aNotifyType);
		void ProcessNetworkPositionUpdate(TUint aRequestId, const TPositionInfo&amp; aPosInfo);
		void ProcessRequestComplete(TUint aRequestId, TInt aReason);
		
		// Functions to send privacy response or cancel a privacy request
		void SendResponse(TUint aRequestId, CLbsPrivacyController::TRequestVerificationResult aResult);
		void CancelRequest(TUint aRequestId);
		
	
	protected:
		CMyLbsPrivacyControllerObserver();
		void ConstructL();
		
	private:
		CLbsPrivacyController* iController;
	};


// Privacy Controller class that can receive shutdown notification from LBS Root
class CMyLbsPrivacyControllerObserver2 : public CMyLbsPrivacyControllerObserver, MLbsPrivacyObserver2
	{
	public:
		// From MLbsPrivacyObserver2
		void ProcessCloseDownNotification();
	};


#endif  // __MYLBSPRIVACYCONTROLLER_H__</pre>

<p>Note that the observer class contains a member variable of class <a href="GUID-DA9AD188-944E-36C0-98A6-4F9B6FB2A091.html"><span class="apiname">CLbsPrivacyController</span></a> which
is used to register the Privacy Controller with the LBS subsystem and to return
privacy responses.</p>

<div class="section" id="GUID-D985119C-6B6A-4238-B1B6-7D815B24EB45__GUID-8B002BCC-5B26-46CD-B4BB-D42A8A43BE28"><a name="GUID-D985119C-6B6A-4238-B1B6-7D815B24EB45__GUID-8B002BCC-5B26-46CD-B4BB-D42A8A43BE28"><!-- --></a><h2 class="sectiontitle">Registering the Privacy Controller with the LBS subsystem</h2> 
     <p>The code below shows how a Privacy Controller can register itself
with LBS in order to receive privacy requests. The <samp class="codeph">ConstructL()</samp> method
calls <a href="GUID-DA9AD188-944E-36C0-98A6-4F9B6FB2A091.html#GUID-DA9AD188-944E-36C0-98A6-4F9B6FB2A091__GUID-DB38D39A-780E-3F36-BD02-E770AC1C513B"><span class="apiname">CLbsPrivacyController::NewL()</span></a>, which registers the
Privacy Controller with the LBS subsystem. </p>
<pre class="codeblock">CMyLbsPrivacyControllerObserver* CMyLbsPrivacyControllerObserver::NewL()
	{
	CMyLbsPrivacyControllerObserver* self = new (ELeave) CMyLbsPrivacyControllerObserver();
	CleanupStack::PushL(self);
	self-&gt;ConstructL();
	CleanupStack::Pop();
	return self;
	}

// Register this observer class with the LBS subsystem
void CMyLbsPrivacyControllerObserver::ConstructL()
 {
 // Store a pointer to the LBS subsystem Privacy Controller handler
 // This is used by this observer to return privacy responses
 iController = CLbsPrivacyController::NewL(*this);
 }</pre>
     </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-3078D198-0FCB-58A0-8152-9CD319906D58.html" title="This section gives guidance on how a Symbian platform licensee can use the LBS Privacy Controller API to create a Privacy Controller.">Using the Privacy Controller API</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>