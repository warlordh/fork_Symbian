<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Power Management"/>
<meta name="abstract" content="The kernel provides a framework for managing power within the system, and the management of the transition between power states."/>
<meta name="description" content="The kernel provides a framework for managing power within the system, and the management of the transition between power states."/>
<meta name="DC.Relation" scheme="URI" content="GUID-A16F9F31-182E-5301-B228-A457BD3530FE.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A91C6359-E547-51AD-AA8C-45BCAFBA98AC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A16F9F31-182E-5301-B228-A457BD3530FE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E09E4418-4DC3-56A3-BFBE-486C9C8D25C9.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6E1DE1E4-1B09-541C-8708-9126E69B42CE.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-0C435514-EEC6-5660-BB5F-535790349632"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Power Management</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-0C435514-EEC6-5660-BB5F-535790349632"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2399872 id2399880 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-A91C6359-E547-51AD-AA8C-45BCAFBA98AC.html" title="EKA2 is the principal Hardware and Kernel Services module. It manages the CPU and memory resources of a phone, and provides an architecture for device drivers to manage other hardware resources.">Kernel Architecture (EKA2)</a> &gt; <a href="GUID-A16F9F31-182E-5301-B228-A457BD3530FE.html" title="Describes the architecture and technology features of the Kernel that are important for a base port.">Concepts</a> &gt; </div>
<h1 class="topictitle1">Power Management</h1>
<div><p>The kernel provides a framework for managing power within
the system, and the management of the transition between power states. </p>

<p>The kernel-side framework manages the transition between power
states on the device. A base port can implement a kernel extension
to interface to the power management hardware that is provided on
the phone. The framework also provides an interface for device drivers
to use the power </p>

<p>The user-side interface to the framework is provided by the Power
class in the User Library. This allows applications can be notified
about, and can react to, changes in power state, and indeed can initiate
changes to power state. The <a href="GUID-E09E4418-4DC3-56A3-BFBE-486C9C8D25C9.html" title="The Domain Manager also allows applications to find out about changes to the power state of the phone.">Domain Manager</a> component provides a way to manage the power needs and dependencies
of applications. </p>

<p>In Symbian platform, an initial port of the system does not require
the existence of a power model. In this sense it is optional, and
its absence will result in default behaviour provided by Symbian platform.
However, this is not likely to result in optimal power usage, so the
development of a power model based on the framework provided by Symbian
platform will be required for commercial devices. </p>

<p>The interfaces for power management on the kernel-side are shown
in the following diagram: </p>

<div class="fignone" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-4020768D-7FDF-58EC-82A7-F98E259046D0"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-4020768D-7FDF-58EC-82A7-F98E259046D0"><!-- --></a>
<img src="GUID-782E8D92-0431-50F5-95A0-5B231EBDF391_d0e380621_href.png"/>
</div>

<ul>
<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-4E59C261-2025-5402-9EE1-EBC50BCD409F"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-4E59C261-2025-5402-9EE1-EBC50BCD409F"><!-- --></a><p>The power manager
manages the transition between power states. </p>
 </li>

<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-B3CD4688-45D0-5F46-A968-2DDD76ABB9B7"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-B3CD4688-45D0-5F46-A968-2DDD76ABB9B7"><!-- --></a><p>The power controller
is a kernel extension that manages the device-specific power management
hardware such as an on-chip power management controller, oscillators
etc. The power controller kernel extension is provided in the base
port. </p>
 </li>

<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-07CBC9E9-7A2E-5BB5-95F6-1ECF36B502ED"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-07CBC9E9-7A2E-5BB5-95F6-1ECF36B502ED"><!-- --></a><p>Power handlers
are device drivers that interface to the power manager. </p>
 </li>

</ul>

<p>The following sections describes these concepts in more detail. </p>

<div class="section" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-330F07B2-BBDF-5675-B7D5-FF6B25DD03F4"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-330F07B2-BBDF-5675-B7D5-FF6B25DD03F4"><!-- --></a><h2 class="sectiontitle">Power
manager</h2> <p>The power manager manages the transition between
power states. It co-ordinates the change in the power state of peripherals
and the CPU (hardware), and provides the necessary interactions with
the device (peripheral) drivers and the power controller (software).
It also manages interactions with the user-side model. </p>
 <p>The
power manager is an instance of the <samp class="codeph">DPowerManager</samp> class, an object that is private to Symbian platform. This object
is created when the system is initialised, but is not installed as
the power manager until the <a href="GUID-0C435514-EEC6-5660-BB5F-535790349632.html#GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-07F53484-4727-5338-9320-DF6A0BB440E4">power controller</a> has been created and registered. Until the <samp class="codeph">DPowerManager</samp> object is installed as the system's power
manager, Symbian platform manages power using built-in default behaviour. </p>
 <p>The user-side uses the <a href="GUID-15D25C07-CFD2-32CE-AD22-E17D512D8E87.html"><span class="apiname">Power</span></a> class, a set
of static functions, as an interface to the power manager. This allows
the user side to request a transition to the <em>Standby</em> or <em>Off </em> state, and to request notification of wake-up events, i.e.
events that will cause a transition back to the <em>Active</em> state. </p>
 <p>The power manager object is the anchor point for the power controller
object and the power handler objects. </p>
 </div>

<div class="section" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-07F53484-4727-5338-9320-DF6A0BB440E4"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-07F53484-4727-5338-9320-DF6A0BB440E4"><!-- --></a><h2 class="sectiontitle">Power
controller</h2> <p>The power controller manages the device-specific
power management hardware such as an on-chip power management controller,
oscillators etc. </p>
 <p>The power controller is an instance of a <a href="GUID-B3D1C422-6A82-3C6E-9123-1E4F598F0366.html"><span class="apiname">DPowerController</span></a> class. This is an abstract class that
requires an implementation . A concrete implementation supports power
management hardware that is Variant specific. Typically, the Variant
creates a power controller object when the Variant is initialised,
and then registers it with the power manager through a call to <a href="GUID-B3D1C422-6A82-3C6E-9123-1E4F598F0366.html#GUID-B3D1C422-6A82-3C6E-9123-1E4F598F0366__GUID-F66D72D0-AA27-3BAF-8915-C6E8CC4E7CCF"><span class="apiname">DPowerController::Register()</span></a>. Registration puts a pointer
to the <samp class="codeph">DPowerController</samp> object into the Symbian platform
internal <samp class="codeph">DPowerManager</samp> object. </p>
 <p>The power
controller is responsible for tracking wake-up events, notifying the
power manager of such events through a call to <a href="GUID-B3D1C422-6A82-3C6E-9123-1E4F598F0366.html#GUID-B3D1C422-6A82-3C6E-9123-1E4F598F0366__GUID-3524A807-F4A9-3DE4-918A-0C03BE0D1AEF"><span class="apiname">DPowerController::WakeUpEvent()</span></a>. </p>
 <div class="fignone" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-7BBCE70B-381C-5E65-83CF-498B2C6D15DA"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-7BBCE70B-381C-5E65-83CF-498B2C6D15DA"><!-- --></a>
<img src="GUID-9D8C62FB-1E42-5B69-8ECC-2B68AD7C71A5_d0e380717_href.png"/>
</div>
 </div>

<div class="section" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-DC5F1ECD-CCA3-59FF-A2F1-A3DBD76CD458"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-DC5F1ECD-CCA3-59FF-A2F1-A3DBD76CD458"><!-- --></a><h2 class="sectiontitle">Power
handlers</h2> <p>Device drivers interface to the power manager
through the <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html"><span class="apiname">DPowerHandler</span></a> class. This is an abstract
class that requires a concrete implementation by device (peripheral)
drivers. </p>
 <p>How a <samp class="codeph">DPowerHandler</samp> object fits
into a driver's own object model is a matter of individual device
driver design. However, after construction of this object, the driver
is expected to register it with the power manager by calling <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html#GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7__GUID-E8353DF6-B21B-383F-99AB-94B6B5139E47"><span class="apiname">DPowerHandler::Add()</span></a>, after which it will receive notification
of changes to the power state. </p>
 <p>The power manager calls <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html#GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7__GUID-578DB5FB-731D-36B2-A459-AAC7F250D726"><span class="apiname">DPowerHandler::PowerDown()</span></a> when it requests a power state
transition to either the <em>Off</em> or the <em>Standby</em> state. The
power manager calls <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html#GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7__GUID-DDC564B4-BD12-30E9-B04A-DBA6CFAF8743"><span class="apiname">DPowerHandler::PowerUp()</span></a> when
it requests a power state transition to the <em>Active</em> state. The
driver must respond to a power transition notification after it has
dealt with it by calling <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html#GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7__GUID-BF62042B-FB7B-3D5B-8379-490FBA284A7A"><span class="apiname">DPowerHandler::PowerUpDone()</span></a> or <a href="GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7.html#GUID-761AE02B-41A6-35EA-AA9F-0AEEFF67A6F7__GUID-EBE8CFF8-50BD-3AC3-A4C8-47094DA5674D"><span class="apiname">DPowerHandler::PowerDownDone()</span></a> as appropriate. </p>
 <div class="fignone" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-5A5E8846-DE8A-50FC-9D0E-8D8E88291835"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-5A5E8846-DE8A-50FC-9D0E-8D8E88291835"><!-- --></a>
<img src="GUID-1BB379B6-C0B5-5099-90A0-1BA39DC2C7DD_d0e380772_href.png"/>
</div>
 </div>

<div class="section" id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-8062EF29-9CE3-5414-9DE2-E494F48F0CFB"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-8062EF29-9CE3-5414-9DE2-E494F48F0CFB"><!-- --></a><h2 class="sectiontitle">Shared
power sources</h2> <div class="note"><span class="notetitle">Note:</span> <p>See the <a href="GUID-2ECF13A1-9D56-5740-A09F-8267E6A45DD9.html" title="This tutorial describes how to port the Platform Specific Layer (PSL) of the Power Resource Manager (PRM) and how to modify clients, such as device drivers, to use the PRM framework.">Power Resource Manager</a> documentation for more information. </p>
</div>
 <p>The set of power sources on a device, how they are connected to peripherals,
and their power states are totally dependent on the specific device.
This means that Symbian platform cannot provide a comprehensive API
for handling such sources. </p>
 <p>However, Symbian platform does
provide an interface, <a href="GUID-10105403-AF16-3908-AE9E-96CF2A03AD3A.html"><span class="apiname">MPowerInput</span></a>, through which
drivers register their use of a power source and their release of
that power source. Symbian platform makes the following recommendations: </p>
 <ul>
<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-D1B32CB8-E3EF-532C-9771-D5B9CFE3C5DD"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-D1B32CB8-E3EF-532C-9771-D5B9CFE3C5DD"><!-- --></a><p>Each (shared)
power source is represented by a separate object. </p>
 </li>

<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-AA47D3A2-8F3A-5D7D-AB41-8658FF5C9260"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-AA47D3A2-8F3A-5D7D-AB41-8658FF5C9260"><!-- --></a><p>The class, or
class hierarchy, that represents the power source should implement
the <samp class="codeph">MPowerInput</samp> interface so that device (peripheral)
drivers can register their use or their release of that power source. </p>
 </li>

<li id="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-017BC38F-1207-52B8-8B35-D38F66849FC6"><a name="GUID-0C435514-EEC6-5660-BB5F-535790349632__GUID-017BC38F-1207-52B8-8B35-D38F66849FC6"><!-- --></a><p>Define a custom
interface with the power controller. It is likely that the Variant
will be responsible for providing the implementation for the power
inputs, and for providing this custom interface. </p>
 </li>

</ul>
 <p>Drivers that need power from a specific power source call <a href="GUID-10105403-AF16-3908-AE9E-96CF2A03AD3A.html#GUID-10105403-AF16-3908-AE9E-96CF2A03AD3A__GUID-2BCA5312-43D9-3763-9636-3B2EB046D2C1"><span class="apiname">MPowerInput::Use()</span></a> on the object that represents that power
source. To release dependence on that power source, the driver calls <a href="GUID-10105403-AF16-3908-AE9E-96CF2A03AD3A.html#GUID-10105403-AF16-3908-AE9E-96CF2A03AD3A__GUID-606ECD77-A5F7-3408-9B63-C68C0A7B73C6"><span class="apiname">MPowerInput::Release()</span></a>. </p>
 <p>To represent a shared power
source, a suggested implementation of <samp class="codeph">MPowerInput</samp> might be to associate a counting value with the power source object.
A call to <samp class="codeph">Use()</samp> would increment the counter, while
a call to <samp class="codeph">Release()</samp> would decrement it. On construction
of the object, the initial value might be 0, indicating that no peripherals
require power from this source. A value of 1 or higher would indicate
that one or more peripherals require power from this source. The implementation
would, therefore, cause this power source to be kept on while at least
one peripheral needs it; the power source would only be switched off
when no peripherals need power from it. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-A16F9F31-182E-5301-B228-A457BD3530FE.html" title="Describes the architecture and technology features of the Kernel that are important for a base port.">Concepts</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-E09E4418-4DC3-56A3-BFBE-486C9C8D25C9.html" title="The Domain Manager also allows applications to find out about changes to the power state of the phone.">Domain
Manager</a></div>
<div><a href="GUID-3773A78D-F491-52EB-AA1D-201636497F28.html" title="This topic describes how to implement a power controller in a base port.">Power
Management Tutorials</a></div>
<div><a href="GUID-6E1DE1E4-1B09-541C-8708-9126E69B42CE.html" title="Describes the Power Resource Manager.">Power
Resource Manager (PRM)</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>