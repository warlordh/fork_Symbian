<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Inquiring about Remote Devices"/>
<meta name="abstract" content="Describes how to inquire about remote devices."/>
<meta name="description" content="Describes how to inquire about remote devices."/>
<meta name="DC.Relation" scheme="URI" content="GUID-58F65411-CF08-5F46-8222-3FDB9E571FCC.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DD13AA8E-BDAD-57EC-81EC-49C8D6D30A86.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6CE12919-FF81-5254-BA12-385F589FEA44.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5FE7D4DB-B853-57C4-8A90-16DF92F6231A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-58F65411-CF08-5F46-8222-3FDB9E571FCC.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Inquiring about Remote Devices</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2535271 id2535486 id2535569 id2535577 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-DD13AA8E-BDAD-57EC-81EC-49C8D6D30A86.html" title="The Short Link Services module enables licensees to implement Bluetooth, USB, Infrared and OBEX on Symbian platform devices.">Short Link Services Guide</a> &gt; <a href="GUID-6CE12919-FF81-5254-BA12-385F589FEA44.html" title="The Bluetooth Management collection contains the Bluetooth Manager and Bluetooth Client components.">Bluetooth Management Collection</a> &gt; <a href="GUID-5FE7D4DB-B853-57C4-8A90-16DF92F6231A.html">Bluetooth User Tutorials</a> &gt; <a href="GUID-58F65411-CF08-5F46-8222-3FDB9E571FCC.html">Connecting to remote devices</a> &gt; </div>
<h1 class="topictitle1">Inquiring
about Remote Devices</h1>
<div><p>Describes how to inquire about remote devices.</p>

<p>Now that you have decided on the best method of selecting a remote device
you will need to go through the process. For the purposes of this tutorial
we will assume you are going to allow the program to determine the remote
device with which to connect. </p>

<div class="section" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-2AE00E8E-3DC5-4AB3-9B85-5953BDC873BF"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-2AE00E8E-3DC5-4AB3-9B85-5953BDC873BF"><!-- --></a><h2 class="sectiontitle">How to inquire about remote devices</h2> <p>Each Bluetooth
device has a 48-bit unique address built into its hardware. A basic inquiry
for devices in range returns zero or more of these addresses. </p>
 <p>As well
as an address, a Bluetooth device has a text name suitable for display to
users. If you want to display a list of available devices to the user, you
will also need to obtain these names. </p>
 <p>The address and the name inquiries
can occur simultaneously, if the underlying hardware supports this. Otherwise,
the address inquiry must finish before the name request can be issued over
the air. </p>
 <p>Address and name inquiries are performed through the generic
Symbian platform sockets class <a href="GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD.html"><span class="apiname">RHostResolver</span></a>.
A specialist Bluetooth sockets address class, <a href="GUID-0ECE42E1-5E04-3BFB-BA17-F8036510798D.html"><span class="apiname">TInquirySockAddr</span></a>,
which encapsulates Bluetooth address, Inquiry Access Code, and service and
device classes, is provided for use with such inquiries. </p>
 <p><strong> Basic
Procedure</strong> </p>
 <p>To inquire for the addresses of remote devices, take
the following steps: </p>
 <a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B794CB43-DF26-5C9E-BABC-95E614B8225F"><!-- --></a><ol id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B794CB43-DF26-5C9E-BABC-95E614B8225F">
<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-20EDA9A2-9C57-55E2-B36D-117CFF923D49"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-20EDA9A2-9C57-55E2-B36D-117CFF923D49"><!-- --></a><p>Connect to the Sockets
Server (<a href="GUID-EF29C1D7-B1E5-370F-AE37-66231A6BE449.html"><span class="apiname">RSocketServ</span></a>), and then select the protocol to be
used using <a href="GUID-EF29C1D7-B1E5-370F-AE37-66231A6BE449.html#GUID-EF29C1D7-B1E5-370F-AE37-66231A6BE449__GUID-95B5BAA3-5A01-37F3-9C81-C5E71530B3B7"><span class="apiname">RSocketServ::FindProtocol()</span></a>. Address and name
queries are supplied by the stack's BTLinkManager protocol layer, so select
this. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-30F19EEC-CB83-53D4-99E6-84C68A2DED9C"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-30F19EEC-CB83-53D4-99E6-84C68A2DED9C"><!-- --></a><p>Create and initialise
an <a href="GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD.html"><span class="apiname">RHostResolver</span></a> object. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B2FD4AE2-A5DE-5EB4-A135-CDA502364550"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B2FD4AE2-A5DE-5EB4-A135-CDA502364550"><!-- --></a><p>Set the <samp class="codeph">TInquirySockAddr</samp> parameter
for the inquiry: for address inquiries, the <a href="GUID-75438E00-D211-3C94-A47D-61C5644A667D.html"><span class="apiname">KHostResInquiry</span></a> flag
must be set through <a href="GUID-0ECE42E1-5E04-3BFB-BA17-F8036510798D.html#GUID-0ECE42E1-5E04-3BFB-BA17-F8036510798D__GUID-E4E83FA5-3102-3CE8-8796-A70C017D4FC7"><span class="apiname">TInquirySockAddr::SetAction()</span></a>. </p>
 <p>The
query can then be started with <a href="GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD.html#GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD__GUID-B210BAF2-1D26-3F5A-8EBE-EF5B460A69E1"><span class="apiname">RHostResolver::GetByAddress()</span></a>. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-85980345-3E1A-5E10-A9F0-547DECBE52BB"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-85980345-3E1A-5E10-A9F0-547DECBE52BB"><!-- --></a><p>When <samp class="codeph">GetByAddress()</samp> completes,
it fills in a <a href="GUID-C625E339-6726-3FB9-8F8A-F4DB0CAC15FF.html"><span class="apiname">TNameEntry</span></a> object with the address and class
of the first device found (or is undefined if no device was found). </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B2FE92B6-989A-5A9F-92CB-9759587C31F8"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B2FE92B6-989A-5A9F-92CB-9759587C31F8"><!-- --></a><p>To get all the devices
discovered, call <a href="GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD.html#GUID-B16CAD6D-85B1-3482-AAC0-9BADEDB6ABDD__GUID-B64AB6BA-6D1D-30EB-88EF-381B52939F3D"><span class="apiname">RHostResolver::Next()</span></a> repeatedly until <samp class="codeph">KErrHostResNoMoreResults</samp> is
returned. </p>
 </li>

</ol>
 <p><strong>Getting
the addresses of remote devices</strong> </p>
 <p>The following example shows how
to start a remote device address inquiry. </p>
 <a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-A31D5876-7EE5-56B6-8F5A-7B8986C55349"><!-- --></a><ol id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-A31D5876-7EE5-56B6-8F5A-7B8986C55349">
<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B6BCA711-BBC7-52C0-9B7A-F128031346ED"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B6BCA711-BBC7-52C0-9B7A-F128031346ED"><!-- --></a><p>Connect to the socket
server </p>
 <pre class="codeblock" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9E81DC37-FFC5-5427-BC01-54DFD82ED929"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9E81DC37-FFC5-5427-BC01-54DFD82ED929"><!-- --></a>RSocketServ socketServ;
socketServ.Connect();
TProtocolDesc pInfo;
_LIT(KL2Cap, "BTLinkManager");
User::LeaveIfError(socketServ.FindProtocol(KL2Cap,pInfo));</pre>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-48A0FDB1-BB15-5759-8AC1-F837513B423A"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-48A0FDB1-BB15-5759-8AC1-F837513B423A"><!-- --></a><p>Create and initialise
an <samp class="codeph">RHostResolver</samp>  </p>
 <pre class="codeblock" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-221037A8-6A39-5C27-A0DD-2A2BD14E5A7F"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-221037A8-6A39-5C27-A0DD-2A2BD14E5A7F"><!-- --></a>RHostResolver hr;
User::LeaveIfError(hr.Open(socketServ,pInfo.iAddrFamily,pInfo.iProtocol));</pre>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-4A5D7DFC-FDFE-5D87-8DAB-A1BE59EFF806"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-4A5D7DFC-FDFE-5D87-8DAB-A1BE59EFF806"><!-- --></a><p>Set up a discovery query
and start it </p>
 <pre class="codeblock" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-DA8F9430-CDE6-5663-9DED-D897B134DEEF"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-DA8F9430-CDE6-5663-9DED-D897B134DEEF"><!-- --></a>TInquirySockAddr addr;
TNameEntry entry;
addr.SetIAC(KGIAC);
addr.SetAction(KHostResInquiry);
TRequestStatus status;
hr.GetByAddress(addr, entry, status);
User::WaitForRequest(status);</pre>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9835B54E-E6D2-5FD5-8E7C-1374177F2D8A"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9835B54E-E6D2-5FD5-8E7C-1374177F2D8A"><!-- --></a><p>Process the information
returned in <samp class="codeph">entry</samp>  </p>
 <pre class="codeblock" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-766A738A-2F2F-5570-964B-196FA45BA601"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-766A738A-2F2F-5570-964B-196FA45BA601"><!-- --></a>...</pre>
 </li>

</ol>
 <p><strong>Notes:</strong> </p>
 <ul>
<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-71BF7F7E-AD6E-5715-B9A5-BAE7488B9B80"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-71BF7F7E-AD6E-5715-B9A5-BAE7488B9B80"><!-- --></a><p> <a href="GUID-0ECE42E1-5E04-3BFB-BA17-F8036510798D.html#GUID-0ECE42E1-5E04-3BFB-BA17-F8036510798D__GUID-B8F50B34-789B-3ADE-8D1E-04B59394BC2A"><span class="apiname">TInquirySockAddr::SetIAC()</span></a> sets
the Bluetooth Inquiry Access Code. For more information, see <a href="http://www.bluetooth.org/assigned-numbers/" target="_blank">Bluetooth Assigned Numbers</a>. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B55A03AB-3F37-5377-80E6-5F94045A4C5F"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-B55A03AB-3F37-5377-80E6-5F94045A4C5F"><!-- --></a><p>The host resolver caches
the results of inquiries so that devices that are no longer present may appear
in the list of results. This does not cause any additional complications,
as it is always possible for a device to go out of range between when it is
discovered and when a connection to it is made. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-51CA2D0D-6A75-537F-A040-EA47D00DFEE0"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-51CA2D0D-6A75-537F-A040-EA47D00DFEE0"><!-- --></a><p>Communications API calls
are typically asynchronous (indicated by a <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html"><span class="apiname">TRequestStatus</span></a> parameter
in the call). It is recommended that such calls are encapsulated in active
objects, as explained in <a href="GUID-B507490F-6BD3-5DF5-97E4-EFDFEA2B4EDD.html">Using
Asynchronous Programming</a>. </p>
 </li>

</ul>
 <p><strong>Getting
the name of a remote device</strong> </p>
 <p>The name of a remote device can be
queried for by taking the same steps as for an address query, but setting
the action flag of a <samp class="codeph">TInquirySockAddr</samp> to <a href="GUID-8B748089-6177-3C64-8F54-C2F6E1C364F4.html"><span class="apiname">KHostResName</span></a>.
The name is returned in the <samp class="codeph">iName</samp> member accessed through
the <samp class="codeph">TNameEntry</samp>. </p>
 <p><strong>Example </strong> </p>
 <pre class="codeblock" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-F670B724-E96C-5077-9317-4A6F27CBFF67"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-F670B724-E96C-5077-9317-4A6F27CBFF67"><!-- --></a>// Now do name inquiry
addr.SetAction(KHostResName);
hr.GetByAddress(addr, entry, stat);
User::WaitForRequest(stat);
TPtrC deviceName;
if (stat == KErrNone)
     deviceName.Set(entry().iName);</pre>
 <p><strong>Notes </strong> </p>
 <ul>
<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-DB873994-76A6-5FE2-8B8D-00E0FD815DF2"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-DB873994-76A6-5FE2-8B8D-00E0FD815DF2"><!-- --></a><p>To do a simultaneous
address and name inquiry, use <samp class="codeph">SetAction(KHostResName|KHostResInquiry)</samp>. </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-5823E26F-BFE7-5745-A208-C51DECF21D14"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-5823E26F-BFE7-5745-A208-C51DECF21D14"><!-- --></a><p> <samp class="codeph">RHostResolver::GetByName()</samp> is
not supported </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-4425B269-2649-4A3C-81A4-17AB3733CF1C"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-4425B269-2649-4A3C-81A4-17AB3733CF1C"><!-- --></a><h2 class="sectiontitle">Where Next?</h2> <p>This tutorial set takes you through
all the steps involved in setting up and communicating over a Bluetooth connection. </p>
 <ul>
<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-78BDF706-7245-5D78-AB1D-8DB1352CFEAF"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-78BDF706-7245-5D78-AB1D-8DB1352CFEAF"><!-- --></a><p> <a href="GUID-301488F8-B6D8-569A-B05E-19B740FE4C00.html">Selecting
a Remote Device</a>  </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-65BD97CF-9CD6-5050-9B96-4B22124C7E0F"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-65BD97CF-9CD6-5050-9B96-4B22124C7E0F"><!-- --></a><p> <strong>Inquiring About
Remote Devices</strong> - This document </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-2418982B-074A-561F-AF89-C0A233F7C593"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-2418982B-074A-561F-AF89-C0A233F7C593"><!-- --></a><p> <a href="GUID-A13494B9-C1E4-506A-B236-8AE0A6D6D557.html">Inquiring
About Services on a Remote Device</a>  </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-3E09B7DF-5BD7-5FC7-9C09-245421BCA730"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-3E09B7DF-5BD7-5FC7-9C09-245421BCA730"><!-- --></a><p> <a href="GUID-A24D2CEF-88C9-5C63-A14D-85EFFBEF3C92.html" title="Once the device and service have been established, you can connect to the remote service and start using it.">Connecting
and Transferring Data to a Remote Device</a>  </p>
 </li>

<li id="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9AF0CBD6-3762-5724-82EF-88348D246CA1"><a name="GUID-CED041C8-D68D-55D1-957E-1A48EEFFF851__GUID-9AF0CBD6-3762-5724-82EF-88348D246CA1"><!-- --></a><p> <a href="GUID-4F0C4B9D-AA42-59C4-900A-7045FEAAF2F4.html">Using
security on outgoing sockets</a>  </p>
 </li>

</ul>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-58F65411-CF08-5F46-8222-3FDB9E571FCC.html">Connecting to remote devices</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>