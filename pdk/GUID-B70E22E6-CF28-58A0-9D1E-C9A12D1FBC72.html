<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Using RPointerArray&lt;class T&gt;"/>
<meta name="abstract" content="This document covers the issues involved in using a RPointerArray."/>
<meta name="description" content="This document covers the issues involved in using a RPointerArray."/>
<meta name="DC.Relation" scheme="URI" content="GUID-59DB0115-053A-5D23-8C40-E2428C096BBC.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2E085BAD-AAD7-5D1A-89A7-287EE42D1069.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E3F403EE-717B-5EA6-BC4E-6840097CAC10.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-59DB0115-053A-5D23-8C40-E2428C096BBC.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Using RPointerArray&lt;class T&gt;</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2392089 id2392251 id2392348 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-2E085BAD-AAD7-5D1A-89A7-287EE42D1069.html">Arrays And Lists</a> &gt; <a href="GUID-E3F403EE-717B-5EA6-BC4E-6840097CAC10.html">Using Dynamic Arrays</a> &gt; <a href="GUID-59DB0115-053A-5D23-8C40-E2428C096BBC.html">How to Use Dynamic Arrays</a> &gt; </div>
<h1 class="topictitle1">Using
RPointerArray&lt;class T&gt;</h1>
<div><p>This document covers the issues involved in using a RPointerArray.</p>

<div class="section" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-F7FD2F4C-A187-5289-B28D-1A7A40A7EF4B"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-F7FD2F4C-A187-5289-B28D-1A7A40A7EF4B"><!-- --></a><h2 class="sectiontitle">Freeing all
memory before the array goes out of scope</h2> <p>By convention, class
names starting with the letter <samp class="codeph">R</samp> do not allocate memory on
the heap. <samp class="codeph">RPointerArray&lt;class T&gt;</samp> is an <em>exception</em> and
this should be remembered when using the class. </p>
 <p>If an array is declared
on the program stack, then its <samp class="codeph">Close()</samp> or <samp class="codeph">Reset()</samp> member
function must be called to ensure that allocated memory is freed. </p>
 <p>Similarly,
if <samp class="codeph">RPointerArray&lt;class T&gt;</samp> is a data member of another
class, then the destructor of that class must call <samp class="codeph">Close()</samp> or <samp class="codeph">Reset()</samp>. </p>
 <p>Another
issue to remember is the ownership of objects whose pointers are contained
within an <samp class="codeph">RPointerArray&lt;class T&gt;</samp> array. If ownership of
the objects lies elsewhere, then calling <samp class="codeph">Close()</samp> or <samp class="codeph">Reset()</samp> before
the array goes out of scope is sufficient. If, however, ownership of these
objects is vested in the array, and it is the intention that these objects
be destroyed when the array is destroyed, then <samp class="codeph">ResetAndDestroy()</samp> must
be called before the array goes out of scope. </p>
 </div>

<div class="section" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-7CBFF894-9704-5018-A062-6EB2DC2D181A"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-7CBFF894-9704-5018-A062-6EB2DC2D181A"><!-- --></a><h2 class="sectiontitle">Packaging the
algorithm for ordering array objects</h2> <p>A <samp class="codeph">RPointerArray&lt;class
T&gt;</samp> array allows its contained pointers to be ordered so that the
objects themselves are in object order. The array provides the behaviour for
inserting and sorting instances of pointers to the template class. To help
with this, the template class must provide an algorithm for deciding how two
template class objects are ordered. This algorithm is implemented by a function
which must be wrapped in a <samp class="codeph">TLinearOrder&lt;class T&gt;</samp> package. </p>
 <p>The
function implementing the algorithm can be a static member of the class but
need not necessarily be so. </p>
 <p>Here, we aim to build an array of <samp class="codeph">CMyTest</samp> objects
ordered in a way which makes sense for the <samp class="codeph">CTMyTest</samp> class. </p>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-46BBDDDA-9AF5-5A1D-80B0-7F9441D1DBF8"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-46BBDDDA-9AF5-5A1D-80B0-7F9441D1DBF8"><!-- --></a>class CMyTest
 { 
public 
 ~CMyTest();
 Static CMytest* NewL(const TDesC&amp; aText);
 static TInt Compare(const CMyTest&amp; aFirst, const CMyTest&amp; Second);
public:
 HBufC* iText;
 };</pre>
 <p>In this example, the algorithm is implemented by a static
function called <samp class="codeph">Compare()</samp>. It takes const references to two <samp class="codeph">CMyTest</samp> objects
and returns zero if the objects are equal, a negative value if <samp class="codeph">aFirst</samp> is
less than <samp class="codeph">aSecond</samp> and a positive value if <samp class="codeph">aFirst</samp> is
greater than <samp class="codeph">aSecond</samp>. </p>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-FE525095-5A8F-52CB-A56C-6E0148011478"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-FE525095-5A8F-52CB-A56C-6E0148011478"><!-- --></a>TInt CMyTest::Compare(const CMyTest&amp; aFirst,const CMyTest&amp; aSecond)
 {
 TInt ret = (aFirst.iText)-&gt;Compare(*aSecond.iText);
 if (ret &gt; 0)
  return 1;
 if (ret &lt; 0)
  return -1;
 return 0;
 }</pre>
 <p>Construct three <samp class="codeph">CMyTest</samp> objects and then
construct an array object for an array of pointers to <samp class="codeph">CMyTest</samp> objects;
the array has default granularity. </p>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-DA86C3D4-1D9C-5FAD-B418-9EB65DECB045"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-DA86C3D4-1D9C-5FAD-B418-9EB65DECB045"><!-- --></a>_LIT(KTextOne,"First Text");
_LIT(KTextTwo,"Second Text");
_LIT(KTextThree,"Third Text");
...
CMyTest* one   = CMyTest::NewL(KTextOne);
CMyTest* two   = CMyTest::NewL(KTextTwo);
CMyTest* three = CMyTest::NewL(KTextThree);
...
RPointerArray&lt;CMyTest&gt; x;</pre>
 <p>There are at least three ways
of proceeding, some of which are more efficient than others. </p>
 <ul>
<li id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-502B71BF-A649-5E1A-90C1-B7822FD61CF8"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-502B71BF-A649-5E1A-90C1-B7822FD61CF8"><!-- --></a><p>Explicitly build a <samp class="codeph">TLinearOrder&lt;CMyTest&gt;</samp> and
pass this as a parameter to <samp class="codeph">InsertInOrder()</samp>. </p>
 </li>

</ul>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-65DCB793-5FE3-59F7-B479-DCEDB2FEC5BC"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-65DCB793-5FE3-59F7-B479-DCEDB2FEC5BC"><!-- --></a>...
TLinearOrder&lt;CMyTest&gt; order(CMyTest::Compare);
...
x.InsertInOrder(one,order);
...</pre>
 <ul>
<li id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-A9BEE65B-EA73-57C8-8E3A-FCDAF7D7AFD3"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-A9BEE65B-EA73-57C8-8E3A-FCDAF7D7AFD3"><!-- --></a><p>Construct a temporary <samp class="codeph">TLinearOrder&lt;CMyTest&gt;</samp> on
the call to <samp class="codeph">InsertInOrder()</samp>. </p>
 </li>

</ul>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-A61509B0-8473-56BA-B343-3F62A9D54A0B"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-A61509B0-8473-56BA-B343-3F62A9D54A0B"><!-- --></a>...
x.InsertInOrder(one,TLinearOrder&lt;CMyTest&gt;(CMyTest::Compare));
...</pre>
 <ul>
<li id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-46064641-BA0A-5FE5-93A1-1C2F3981AB1B"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-46064641-BA0A-5FE5-93A1-1C2F3981AB1B"><!-- --></a><p>Implicitly construct
a temporary <samp class="codeph">TLinearOrder&lt;CMyTest&gt;</samp> on the call to <samp class="codeph">InsertOrder()</samp>. </p>
 </li>

</ul>
 <pre class="codeblock" id="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-9B4DA4D7-2DAC-58C6-B958-EDC20ED785B6"><a name="GUID-B70E22E6-CF28-58A0-9D1E-C9A12D1FBC72__GUID-9B4DA4D7-2DAC-58C6-B958-EDC20ED785B6"><!-- --></a>...
x.InsertInOrder(one,CMyTest::Compare);
...</pre>
 <p>This applies to all member functions of <samp class="codeph">RPointerArray&lt;class
T&gt;</samp> which take a <samp class="codeph">TLinearOrder&lt;class T&gt;</samp> argument. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-59DB0115-053A-5D23-8C40-E2428C096BBC.html">How to Use Dynamic Arrays</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>