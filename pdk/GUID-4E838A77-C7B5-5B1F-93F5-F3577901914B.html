<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Policy Resource"/>
<meta name="DC.Relation" scheme="URI" content="GUID-66022FF4-3044-51E6-88CE-FE3B1283C0CB.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BA362536-C9C9-5BA4-BEE3-0E1AD7FA45F1.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5329AE68-39E0-55E7-9878-2D8FF9E29B21.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-66022FF4-3044-51E6-88CE-FE3B1283C0CB.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Policy Resource</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2858601 id2858609 id2858624 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-BA362536-C9C9-5BA4-BEE3-0E1AD7FA45F1.html">Authorisation</a> &gt; <a href="GUID-5329AE68-39E0-55E7-9878-2D8FF9E29B21.html">User Prompt Service</a> &gt; <a href="GUID-66022FF4-3044-51E6-88CE-FE3B1283C0CB.html">Concepts</a> &gt; </div>
<h1 class="topictitle1">Policy
Resource </h1>
<div>
<div class="section"><h2 class="sectiontitle">Policies resource structure</h2> <p>A policy resource is
made up of the following; a header, followed by any number of policies. Policies
need to be ordered from most specific to least specific. </p>
 <p>There are
two ways to control whether prompts are generated for system servers: </p>
 <ul>
<li id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-99E2B7E8-5FA0-5A55-ADE9-D832C4A6CF3C"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-99E2B7E8-5FA0-5A55-ADE9-D832C4A6CF3C"><!-- --></a><p>Using the <samp class="codeph">authorisationpolicy</samp> setting
in the header. If <samp class="codeph">authorisationpolicy</samp> is set to anything
except <samp class="codeph">EAlwaysCheck</samp>, prompts will not be generated for Messaging
Server, Java VM etc because these components are in the ROM, have the appropriate
capabilities and have protected secure ids. </p>
 </li>

<li id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-E8B43077-ECC9-5D4F-A613-B168058E0162"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-E8B43077-ECC9-5D4F-A613-B168058E0162"><!-- --></a><p>Using the <samp class="codeph">SID_LIST</samp> setting
in the policy. The <samp class="codeph">SID_LIST</samp> can be used to create a very
specific policy that always allows requests from trusted components as in
the example policy below. </p>
 </li>

</ul>
 </div>

<div class="section"><h2 class="sectiontitle">Header </h2> <p>The header includes the following possible
fields: <samp class="codeph">majorversion</samp>, <samp class="codeph">minorversion</samp>, <samp class="codeph">authorisationpolicy</samp>, <samp class="codeph">dialogcreator</samp> and <samp class="codeph">policyevaluator</samp>. </p>
 <p>The major version number controls whether
existing decision records for services corresponding to the policy file are
deleted or preserved when the policy file is upgraded. </p>
 <p>The <samp class="codeph">authorisationpolicy</samp> field
determines whether a system server must request authorisation from the User
Prompt Service even if the client application passed the system server's security
check. The value for <samp class="codeph">authorisationpolicy</samp> can be one of the
following: </p>
 
<div class="tablenoborder"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-45D126E1-1CF1-59AF-A438-AB252BC49A4D"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-45D126E1-1CF1-59AF-A438-AB252BC49A4D" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">EAlwaysCheck</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>Ignore the system server (platsec) checks and always ask the UPS
what to do. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">ECheckPostManufacture </samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>For application executables with a protected SID launched from the
Z drive, where the system server checks have passed, allow the request. Otherwise
call the UPS which may still choose to allow the request. For all other executables,
ignore the system server (platsec) checks and always ask the UPS what to do. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">ECheckUnprotectedSids</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>For application executables with a protected SID (regardless of
drive), where the system server checks have passed, allow the request. Otherwise
call the UPS which may still choose to allow the request. For all other executables,
ignore the system server (platsec) checks, and always ask the UPS what to
do. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> ECheckIfFailed</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>If the system server checks passed, allow the request. If they failed,
call the UPS which may still choose to allow the request. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> ENeverCheck</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>If the system server checks passed, allow the request. If the system
server checks failed, reject the request. Never query the UPS – just use existing
security check result implemented by system server. (This is the legacy pre-UPS
behaviour.) </p>
 </td>

</tr>

</tbody>

</table>
</div>
 <p>If no <samp class="codeph">authorisationpolicy</samp> is provided, the default
is <samp class="codeph">ECheckPostManufacture</samp>. </p>
 <p> <strong>Note</strong>: If a policy
file is not defined for a system server or service then a default value of <samp class="codeph">ENeverCheck</samp> is
used. </p>
 <p>The <samp class="codeph">dialogcreator</samp> must be provided and must
not be zero. In the policy file it is the only field that is actually required.
The <samp class="codeph">policyevaluator</samp> can be specified here, but if one is
not specified, a default policy evaluator is called. The <samp class="codeph">dialogcreator</samp> and <samp class="codeph">policyevaluator</samp> UIDs
are allocated by Symbian Signed. They are the implementation UIDs of the relevant
ECOM plugins. </p>
 <p>The following shows an example header: </p>
 <pre class="codeblock" id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-C626C28A-9121-5AC6-B075-C3EE939C3DC1"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-C626C28A-9121-5AC6-B075-C3EE939C3DC1"><!-- --></a>header = POLICY_HEADER
 {
 // The major version number of THIS policy file.
 // When policy files are upgraded or eclipsed the UPS deletes all decision
 // records for the system server server SID and service ID where the major
 // version in the decision record is not equal to the major version
 // number in the policy file.
 majorversion = 0;
 // The minor version number of THIS policy file.
 minorversion = 0; 

 // Built-in (protected SID and loaded from Z drive) client applications
 // do not require authorisation from the UPS if the client has the correct
 // capabilities.
 authorisationpolicy = ECheckPostManufacture;
 //dialogcreator and policyevaluator UIDs
 dialogcreator = 0x10283694;
 policyevaluator = 0x10283698;
 };
</pre>
 </div>

<div class="section"><h2 class="sectiontitle"> Policies</h2> <p>Policies can have the following optional
fields: </p>
 
<div class="tablenoborder"><a name="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-5CB991E2-1268-5D07-BF99-585F6DC2C5A3"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B__GUID-5CB991E2-1268-5D07-BF99-585F6DC2C5A3" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" valign="top"><p> <strong> Field</strong>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <strong>Description</strong>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <strong>Possible values </strong>  </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">sid_classes </samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>A bitmask that defines the set of SID classes that this policy applies
to. It is ignored if a <samp class="codeph">sid_list[]</samp> field is provided. </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph">KProtectedSids</samp> (All clients with a protected SID) <samp class="codeph">KUnprotectedSids</samp> (All
clients with an unprotected SID) <samp class="codeph">KAllSids</samp> (All clients) </p>
 <p>(Defined
in ups/policies.rh.) </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> sid_list[] </samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>An array of LONGs that defines a set of specific client application
SIDs that this policy applies to. </p>
 </td>

<td class="cellrowborder" valign="top"><p>&lt;Application SID&gt;, &lt;Application SID&gt;, … </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">systemserversecurity</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>Allows policies to be matched according to whether the client process
passed the security check defined by the system server. Typically, this corresponds
to whether the client has the correct capabilities for the requested service.
However, system servers are free to use features other than capabilities in
their security check. </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph"> ESystemServerSecurityPassedOrFailed</samp> (The policy
applies regardless of whether the client process passed the system server's
security check.) </p>
 <p> <samp class="codeph">ESystemServerSecurityFailed</samp> (The
policy only applies if the client process failed the system server's security
check.) </p>
 <p> <samp class="codeph">ESystemServerSecurityPassed</samp> (The policy
only applies if the client process passed the system server's security check.) </p>
 <p>(Defined
in ups/policies.rh.) </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> destination</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>A string to match against the destination supplied by system server. </p>
 </td>

<td class="cellrowborder" valign="top"><p>“&lt;STRING&gt;” (e.g. telephone number) or “*” for all (The default
value is "*" and the matching rules are those of <samp class="codeph">TDesC::MatchF</samp>,
so it is a case-insensitive wildcard match.) </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> options</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>A bit field to control which buttons to display on the dialog. </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph">KYes</samp>, <samp class="codeph">KNo</samp>, <samp class="codeph">KSessionYes</samp>, <samp class="codeph">KAlways</samp>, <samp class="codeph">KNever</samp>, <samp class="codeph">KSessionNo</samp>  </p>
 <p> <samp class="codeph">KSessionNo</samp> should be used with care because it
is likely that a system server will define a session to be the life-time of
the client process. Consequently, the client application would have to be
restarted in order to gain access to the service. This makes it difficult
to write a well-behaved application that switches between on-line and off-line
modes. </p>
 <p>(Defined in ups/policies.rh.) </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">policyevaluator </samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>If non-zero, overrides the implementation UID of the policy evaluator
defined in the header. </p>
 </td>

<td class="cellrowborder" valign="top"><p>&lt;UID&gt; </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> dialogcreator </samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>If non-zero, overrides the implementation UID of the dialog creator
defined in the header. </p>
 </td>

<td class="cellrowborder" valign="top"><p>&lt;UID&gt; </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph"> flags</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>Flags specific to the policy evaluator. Can be used to trigger specific
behaviour. </p>
 </td>

<td class="cellrowborder" valign="top"><p>&lt;16-bit number&gt; </p>
 </td>

</tr>

</tbody>

</table>
</div>
 <p> <strong>Note</strong>: If the matched policy defines only positive <samp class="codeph">options</samp> (Yes,
Session or Always), the UPS silently instructs the system server to allow
the request. If the matched policy defines only negative <samp class="codeph">options</samp> (No
or Never), the UPS silently instructs the system server to reject the request.
It is usually better not to configure UPS policies to silently reject requests
because it is likely to cause the client application to fail without warning.
Instead, the policy could restrict requests to one-shot permissions (Yes or
No). </p>
 </div>

<div class="section"><h2 class="sectiontitle">Matching policies </h2> <p>The UPS compares each policy
within a file in order, starting with the first policy in the file, against
the incoming request until a match is found. The match is based on the secure
id of the client application, the destination of the request (e.g. Phone number,
Access Point) and whether the client passed the system server's platform security
check. All three elements must match (wildcards are supported) the data in
the request before the policy is considered a match. </p>
 <p>You can use the <samp class="codeph">sid_list</samp> and <samp class="codeph">destination</samp> fields
to fine-tune your policies, by providing specific application UIDs in <samp class="codeph">sid_list</samp> and
specific destinations, such as one telephone number, in <samp class="codeph">destination</samp>. </p>
 <p>Because
the UPS compares incoming requests against policies in order, the UPS requires
that all of the policies for a given service are ordered from most specific
to least specific in a single policy file. Only the first policy that matches
is evaluated. So if, for example, you need to provide specific behaviour for
one application that falls into the category <samp class="codeph">KProtectedSids</samp> as
well as providing more general behaviour for all other applications falling
into the <samp class="codeph">KProtectedSids</samp> category, you need to define the
policy for the individual application first. Likewise, if you need to provide
behaviour for one particular destination but another behaviour for all other
destinations, you need to specify the policy for the specific destination
first. </p>
</div>

<div class="section"><h2 class="sectiontitle">Default policies</h2> <p>If a UPS policy
file exists for a system server/service but no policy matches the request,
the UPS internally creates a default policy object that is passed to the Policy
Evaluator and Dialog Creator. This policy object allows one-shot permissions
for applications, which will already have got past the platform security check.
Policy file authors may override this by defining a generic policy to match
all requests at the end of the policy file. </p>
</div>

<div class="section"><h2 class="sectiontitle">See also</h2> <p> <a href="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99.html">Writing
the UPS Policy File</a>  </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-66022FF4-3044-51E6-88CE-FE3B1283C0CB.html">Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>