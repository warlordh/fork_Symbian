<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Working with Multiple Calendar Instances"/>
<meta name="abstract" content="This task describes how a Calendar object can find instances of calendar entries across many calendar files."/>
<meta name="description" content="This task describes how a Calendar object can find instances of calendar entries across many calendar files."/>
<meta name="DC.Relation" scheme="URI" content="GUID-A60C4549-9FAA-496A-B743-D395A461B61F.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F22B8035-CD08-4181-B03A-759E92CA967B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-00631ED2-1B7F-5FC4-9E81-4B6DF7946631.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A60C4549-9FAA-496A-B743-D395A461B61F.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CD8A3420-6C9B-5774-86FA-85CFE062C400.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Working with Multiple Calendar Instances</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858252 id2858283 id2858368 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-F22B8035-CD08-4181-B03A-759E92CA967B.html">Organizer Guide</a> &gt; <a href="GUID-00631ED2-1B7F-5FC4-9E81-4B6DF7946631.html">Calendar Guide</a> &gt; <a href="GUID-A60C4549-9FAA-496A-B743-D395A461B61F.html">Tutorials</a> &gt; </div>
<h1 class="topictitle1">Working with Multiple Calendar Instances</h1>
<div><p>This task describes how a Calendar object can find instances of calendar entries across many calendar files. </p>
<div class="section"><h2 class="sectiontitle">Required background</h2> <p>Before you start, you must be familiar with the <a href="GUID-3A6BEF56-ADBF-543E-B70A-52195DE3E92A.html">Calendar</a> component. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Introduction</h2> <p>For a Calendar session, <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalSession</span></a>, to access a file (or collection) it must connect to the server. More than one file may be opened and multiple Calendar sessions (or instances) can be created. A second Calendar session can share the first session's connection to the server. This is possible because the handle to the file is separate from the session to the server. </p>
 <p>A calendar application uses <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalInstanceView::FindInstanceL()</span></a> to find and change Calendar instances across multiple files and other data collections. When a Calendar collection changes a subscriber application is notified by the file observer. Each file has its own observer. </p>
 <p>A calendar entry can be stored, updated and deleted. Changes to calendar instances are committed to a calendar. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Procedure</h2> <p>A calendar entry can be located within any one of a number of different calendar collections. An application can access entry instances across multiple calendar collections. To do this an instance view must be created using the calendar collections to be searched. These collections must share the same session. </p>
 <p>To find instances across multiple Calendars follow the steps below. </p>
 <a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-4203AA69-8103-5FAE-B62F-13CC670F7DC8"><!-- --></a><ol id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-4203AA69-8103-5FAE-B62F-13CC670F7DC8"><li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-69554902-4BF8-5168-9D75-DCA23258C05B"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-69554902-4BF8-5168-9D75-DCA23258C05B"><!-- --></a><p>Call <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalSession::NewL()</span></a> to create a session and establish a connection to the server. </p>
 </li>
 <li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-EB618E6D-7F47-5FBA-91D3-F2ABD06D19C5"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-EB618E6D-7F47-5FBA-91D3-F2ABD06D19C5"><!-- --></a><p>Call the first session <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalSession::NewL(*session1)</span></a> to create a second session with the same connection. </p>
 </li>
 <li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-1AF1E08E-56BA-57F4-A1AA-1371F52C2C62"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-1AF1E08E-56BA-57F4-A1AA-1371F52C2C62"><!-- --></a><p>Place the sessions in an array using the declaration <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">RPointerArray&lt;CCalSession&gt;</span></a>. </p>
 </li>
 <li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-091BB285-BD39-5987-8B1A-4F6B0258C88E"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-091BB285-BD39-5987-8B1A-4F6B0258C88E"><!-- --></a><p>Register the sessions with instance view <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalInstanceView</span></a>. </p>
 </li>
 <li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-20A48CDE-EBFA-5632-A094-606A1A738139"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-20A48CDE-EBFA-5632-A094-606A1A738139"><!-- --></a><p>Use <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">CCalInstanceView</span></a> to find instances of a calendar entry. </p>
 <p>Each instance has a collection ID which uniquely identifies its source. The unique ID enables the application to fetch the metadata associated with the source. (Example metadata includes creation time, type and filename.) </p>
 </li>
 <li id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-B22BCCF3-EB39-5764-942C-BAD5C523E873"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-B22BCCF3-EB39-5764-942C-BAD5C523E873"><!-- --></a><p>To clean up the objects created earlier delete the instances by calling <a href="GUID-E702E469-D282-3C85-9F78-6E8472EACB9C.html"><span class="apiname">RPointerArray::ResetAndDestroy()</span></a>. </p>
 </li>
 </ol>
 <pre class="codeblock" id="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-263E2DD3-C291-5112-BB66-7B64D8AD1E1F"><a name="GUID-3F21D4E3-6F1D-590D-A165-13380F8E98B5__GUID-263E2DD3-C291-5112-BB66-7B64D8AD1E1F"><!-- --></a>{
...
// Create a session
CCalSession* session1 = CCalSession::NewL();
session1-&gt;OpenL(KCalendarFilename1);

// Get the collection ID
TCalCollectionId collectionId1 = session1-&gt;CollectionId();

// Create a second session
CCalSession* session2 = CCalSession::NewL(*session1);
session2-&gt;OpenL(KCalendarFilename2);
TCalCollectionId collectionId2 = session2-&gt;CollectionId();

RPointerArray&lt;CCalSession&gt; calSessions;
calSessions.AppendL(session1);
calSessions.AppendL(session2);

// Find all instances within a given time range
CCalInstanceView* instanceView = CCalInstanceView::NewL(calSessions);
RPointerArray&lt;CCalInstance&gt; instances;
TCalTime start;
start.SetTimeUtcL(TCalTime::MinTime());
TCalTime end;
end.SetTimeUtcL(TCalTime::MaxTime());
CalCommon::TCalTimeRange timeRange(start, end);
instanceView-&gt;FindInstanceL(instances, CalCommon::EIncludeAll, timeRange);

// An application finds which session an instance belongs to
TCalCollectionId id = instanceArray[index]-&gt;InstanceIdL().iCollectionId;

switch (id)
    {
    case collectionId1:
        // Fetch meta data about session1
        break;
    case collectionId2:
        // Fetch meta data about session2
        break;
    }

...

// Clean up objects
delete instances;

// Delete without closing session1 or session2
delete instanceView;
calSessions.ResetAndDestroy();

// Close session1 but do not disconnect from the server
delete session1;

// Close session2 and disconnect from the server
delete session2;
}
</pre>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-A60C4549-9FAA-496A-B743-D395A461B61F.html">Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-CD8A3420-6C9B-5774-86FA-85CFE062C400.html">Calendar Views</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>