<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Opening a Session with the Bluetooth GPS PSY"/>
<meta name="abstract" content="This topic describes how to open a session with the Bluetooth GPS PSY."/>
<meta name="description" content="This topic describes how to open a session with the Bluetooth GPS PSY."/>
<meta name="DC.Relation" scheme="URI" content="GUID-90D938EA-E46A-512A-85E3-B8ADF81BC4D3.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5CBF9CB3-1914-571C-B634-715EAF1272DA.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5454AFE9-ADC2-5980-85FC-3FF457B638D0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-90D938EA-E46A-512A-85E3-B8ADF81BC4D3.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-2C9F2B48-5E92-5C25-9C16-B93C34B223B7"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-B253E1BD-59C4-5725-9899-16E495233DAA"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-6C12D640-CE1E-5368-90E5-D9EF34C6B1CF"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-CB2663ED-4711-5162-BE0C-FF2DB31C3B49"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-CDA4A58C-EE1B-5C34-A786-C2FC112C3C74"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-1C02463D-FBDF-5E04-9842-438C8ABD6DF4"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB/GUID-C88E20CE-C7AD-5439-AE03-E83C18C3694B"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7CE5CF4C-7661-5FE1-87CA-CC4EB1CECE34.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DA2DC704-CE65-54FB-9049-4E1C73092EDF-GENID-1-12-1-19-1-1-10-1-5-1-5-1-8-1.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D0318BB6-0B9F-5A1C-AB0B-61BA22D28661.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-51177BB6-D906-57BD-91DD-EC263F900225"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Opening a Session with the Bluetooth GPS PSY</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-51177BB6-D906-57BD-91DD-EC263F900225"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2403469 id2403500 id2403514 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-5CBF9CB3-1914-571C-B634-715EAF1272DA.html" title="The Data Source Modules collection contains components that enable the LBS subsystem to obtain position data.">Data Source Modules</a> &gt; <a href="GUID-5454AFE9-ADC2-5980-85FC-3FF457B638D0.html" title="The Bluetooth GPS Positioning Module (Bluetooth GPS PSY) connects the LBS subsystem to an external Bluetooth GPS device.">Bluetooth GPS Positioning Module</a> &gt; <a href="GUID-90D938EA-E46A-512A-85E3-B8ADF81BC4D3.html" title="These tutorials describe how to configure and use the Bluetooth GPS PSY.">Bluetooth GPS PSY Tutorials</a> &gt; </div>
<h1 class="topictitle1">Opening a Session with the Bluetooth GPS PSY</h1>
<div><p>This topic describes how to open a session with the Bluetooth GPS PSY. </p>
<div class="section"><h2 class="sectiontitle">Required background</h2> <p>Knowledge of the <a href="GUID-D0318BB6-0B9F-5A1C-AB0B-61BA22D28661.html" title="Client applications use the Location Acquisition API to obtain the position of the mobile device from the LBS subsystem.">Location Acquisition API</a> is helpful in understanding this topic. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Introduction</h2> <p>To use the Bluetooth GPS PSY a <a href="GUID-D0318BB6-0B9F-5A1C-AB0B-61BA22D28661.html" title="Client applications use the Location Acquisition API to obtain the position of the mobile device from the LBS subsystem.">Location Acquisition API</a> client opens an <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html"><span class="apiname">RPositioner</span></a> subsession using one of the following methods: </p>
 <ul><li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-4A5DF461-3351-56C8-829F-271C37D02B61"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-4A5DF461-3351-56C8-829F-271C37D02B61"><!-- --></a><p>Using the Default PSY </p>
 </li>
 <li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-7D6F6FE8-C35D-5F31-9C88-9F071A90481A"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-7D6F6FE8-C35D-5F31-9C88-9F071A90481A"><!-- --></a><p>Using the Bluetooth PSY explicitly </p>
 </li>
 </ul>
 <p>These methods are described in more detail below. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Procedure</h2> <ul><li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-266D6ED1-452E-58C4-88F6-D3FF8D4C5415"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-266D6ED1-452E-58C4-88F6-D3FF8D4C5415"><!-- --></a><p>To use the Default PSY, open a session without specifying a PSY UID, as shown in the following example code: </p>
 <p>The Default PSY reads a list of all the PSYs installed in the device. If the Bluetooth GPS PSY is installed, the Default PSY uses it in preference to all other PSYs. </p>
 <p>If the Bluetooth GPS PSY cannot provide a position fix (for example, because it is unable to connect to a GPS device), the Default PSY tries to use alternative PSYs (if installed). Opening a session using the Default PSY does not guarantee that a position fix will be obtained from the Bluetooth GPS PSY. </p>
 <div class="p"><pre class="codeblock" id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-0A9DFF8F-B035-5F5E-B9EA-816204342369"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-0A9DFF8F-B035-5F5E-B9EA-816204342369"><!-- --></a>
#include &lt;lbs.h&gt;
#include &lt;lbserrors.h&gt;

...

RPositionServer server;
RPositioner positioner;

//Create a session with the Location Server

User::LeaveIfError(server.Connect());
CleanupClosePushL(server);

// Location Server uses the default PSY, which preferentially uses the Bluetooth GPS PSY

User::LeaveIfError(positioner.Open(server);
CleanupClosePushL(positioner);

// Use Location Acquisition API as normal
// Call RPositioner::NotifyPositionUpdate() - see API documentation for more details

...

// Close the session

CleanupStack::PopAndDestroy(&amp;positioner);
CleanupStack::PopAndDestroy(&amp;server);
</pre>
 </div>
 <a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-EAA901D0-5C77-5062-B91D-A51AB83D126B"><!-- --></a><ol id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-EAA901D0-5C77-5062-B91D-A51AB83D126B"><li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-57818247-C9B6-5F14-A72C-D651B3AF7DD4"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-57818247-C9B6-5F14-A72C-D651B3AF7DD4"><!-- --></a><p>See <a href="GUID-7CE5CF4C-7661-5FE1-87CA-CC4EB1CECE34.html" title="The Default Positioning Module is a proxy PSY used by the Location Server (eposserver.exe) to select a PSY when a Location Acquisition API client opens a session without specifying a PSY ID.">Default PSY</a> for information about how a PSY is selected. </p>
 </li>
 <li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-58292650-F435-554D-83D0-C3E013CDDB57"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-58292650-F435-554D-83D0-C3E013CDDB57"><!-- --></a><p>See <a href="GUID-F6B5F777-D12F-5913-AECE-047DF8C72F1F.html" title="This document demonstrates how a client application uses the Location Acquisition API to get a position.">How to Get Location Information</a> for more information about using the Location Acquisition API. </p>
 </li>
 </ol>
 </li>
 <li id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-D2F13188-003A-591E-A177-C4E51D0FAB95"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-D2F13188-003A-591E-A177-C4E51D0FAB95"><!-- --></a><p>To specify that the Bluetooth GPS PSY must be used, open a session using its implementation UID (<samp class="codeph">0x101FE999</samp>), as shown in the following example code: </p>
 <div class="p"><pre class="codeblock" id="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-84186315-E6CA-53D0-8F49-E27BFF1D8D34"><a name="GUID-51177BB6-D906-57BD-91DD-EC263F900225__GUID-84186315-E6CA-53D0-8F49-E27BFF1D8D34"><!-- --></a>
#include &lt;lbs.h&gt;
#include &lt;lbserrors.h&gt;


const TInt KBTPSYImplUid = 0x101FE999;

...

RPositionServer server;
RPositioner positioner;

//Create a session with the Location Server

User::LeaveIfError(server.Connect());
CleanupClosePushL(server);

// Create a subsession with the Location Server using the Bluetooth PSY

User::LeaveIfError(positioner.Open(server, TUid::Uid(KBTPSYImplUid)));
CleanupClosePushL(positioner);

// Use Location Acquisition API as normal - see API documentation for more details

...

// Close the session

CleanupStack::PopAndDestroy(&amp;positioner);
CleanupStack::PopAndDestroy(&amp;server);
</pre>
 </div>
 <p>If the Bluetooth PSY cannot provide a position fix, the location request will fail. An error code other than <samp class="codeph">KErrNone</samp> will be returned to the client application. </p>
 <p>The Bluetooth GPS PSY supports the class types <a href="GUID-D5B2E933-209D-3871-8E27-CC5C8855C745.html"><span class="apiname">TPositionInfo</span></a>, <a href="GUID-B4CD3637-0FC6-38B8-AE89-C03EEC83C50D.html"><span class="apiname">TPositionCourseInfo</span></a>, <a href="GUID-54AE0674-C49D-3329-8B77-3A58EFFC03D7.html"><span class="apiname">TPositionSatelliteInfo</span></a> and <a href="GUID-C0D87E5C-315E-37E6-829E-73F93E83748E.html"><span class="apiname">HPositionGenericInfo</span></a>. The argument to <a href="GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575.html#GUID-1EAEB7EF-0AC7-37C7-B35F-C9B780FFC575__GUID-321F6046-3551-3ACE-B0A3-26D51FAEB477"><span class="apiname">RPositioner::NotifyPositionUpdate()</span></a> must be one of these classes. <samp class="codeph">HPositionGenericInfo</samp>, <samp class="codeph">TPositionCourseInfo</samp> and <samp class="codeph">TPositionSatelliteInfo</samp> are all derived from <samp class="codeph">TPositionInfo</samp>. </p>
 </li>
 </ul>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-90D938EA-E46A-512A-85E3-B8ADF81BC4D3.html" title="These tutorials describe how to configure and use the Bluetooth GPS PSY.">Bluetooth GPS PSY Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-7CE5CF4C-7661-5FE1-87CA-CC4EB1CECE34.html" title="The Default Positioning Module is a proxy PSY used by the Location Server (eposserver.exe) to select a PSY when a Location Acquisition API client opens a session without specifying a PSY ID.">Default
                PSY</a></div>
<div><a href="GUID-DA2DC704-CE65-54FB-9049-4E1C73092EDF-GENID-1-12-1-19-1-1-10-1-5-1-5-1-8-1.html">Positioning Plug-in Information API</a></div>
<div><a href="GUID-D0318BB6-0B9F-5A1C-AB0B-61BA22D28661.html" title="Client applications use the Location Acquisition API to obtain the position of the mobile device from the LBS subsystem.">Location Acquisition API</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-2C9F2B48-5E92-5C25-9C16-B93C34B223B7">Error
                codes</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-B253E1BD-59C4-5725-9899-16E495233DAA">Loading the PSY
                and device selection</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-6C12D640-CE1E-5368-90E5-D9EF34C6B1CF">Bluetooth GPS
                Device initialisation</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-CB2663ED-4711-5162-BE0C-FF2DB31C3B49">Making a
                location request</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-CDA4A58C-EE1B-5C34-A786-C2FC112C3C74">Tracking</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-1C02463D-FBDF-5E04-9842-438C8ABD6DF4">Cancelling a
                location request</a></div>
<div><a href="GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB.html#GUID-7C1CF86B-5F03-55EE-96C6-79A88A195BEB__GUID-C88E20CE-C7AD-5439-AE03-E83C18C3694B">Unloading the
                Bluetooth GPS PSY</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>