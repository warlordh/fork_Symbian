<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Writing a MIME Recognizer"/>
<meta name="DC.Relation" scheme="URI" content="GUID-863AD171-B40B-5056-96B1-A7B995DB3524.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-94215E49-605B-51BA-B215-10BDA1A0C013.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F18D0E06-2FB8-5339-AF31-02CC7D5A8010.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-863AD171-B40B-5056-96B1-A7B995DB3524.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Writing a MIME Recognizer</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2381103 id2381979 id2382184 id2382198 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html">Generic OS Services Guide</a> &gt; <a href="GUID-94215E49-605B-51BA-B215-10BDA1A0C013.html">Generic Services</a> &gt; <a href="GUID-F18D0E06-2FB8-5339-AF31-02CC7D5A8010.html">MIME Recognition Framework</a> &gt; <a href="GUID-863AD171-B40B-5056-96B1-A7B995DB3524.html">MIME Recognition Framework Tutorials</a> &gt; </div>
<h1 class="topictitle1">Writing
a MIME Recognizer</h1>
<div><div><p>The Mime Recognizers provide the implementation for data type
(MIME Type) recognition using the MIME recognition framework. </p>
<p>Each
MIME recognizer specifies the MIME type it supports along with the priority
and confidence of recognition. A MIME recognizer reads a small piece of data
and identifies the data type. Once the data type is identified, it is passed
to the <a href="GUID-1578590A-FC00-5C3B-8BF9-F6E43CA9D9A0.html">Application
Architecture </a> (AppArc). AppArc launches the application
that best handles the identified data type.  </p>
</div>

<div class="section" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-6799E3F3-353E-5C00-A38C-D32F888392AA-GENID-1-12-1-14-1-1-6-1-6-1-4-1-3-1-3-1"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-6799E3F3-353E-5C00-A38C-D32F888392AA-GENID-1-12-1-14-1-1-6-1-6-1-4-1-3-1-3-1"><!-- --></a><p>Symbian OS v9.1
and onwards, MIME recognizers are <a href="GUID-9E92EE30-F2E2-5F28-BB2A-391C09EC69D2.html">ECOM</a> plug-ins.
They are located in <strong>\sys\bin\</strong>. </p>
 <p>Each MIME recognizer is loaded
by the <a href="GUID-1578590A-FC00-5C3B-8BF9-F6E43CA9D9A0.html">Application
Architecture (AppArc)</a> during the startup sequence. </p>
 </div>

<a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-45E4FFC7-5C92-5101-B21B-581C2AFB9CF0"><!-- --></a><ol id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-45E4FFC7-5C92-5101-B21B-581C2AFB9CF0"><li class="stepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-016BE2C1-DFB1-51B0-9A5C-C3A926C48E33"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-016BE2C1-DFB1-51B0-9A5C-C3A926C48E33"><!-- --></a><span/><br/>
 Create a project file (<span class="filepath">.mmp</span>) for the MIME recognizer
and ensure the following parameters are set. 
 
<div class="tablenoborder"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-8A194C7E-8927-5A8A-B1EA-EB9D7A23CF0C"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-8A194C7E-8927-5A8A-B1EA-EB9D7A23CF0C" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" valign="top"><p> <strong>Variable Name</strong>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <strong>Value</strong>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <strong>Description</strong>  </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">TargetType</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph">plugin</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>Specifies the type of binary. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">Resource</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>Use the block <samp class="codeph">start resource ... end</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>The variable <samp class="codeph">Resource</samp> is set to the registration
resource file (<span class="filepath">.rss)</span>)of the MIME recognizer. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">UID</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph">0x10009D8D</samp> and the <samp class="codeph">DLL UID</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>The variable <samp class="codeph">UID</samp> requires two values. The first
value is 0x10009D8D and is constant for all MIME recognizers. The second value
is the UID of the DLL. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p> <samp class="codeph">Capability</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p> <samp class="codeph">Protserv</samp>  </p>
 </td>

<td class="cellrowborder" valign="top"><p>The AppArc server has <samp class="codeph">protserv</samp> capability.The MIME
recognizers are loaded by the AppArc server on requirement. The MIME recognizers
must have <samp class="codeph">protserv</samp> capability to be loaded by the AppArc
server. </p>
 </td>

</tr>

</tbody>

</table>
</div>
 
 For more details, refer <a href="GUID-641A276D-F618-50CE-BA5A-658DCC26BAB5.html" title="The format of implementation project file is dependent on the version of the Symbian platform used. The differences basically reflect the introduction of platform security into Symbian OS v9.0 and later versions.">Creating
a Project File</a>. 
 The code below shows a sample <span class="filepath">.mmp</span> file with the
above parameters set. 
 <pre class="codeblock" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B21A3AEB-C21C-5C9B-8BE3-715336ECBFD0"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B21A3AEB-C21C-5C9B-8BE3-715336ECBFD0"><!-- --></a>target exampleRecognizer.dll

capability          Protserv
targettype          plugin
uid                    0x10009d8d 0x1d1f75ed
vendorid            0x70000001

sourcepath          .
source                 exampleRecognizer.cpp
systeminclude       \EPOC32\INCLUDE
systeminclude       \EPOC32\INCLUDE\ECOM 

library                EUSER.LIB APMIME.LIB 

start resource   1d1f75ed.rss
target           exampleRecognizer.rsc
end</pre>
 
</li>
<li class="stepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-98A72A42-24D2-5A16-A0DE-15223FD1A685"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-98A72A42-24D2-5A16-A0DE-15223FD1A685"><!-- --></a><span/><br/>
 Export the factory code function of the MIME recognizer as shown below.
This is required to create an instance of the MIME recognizer. 
 The class <samp class="codeph">CExampleRecognizer</samp> is derived from <a href="GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0.html"><span class="apiname">CApaDataRecognizerType</span></a>. 
 <pre class="codeblock" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-F61F7E5E-37E0-5F4B-8E9A-E4C106005554"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-F61F7E5E-37E0-5F4B-8E9A-E4C106005554"><!-- --></a>const TInt KImplementationUID = 0x101F7DA1;

CApaDataRecognizerType* CExampleRecognizer::CreateRecognizerL()
       {
         return new (ELeave) CExampleRecognizer;
       }

const TImplementationProxy ImplementationTable[] = 
       {
        IMPLEMENTATION_PROXY_ENTRY(KImplementationUID,CExampleRecognizer::CreateRecognizerL);
       }

EXPORT_C const TImplementationProxy* ImplementationGroupProxy(TInt&amp; aTableCount)
       {
        aTableCount = sizeof(ImplementationTable) / sizeof(TImplementationProxy);
        return ImplementationTable;
    }
</pre>
 
 For more details refer <a href="GUID-895A685E-83E8-51A3-A823-3A0E07B1E609.html">Exporting
Implementation Factories.</a>  
</li>
<li class="stepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B06E4D48-5CC2-5BEB-8C28-8DE5EFF62FE1"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B06E4D48-5CC2-5BEB-8C28-8DE5EFF62FE1"><!-- --></a><span/><br/>
 Implement <samp class="codeph">CApaDataRecognizerType</samp> polymorphic interface. 
<a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-C29E1469-92CF-53D6-867F-FA73E223929C"><!-- --></a><ol type="a" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-C29E1469-92CF-53D6-867F-FA73E223929C">
<li class="substepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B670112D-ACEB-5001-8F60-F16DF4240CE7"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-B670112D-ACEB-5001-8F60-F16DF4240CE7"><!-- --></a><span/><br/>
 The code below shows a sample constructor implementation. 
 <pre class="codeblock" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-F8BD0190-4751-5731-BBF8-BD41644755F5"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-F8BD0190-4751-5731-BBF8-BD41644755F5"><!-- --></a>const TUid KExampleUid = {0x1d1f75ed};

const TInt KNumDataTypes = 1;

CExampleRecognizer::CExampleRecognizer() : CApaDataRecognizerType(KExampleUid,CApaDataRecognizerType::EHigh) 

  { 
     iCountDataTypes = KNumDataTypes;
 
  } 

</pre>
 
 Specify a UID (the <samp class="codeph">DLL UID</samp> as specified in the plug-in
project definition file) and a <a href="GUID-EBD1242B-6BD9-5ABB-B471-24ABC78A918C.html">priority</a> in
the constructor. 
 The <samp class="codeph">iCountDataTypes</samp> variable, represents the number
of data types supported by the recognizer can also be set in the constructor.
The value set for this variable should match the implementation of <a href="GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0.html#GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0__GUID-FBCE07F2-9566-3AD1-B943-2FFF5C5AAE67"><span class="apiname">CApaDataRecognizerType::SupportedDataTypeL()</span></a>. 
</li>

<li class="substepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-5F36C1F6-3EDA-5817-801D-9B5C6F9F4927"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-5F36C1F6-3EDA-5817-801D-9B5C6F9F4927"><!-- --></a><span/><br/>
 Implement the pure virtual function <a href="GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0.html#GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0__GUID-FBCE07F2-9566-3AD1-B943-2FFF5C5AAE67"><span class="apiname">CApaDataRecognizerType::SupportedDataTypeL()</span></a>.
It returns the MIME types that the recognizer is capable of recognizing. 
 The code below shows a sample implementation of <samp class="codeph">SupportedDataTypeL()</samp> for
supporting MIME type/ subtype "text/example". 
 <pre class="codeblock" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-D2DDF2A2-2897-544A-ACA7-DA3A60FB27E9"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-D2DDF2A2-2897-544A-ACA7-DA3A60FB27E9"><!-- --></a>
_LIT8(KExampleTextMimeType, "text/example"); 


TDataType CExampleRecognizer::SupportedDataTypeL(TInt aIndex) const

    {
        return TDataType(KExampleTextMimeType);

    }</pre>
 
</li>

<li class="substepexpand" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-4C2CD90F-17AB-53B5-883A-7022E1231E2E"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-4C2CD90F-17AB-53B5-883A-7022E1231E2E"><!-- --></a><span/><br/>
 Implement <a href="GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0.html#GUID-EBE480D9-E377-32F4-9AE5-9C58684BEFF0__GUID-74ED8BEA-52AA-3AC4-92D9-5E4FB4F25DDD"><span class="apiname">CApaDataRecognizerType::DoRecognizeL()</span></a>.
This function executes data type recognition. 
 The code below shows a sample implementation of <samp class="codeph">DoRecognizeL()</samp> for
recognizing the MIME type <samp class="codeph">"/text/example"</samp> contained in files
with <span class="filepath">.example</span> extension with maximum confidence. 
 <pre class="codeblock" id="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-C8F82861-AF59-5E23-9F1D-8656B2D1EE54"><a name="GUID-1AAA88BB-19AD-5B8E-993C-11F4B7CD90EB__GUID-C8F82861-AF59-5E23-9F1D-8656B2D1EE54"><!-- --></a>void CExampleRecognizer::DoRecognizeL(const TDesC&amp; aName, const TDesC8&amp; aBuffer)
    {
    _LIT8(KExampleData, "example");
    _LIT(KDotExample, ".Example");

    TParse parse;
    parse.Set(aName,NULL,NULL);
    TPtrC ext=parse.Ext(); // extract the extension from the filename

    if (ext.CompareF(KDotExample)==0 &amp;&amp; aBuffer.FindF(KExampleData)!=KErrNotFound)
         {
          iConfidence=ECertain;
          iDataType=TDataType(KExampleTextMimeType); 
        }
    }</pre>
 
</li>

</ol>

</li>
</ol>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-863AD171-B40B-5056-96B1-A7B995DB3524.html">MIME Recognition Framework Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>