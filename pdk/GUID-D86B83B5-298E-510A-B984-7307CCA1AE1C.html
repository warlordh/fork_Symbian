<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="How to use Lexical Analysis"/>
<meta name="abstract" content="Explains how to create and use TLex objects with code fragments."/>
<meta name="description" content="Explains how to create and use TLex objects with code fragments."/>
<meta name="DC.Relation" scheme="URI" content="GUID-D4A78D68-0812-532C-9AF9-85F1483EF3EA.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D4A78D68-0812-532C-9AF9-85F1483EF3EA.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>How to use Lexical Analysis</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2392600 id2392964 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html" title="Links to documents that describe buffers and strings.">Buffers And Strings</a> &gt; <a href="GUID-D4A78D68-0812-532C-9AF9-85F1483EF3EA.html" title="Topics related to the lexical analysis classes and how to use them.">Using Lexical Analysis</a> &gt; </div>
<h1 class="topictitle1">How to
use Lexical Analysis</h1>
<div><p>Explains how to create and use TLex objects with code fragments.</p>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-8A379959-AD24-4CA7-8664-63FDDBFA2A6B"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-8A379959-AD24-4CA7-8664-63FDDBFA2A6B"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>A <samp class="codeph">TLex</samp> object may
be constructed as an empty object, from another <samp class="codeph">TLex,</samp> or
from an existing string as below. The code fragments are taken from an example
that implements a simple Reverse Polish Notation calculation engine.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-0F57D0AE-19C2-5C5D-BF05-5924643A933E"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-0F57D0AE-19C2-5C5D-BF05-5924643A933E"><!-- --></a>TInt RPNCalc(const TDesC&amp; aCommand, TReal&amp; aReturnValue)
    {
    ...
    TLex input (aCommand) ;
    ...</pre>
 <p>Code can then proceed to move through the <samp class="codeph">TLex</samp> data
to:</p>
 <ul>
<li id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-DE9D6065-0426-5D33-A11B-3DEB3102A1EA"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-DE9D6065-0426-5D33-A11B-3DEB3102A1EA"><!-- --></a><p>mark positions for rolling
back to later</p>
 </li>

<li id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-915C7EE1-AF85-5865-BD9A-7068426BC897"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-915C7EE1-AF85-5865-BD9A-7068426BC897"><!-- --></a><p> delimit the start of
lexical tokens</p>
 </li>

<li id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-0A43CFC8-B38B-5A94-AFA0-2C54266905F4"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-0A43CFC8-B38B-5A94-AFA0-2C54266905F4"><!-- --></a><p>delete parts of the
string held by the <samp class="codeph">TLex</samp> object.</p>
 </li>

</ul>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-2C636982-12F5-5DF6-A375-CCE4BD31FCA6"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-2C636982-12F5-5DF6-A375-CCE4BD31FCA6"><!-- --></a>...
input.Mark() ;                     // Remember where we are.
input.SkipCharacters() ;           // Move to end of character token.
...
_LIT(KTextMemset,"MEMSET");
if ( input.TokenLength() != 0 )    // if valid potential token
    {
    TPtrC token = input.MarkedToken() ;    // then extract token
    if ( token.CompareF(KTextMemset == 0)  // and test.
        {
        ...
        }
    ...
    }
 ...</pre>
 <p>Analysis can also be done by character using functions
that move through the <samp class="codeph">TLex</samp> data, extracting, returning and
jumping specified character lengths. For example:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-E5650436-99E6-56C9-9CEF-2DF87F1D787D"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-E5650436-99E6-56C9-9CEF-2DF87F1D787D"><!-- --></a>...
// ensure we are looking at a digit or sign
if (!(input.Peek().IsDigit() || (input.Peek() == '.') ) )
    {
    return KErrNotFound ;
    }
...    
// deal with sign
if (input.Peek() == '+')
    {
    input.Inc();
    }</pre>
 <p>Additionally, numeric conversion functions permit a variety
of numeric formats to be extracted from the <samp class="codeph">TLex</samp> data, with
provision for conversion using the most common number systems (radixes).</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BBE6F232-7E65-58A0-BDC8-F0293E1773F7"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BBE6F232-7E65-58A0-BDC8-F0293E1773F7"><!-- --></a>...
if (input.Val(extractUint) == KErrNone)
    {
    stack.Push(TReal(extractUint));
    }
else if (input.Val(extractReal) == KErrNone)
        {
        stack.Push(extractReal);
        }
...

</pre>
 <p>where <samp class="codeph">stack</samp>, is an instance of a class implementing
a stack.</p>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F688DD13-C866-5752-8530-30DECBFF0054"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F688DD13-C866-5752-8530-30DECBFF0054"><!-- --></a><h2 class="sectiontitle">Constructing
TLex objects</h2> <p>This converts an real number into a string, which
is then assigned to a <samp class="codeph">TLex</samp>.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-CB88572D-66DC-5C54-9F74-02E9331A7BAD"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-CB88572D-66DC-5C54-9F74-02E9331A7BAD"><!-- --></a>TBuf&lt;0x100&gt; convertRealToString;
// want a TLex from a value
if (convertRealToString.Num(value,format) &lt; KErrNone )
    {
       ...
       }
else
    {
    convertRealToString.ZeroTerminate();
    TLex string(convertRealToString) ;
       }</pre>
 <p>This takes a descriptor as a function parameter, and
copies it to a <samp class="codeph">TLex</samp>.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B793E5B1-76A5-5178-B1E1-A569EA3C55EE"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B793E5B1-76A5-5178-B1E1-A569EA3C55EE"><!-- --></a>TInt RPNCalc(const TDesC&amp; iCommand, TReal&amp; returnValue)
    {
    TLex input (iCommand) ;
       }</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-C5B343D9-C530-5FA9-BED9-286C182081CF"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-C5B343D9-C530-5FA9-BED9-286C182081CF"><!-- --></a><h2 class="sectiontitle">Peeking the
next character</h2> <p>This shows a code flow decision made according to
next character to be read from the <samp class="codeph">TLex</samp>:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-6FDB6BC3-9AB7-5C04-A003-7EE0CD26F396"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-6FDB6BC3-9AB7-5C04-A003-7EE0CD26F396"><!-- --></a>if (!(input.Peek()).IsDigit()) // found non-digit after decimal point if </pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B08D3122-C580-586F-8D62-75E75A1DC717"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B08D3122-C580-586F-8D62-75E75A1DC717"><!-- --></a><h2 class="sectiontitle">Moving past
a character that has been peeked</h2> <p>This shows the use of the <samp class="codeph">Inc()</samp> function
to move past a character that has been peeked:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F2F1A3B4-C42E-56F0-BA5C-2F9391CCD2FB"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F2F1A3B4-C42E-56F0-BA5C-2F9391CCD2FB"><!-- --></a>if (input.Peek() == '-') 
    {
    input.Inc() ;        // move past minus sign &amp; flag
    negative = ETrue ;
    }</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BF5B871F-CAFF-50A9-8833-A79CFCC7D3AC"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BF5B871F-CAFF-50A9-8833-A79CFCC7D3AC"><!-- --></a><h2 class="sectiontitle">Restoring a
previously “got” character</h2> <p>This shows the use of <samp class="codeph">UnGet()</samp> to
restore the previously "got" character.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-8E6CACEE-5FEA-511D-B61C-9D4E99C9F1B8"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-8E6CACEE-5FEA-511D-B61C-9D4E99C9F1B8"><!-- --></a>....
if (input.Offset() &gt; 0)    // if not at start of line
    {
    input.UnGet() ;        // restore 'got' character
    }</pre>
 <p>If the previous character is before the start of the
string, then the function raises a USER 59 panic for the <samp class="codeph">TLex8</samp> variant
and a USER 64 panic for the <samp class="codeph">TLex16</samp> variant.</p>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-7B2BD371-C21F-547E-8ACE-682532C0562A"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-7B2BD371-C21F-547E-8ACE-682532C0562A"><!-- --></a><h2 class="sectiontitle">Reset the next
character to the supplied mark</h2> <p>This shows how to allow part of
a <samp class="codeph">TLex</samp> can be parsed again:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BC84B544-599D-5A96-ACB0-7C38D1E14DBA"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-BC84B544-599D-5A96-ACB0-7C38D1E14DBA"><!-- --></a>if (!(input.Peek()).IsDigit())
    {
    // found non-digit after decimal point. Error, so rewind 
    input.UnGetToMark(startMark);
    }</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-D167B57E-2F96-556F-9F72-3168CC1566C6"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-D167B57E-2F96-556F-9F72-3168CC1566C6"><!-- --></a><h2 class="sectiontitle">Skipping any
non-white space to get the next token</h2> <p>This parses a <samp class="codeph">TLex</samp> for
the next token:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-EEA10D9C-5398-54B9-A3A2-F4AC2B972AEF"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-EEA10D9C-5398-54B9-A3A2-F4AC2B972AEF"><!-- --></a>input.Mark() ;                      // remember where we are
input.SkipCharacters() ;            // move to end of character token
if ( input.TokenLength() != 0 )     // if valid potential token
...</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B478FB61-512C-5EEF-8230-210912F0754B"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-B478FB61-512C-5EEF-8230-210912F0754B"><!-- --></a><h2 class="sectiontitle">Getting length
of a token</h2> <p>This shows how <samp class="codeph">TokenLength()</samp> is used
to return the difference between the position of the next character and the
extraction mark. This gives a check as to whether the token length is valid.
An invalid token length implies an invalid token.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-36BDDC14-4FCF-5D2E-B0F0-203BEFA47378"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-36BDDC14-4FCF-5D2E-B0F0-203BEFA47378"><!-- --></a>
if ( input.TokenLength() != 0 )  // if valid token length
...</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-526E40C0-F8A5-5AC6-B71C-812BE5AAB117"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-526E40C0-F8A5-5AC6-B71C-812BE5AAB117"><!-- --></a><h2 class="sectiontitle">Extracting
a token</h2> <p>This extracts a marked token.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-448E1246-E7A1-52E7-A459-D076F9C3901C"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-448E1246-E7A1-52E7-A459-D076F9C3901C"><!-- --></a>TPtrC token = input.MarkedToken() ;  // extract token </pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-37221F35-E851-5F6C-A743-A3A5C740DB8E"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-37221F35-E851-5F6C-A743-A3A5C740DB8E"><!-- --></a><h2 class="sectiontitle">Getting the
offset of next character position</h2> <p>This shows how to return the
offset of the next character position from the start of the string.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-83C68224-6D43-542D-9B39-F6EF1FE43898"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-83C68224-6D43-542D-9B39-F6EF1FE43898"><!-- --></a>if (input.Offset() &gt; 0)    // if not at start of line
    {
    input.UnGet() ;        // restore 'got' character
    ...
    }</pre>
 </div>

<div class="section" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-037C75EE-CF00-518A-92E4-89C3BD593737"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-037C75EE-CF00-518A-92E4-89C3BD593737"><!-- --></a><h2 class="sectiontitle">Extracting
an unknown number type</h2> <p>This example shows how to return the offset
of the next character position from the start of the string.</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F510C1CB-1CF1-5816-BF83-B016ABF76429"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-F510C1CB-1CF1-5816-BF83-B016ABF76429"><!-- --></a>if (input.Val(extractUint) == KErrNone)
    {
    stack.Push(TReal(extractUint)) ;
    }
else 
    {
    if (input.Val(extractReal) == KErrNone)
        {
        stack.Push(extractReal) ;
        }
    }</pre>
 <p>This extracts an unknown number type. Tries an integer
first and then, if this fails, tries a real:</p>
 <pre class="codeblock" id="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-2A9076F2-98C9-59A8-A3C7-F03A19A5B7E8"><a name="GUID-D86B83B5-298E-510A-B984-7307CCA1AE1C__GUID-2A9076F2-98C9-59A8-A3C7-F03A19A5B7E8"><!-- --></a>if (input.Val(extractUint) == KErrNone)
    stack.Push(TReal(extractUint)) ;
else if (input.Val(extractReal) == KErrNone)
    stack.Push(extractReal) ;
</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D4A78D68-0812-532C-9AF9-85F1483EF3EA.html" title="Topics related to the lexical analysis classes and how to use them.">Using Lexical Analysis</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>