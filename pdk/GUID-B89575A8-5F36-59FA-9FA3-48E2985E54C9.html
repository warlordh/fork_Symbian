<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Dispatch Layer"/>
<meta name="abstract" content="This topic describes the dispatch layer of the Common TSY."/>
<meta name="description" content="This topic describes the dispatch layer of the Common TSY."/>
<meta name="DC.Relation" scheme="URI" content="GUID-D0395BA8-E197-5C2D-A9CD-F4FF021C5A8E.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D0395BA8-E197-5C2D-A9CD-F4FF021C5A8E.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Dispatch Layer</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2563496 id2562268 id2562240 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html" title="Cellular Baseband Services provide a common interface to telephony services for applications and higher level platform components. The framework is independent of the underlying network services.">Cellular Baseband Services Guide</a> &gt; <a href="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html" title="Telephony server plug-ins translate modem messages into Symbian platform types. Symbian platform provides interfaces which must be implemented in the TSY for effective communication between the modem and Symbian platform. This section describes the telephony server plug-ins (TSYs).">Telephony Server Plug-ins</a> &gt; <a href="GUID-D0395BA8-E197-5C2D-A9CD-F4FF021C5A8E.html" title="This topic gives the conceptual information for telephony server plug-ins.">Concepts</a> &gt; </div>
<h1 class="topictitle1">Dispatch Layer</h1>
<div><p>This topic describes the dispatch layer of the Common TSY. </p>
<p>The dispatch layer is a shim between the Common TSY and the Licensee TSY. The dispatch layer is implemented by the library <samp class="codeph">ctsydispatcher.dll</samp>. </p>
 <p>The dispatch layer provides: </p>
 <ul><li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-D5446064-895F-5348-B1F4-DEE76FC69155"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-D5446064-895F-5348-B1F4-DEE76FC69155"><!-- --></a><p>An interface based on the functional units of the common TSY. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-AE93688F-11BD-5E3D-969F-693364276329"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-AE93688F-11BD-5E3D-969F-693364276329"><!-- --></a><p>Packing and unpacking of the messages between the Common TSY and the Licensee TSY </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8A475921-152F-5EC5-97A6-20CEC26F8C60"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8A475921-152F-5EC5-97A6-20CEC26F8C60"><!-- --></a><p>Simple input and output parameters for the Licensee TSY </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8F99EF64-16A1-5BFC-8CA3-145DF45222C7"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8F99EF64-16A1-5BFC-8CA3-145DF45222C7"><!-- --></a><p>Call-back functions for the Licensee TSY to send the updates and status messages to the Common TSY. </p>
 </li>
 </ul>
 <div class="section"><h2 class="sectiontitle">Message Manager </h2> <p>The messages from the CTSY are passed to the dispatch layer by the <a href="GUID-5C84AC6D-36A5-3439-990A-CD781990755F.html"><span class="apiname">CMmMessageManagerBase</span></a> functions. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Message Router</h2> <p>The message router receives the request messages from the CTSY and forwards them to the appropriate dispatcher. The dispatch layer contains many dispatcher classes based on the functional units. </p>
 </div>
 <div class="section" id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-162746DD-E2E2-548F-8026-5C4281BF0CC5"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-162746DD-E2E2-548F-8026-5C4281BF0CC5"><!-- --></a><h2 class="sectiontitle">Dispatcher Classes</h2> <p>The Common TSY with the dispatch layer decreases the time to develop a Licensee TSY. The dispatch layer contains the <a href="GUID-A833178C-8682-3BE0-B8E2-704D38B43260.html"><span class="apiname">CMessageRouter</span></a> and provides the factory class <a href="GUID-C174E22A-FDDE-3221-96F8-7D4857685765.html"><span class="apiname">CLtsyFactoryV1</span></a>. The dispatch layer also contains the dispatchers. </p>
 <p>The main role of the dispatcher is to handle the messages between the message router and the LTSY. The factory class is responsible for creating the required handlers. The dispatcher is responsible for packing the call-back messages from the LTSY and unpacking the messages from the message router for passage to the LTSY. There is a dispatcher class for each functional unit such as SMS, Phone or Cell Broadcast. The following table describes the dispatcher class for each functional unit: </p>
 
<div class="tablenoborder"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-F56DA6FA-4BC0-5D20-959F-D2EED10DD437"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-F56DA6FA-4BC0-5D20-959F-D2EED10DD437" frame="border" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" id="d1691610e90">Functional Unit</th>
 <th class="cellrowborder" valign="top" id="d1691610e93">Dispatcher class name</th>
 </tr>
 </thead>
 <tbody><tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Call Control </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-F8259252-D4AA-3CDD-A5BA-A989CE2D0DED.html"><span class="apiname">CCallControlDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Phone </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-1A334DF3-7F9F-3AA0-A9B0-1BD8FDDAB266.html"><span class="apiname">CPhoneDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Security </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-F749FCEE-5329-3153-B098-E72169A11E9E.html"><span class="apiname">CSecurityDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Cell Broadcast </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-CBB02AC5-7B2B-35F6-BA63-E7FD5817043E.html"><span class="apiname">CCellBroadcastDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Own Number Phonebook Store </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-BDADFE44-05BB-39A2-88B4-5D25D7292D6A.html"><span class="apiname">CPhonebookOnDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Phonebook store </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-91FEED1E-4427-373E-906E-B821793793E9.html"><span class="apiname">CPhonebookDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Emergency Number Phonebook Store </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-CDB57F73-06A5-308E-B575-E54DA042A648.html"><span class="apiname">CPhonebookEnDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>SIM </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-E0B6CFCC-7698-300A-8B47-71A41E73F764.html"><span class="apiname">CSimDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>SMS </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-CC30E7AD-B999-36BE-B34A-656796E35981.html"><span class="apiname">CSmsDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Multiparty Call </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-DC362538-01D4-3C04-9078-190878B155A5.html"><span class="apiname">CCallControlMultipartyDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Supplementary Services </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-110285FA-074E-37AF-961E-3E398313ADF2.html"><span class="apiname">CSupplementaryServicesDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>Packet Data Services </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-A92D9B8B-9CE5-3A2F-AF3E-F47257D3D68A.html"><span class="apiname">CPacketServicesDispatcher</span></a>  </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1691610e90 "><p>SIM Application Toolkit </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1691610e93 "><p> <a href="GUID-FE2C28F2-7F09-3F9A-A8B8-887B66408D74.html"><span class="apiname">CSatDispatcher</span></a>  </p>
 </td>
 </tr>
 </tbody>
 </table>
</div>
 <div class="fignone" id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-19D474AD-4B7B-5160-AA33-3EDD37D73C1B"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-19D474AD-4B7B-5160-AA33-3EDD37D73C1B"><!-- --></a><span class="figcap">Figure 1. 
             Example Sequence flow between the CTSY Dispatcher and LTSY 
          </span> <img src="GUID-BCD83E02-9645-530C-8BD9-CCA1B8756842_d0e56948_href.png"/></div>
 <p> <a href="GUID-E6BE8260-066E-3E95-856A-7CE50D955E71.html"><span class="apiname">CCtsyDispatcherCallback</span></a> class provides the methods to the LTSY to send the status and service complete messages to the CTSY. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">CTSY Requests</h2> <a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-68B4FB4D-7206-5117-ADF0-E8DAF841B421"><!-- --></a><ol id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-68B4FB4D-7206-5117-ADF0-E8DAF841B421"><li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-F7BBA32A-A15D-5F27-9640-9367C425CADA"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-F7BBA32A-A15D-5F27-9640-9367C425CADA"><!-- --></a><p>The dispatch layer provides the interface between the CTSY and LTSY. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-C38905CD-9823-54C4-AD09-40943E951568"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-C38905CD-9823-54C4-AD09-40943E951568"><!-- --></a><p>The telephony client requests the services from the telephony server. </p>
 <p>The telephony applications request the telephony services like request for a voice call, data call or a fax call. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-768ECE92-7F5A-5A58-AF97-BB1D45FB1C88"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-768ECE92-7F5A-5A58-AF97-BB1D45FB1C88"><!-- --></a><p>The telephony server sends the request to the CTSY. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8AF0F109-51A2-5781-9A6A-8663FBDE76B2"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-8AF0F109-51A2-5781-9A6A-8663FBDE76B2"><!-- --></a><p>The CTSY sends the requests to the dispatch layer. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-A4A5ACBD-AE49-5293-AAC4-B07052EFF067"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-A4A5ACBD-AE49-5293-AAC4-B07052EFF067"><!-- --></a><p>The dispatch layer unpacks the request message and calls the methods in the LTSY to service the telephony client request. </p>
 </li>
 </ol>
 <p>The LTSY must implement the interfaces of the dispatch layer to accept the client requests. The implementation depends on the baseband design. If a telephony client request is not available or not implemented in the device <a href="GUID-F89DA3F0-2A48-3F9B-8F08-29350E92D0E4.html"><span class="apiname">KErrNotSupported</span></a> or a similar error is returned to the clients. </p>
 <p>The functions calls to the LTSY have a standard convention: </p>
 <pre class="codeblock" id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-6A379B2B-D4D1-5828-BE9C-3164BFF09A52"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-6A379B2B-D4D1-5828-BE9C-3164BFF09A52"><!-- --></a>TInt Handle&lt;FuncDesc&gt;&lt;Type&gt;(&lt;arg list&gt;); </pre>
 <ul><li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-4C4BC6B3-CC3E-5810-B2D0-DF39A6381807"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-4C4BC6B3-CC3E-5810-B2D0-DF39A6381807"><!-- --></a><p> <a href="GUID-7A2A43EC-6125-3BFE-834B-23C37F7B40D5.html"><span class="apiname">TInt</span></a> is the return code </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-90C415B6-4094-593F-9CFD-B45CF72C9A76"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-90C415B6-4094-593F-9CFD-B45CF72C9A76"><!-- --></a><p> <samp class="codeph">FuncDec</samp> describes the function call </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-D6FD8D94-E9B0-5493-AF10-4C6FA5B79AFB"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-D6FD8D94-E9B0-5493-AF10-4C6FA5B79AFB"><!-- --></a><p> <samp class="codeph">Type</samp> is <strong>Sync</strong> for synchronous calls or <strong>Req</strong> for asynchronous request messages. </p>
 </li>
 </ul>
 </div>
 <div class="section"><h2 class="sectiontitle">Call-back Functions</h2> <p>The <a href="GUID-E6BE8260-066E-3E95-856A-7CE50D955E71.html"><span class="apiname">CCtsyDispatcherCallback</span></a> class functions provide the interface for the LTSY to communicate with the dispatch layer. A pointer to this instance is passed to the LTSY. All <samp class="codeph">Req</samp> type calls from the dispatch layer must be accompanied by a call-back function call. The call-back functions are called by the LTSY to notify completion of a request or to update a status. The dispatch layer packs the request messages with the data. The data contains the request command parameters from the telephony server client. An example of a request command is to dial a number. </p>
 <p>The call-back functions have a standard name convention: </p>
 <pre class="codeblock" id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-DF7213F5-C6F0-56F1-9BFC-1EFD9A2C86CA"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-DF7213F5-C6F0-56F1-9BFC-1EFD9A2C86CA"><!-- --></a>void Callback&lt;FuncDesc&gt;&lt;Type&gt;(&lt;arg list&gt;); </pre>
 <ul><li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-95B95C7D-D575-592C-81F5-7B08D06809F7"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-95B95C7D-D575-592C-81F5-7B08D06809F7"><!-- --></a><p> <samp class="codeph">FuncDesc</samp> is the description of the call-back function such as <samp class="codeph">GetHomeNetwork</samp>. </p>
 </li>
 <li id="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-37EB2A20-1003-5D27-AEB2-96F234FDC6B7"><a name="GUID-B89575A8-5F36-59FA-9FA3-48E2985E54C9__GUID-37EB2A20-1003-5D27-AEB2-96F234FDC6B7"><!-- --></a><p> <samp class="codeph">Type</samp> is either <strong>Comp</strong> or <strong>Ind</strong>. <samp class="codeph"/>  </p>
 <p> <samp class="codeph">Comp</samp> is used in the call-back functions that notify a request is complete. <samp class="codeph">Ind</samp> is used in the call-back functions that notify events to the CTSY. The call-back function with <samp class="codeph">IND</samp> prefix are unsolicited. </p>
 </li>
 </ul>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D0395BA8-E197-5C2D-A9CD-F4FF021C5A8E.html" title="This topic gives the conceptual information for telephony server plug-ins.">Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>