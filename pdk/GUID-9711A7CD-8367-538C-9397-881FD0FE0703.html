<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="How to send location to a remote party"/>
<meta name="abstract" content="This document describes how to send a location to a remote party."/>
<meta name="description" content="This document describes how to send a location to a remote party."/>
<meta name="DC.Relation" scheme="URI" content="GUID-90757A79-A001-52BF-81D9-CFA02FDDE1BE.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-710BC22B-E4F0-5E16-B970-E2D21F5571FC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CE970F0F-C922-516F-9D7E-EA1F4754A205.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-90757A79-A001-52BF-81D9-CFA02FDDE1BE.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-9711A7CD-8367-538C-9397-881FD0FE0703"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>How to send location to a remote party</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2402671 id2402731 id2402918 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-710BC22B-E4F0-5E16-B970-E2D21F5571FC.html" title="The Location Request Management collection contains components that handle requests for location request information both from installed applications and from the network.">Location Request Management</a> &gt; <a href="GUID-CE970F0F-C922-516F-9D7E-EA1F4754A205.html" title="The Network Request Handler processes privacy and location requests received from the network.">Network Request Handler</a> &gt; <a href="GUID-90757A79-A001-52BF-81D9-CFA02FDDE1BE.html">Sending location to a remote party</a> &gt; </div>
<h1 class="topictitle1"> How to send location to a remote party</h1>
<div><p>This document describes how to send a location to a remote party. </p>
<div class="section"><h2 class="sectiontitle">Purpose</h2> <p>This document explains how to send a mobile device's location to a remote party using the <a href="GUID-33BACB23-5BEB-5A1A-85B2-71E6AA7730C4.html" title="LBS allows a user to send their location to a remote party over a network.">Transmit Location API</a>. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Sending position to a remote party</h2> <p>To send location to a remote party, a client application: </p>
 <ul><li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-ED193E6D-2880-51EB-9B44-FFAD0166289F"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-ED193E6D-2880-51EB-9B44-FFAD0166289F"><!-- --></a><p>Creates a session with the transmit position server </p>
 </li>
 <li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-B3C319A2-F8CD-532D-AD3E-D3161DCA3C40"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-B3C319A2-F8CD-532D-AD3E-D3161DCA3C40"><!-- --></a><p>Sets a timeout period (if required) </p>
 </li>
 <li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-40D40FD8-AFA6-533D-AE8F-50A28F3BBE86"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-40D40FD8-AFA6-533D-AE8F-50A28F3BBE86"><!-- --></a><p>Makes a request on the transmit position server to send location data </p>
 </li>
 <li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-64D0D738-73CE-5F8D-BC83-C5B569FEB935"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-64D0D738-73CE-5F8D-BC83-C5B569FEB935"><!-- --></a><p>Receives notification of the request success, failure or timeout (notification of receipt of assistance data from the network may be received if required). </p>
 </li>
 <li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-9E721B7A-958F-53D9-957A-7572E467F369"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-9E721B7A-958F-53D9-957A-7572E467F369"><!-- --></a><p>Closes the server session </p>
 </li>
 </ul>
 <p>Applications that use the Transmit Location API include <span class="filepath">LbsX3P.h</span> and link with <span class="filepath">Lbsx3p.lib</span> and must have the <samp class="codeph">Location</samp> and <samp class="codeph">NetworkServices</samp> capabilities. </p>
 <p><strong>Creating a session and subsession </strong> </p>
 <p>To create a session to send location data, a client application: </p>
 <ul><li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-F2786423-825F-5BBB-8FF9-848A4089DEDF"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-F2786423-825F-5BBB-8FF9-848A4089DEDF"><!-- --></a><p>Makes a connection to the transmit position server by calling <a href="GUID-97CFE236-9DAD-3455-8969-6D0B4C484E0B.html#GUID-97CFE236-9DAD-3455-8969-6D0B4C484E0B__GUID-F7EAB107-1581-3E38-8C18-91AE8410C906"><span class="apiname">RLbsTransmitPositionServer::Connect()</span></a> to create a server session. </p>
 </li>
 <li id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-366DC232-01C6-57C1-BD73-CAE615BC5590"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-366DC232-01C6-57C1-BD73-CAE615BC5590"><!-- --></a><p>Makes a subsession by calling <a href="GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF.html#GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF__GUID-E6EBB988-6822-364D-A0B8-100DA0DCE232"><span class="apiname">RLbsTransmitPosition::Open()</span></a>, passing the <samp class="codeph">RLbsTransmitPositionServer</samp> reference as a parameter. </p>
 </li>
 </ul>
 <p>This is the standard procedure for using a Symbian server, shown in the code example below. </p>
 <pre class="codeblock" id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-4986D56D-E27A-54A0-A3F9-981F5144B76E"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-4986D56D-E27A-54A0-A3F9-981F5144B76E"><!-- --></a>
#include &lt;lbsx3p.h&gt;
#include &lt;lbspositioninfo.h&gt;

RLbsTransmitPositionServer server;
RLbsTransmitPosition transmitter;
    
User::LeaveIfError(server.Connect());
CleanupClosePushL(server);
    
User::LeaveIfError(transmitter.Open(server));
CleanupClosePushL(transmitter);

...
</pre>
 <p><strong>Setting a timeout period </strong> </p>
 <p>A client application can set a timeout period if required. If the LBS subsystem is unable to send location data before the timeout, then the client request is cancelled. </p>
 <p>The code fragment below sets a timeout of 5 seconds. </p>
 <pre class="codeblock" id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-85B5B4DF-DD3F-55D6-9E0E-C8ECE3E2A8C7"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-85B5B4DF-DD3F-55D6-9E0E-C8ECE3E2A8C7"><!-- --></a>
TLbsTransmitPositionOptions transmitPositionOptions(5000000);
transmitter.SetTransmitOptions(transmitPositionOptions);

...
</pre>
 <p><strong>Sending the location </strong> </p>
 <p>An application must specify the destination to which the location is to be sent. The destination is specified when the location data is sent by calling <a href="GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF.html#GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF__GUID-EB88EBE8-0B6A-359C-895C-15D063CAD4AA"><span class="apiname">RLbsTransmitPosition::TransmitPosition()</span></a>. </p>
 <p>See <a href="GUID-33BACB23-5BEB-5A1A-85B2-71E6AA7730C4.html" title="LBS allows a user to send their location to a remote party over a network.">Sending location to a remote party</a> for more details about the two <samp class="codeph">TransmitPosition()</samp> methods. In the code example below, the simplest method is used that notifies only when the final calculated location is sent to the network. </p>
 <pre class="codeblock" id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-2DC7D886-10D3-5BEF-BCAE-34943AFCA3FF"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-2DC7D886-10D3-5BEF-BCAE-34943AFCA3FF"><!-- --></a>    
// Transmit location to remote party
    
TRequestStatus status;
TPositionInfo posInfo;
    
// Use an email address as the destination in this example
// A contact phone number could also be used

_LIT(destination, "someone@somewhere.com");
TInt priority = 0;
    
// Transmit location 
transmitter.TransmitPosition(destination, priority, status, posInfo);

// Simple example of waiting on this thread...
User::WaitForRequest(status);
    
if (status != KErrNone)
 {
 if (status == KErrTimedOut)
  {
  // Handle timeout...
  }
  else 
  {
  // Handle other possible errors...
  } 
 }

...
</pre>
 <p><strong>Cancelling a request </strong> </p>
 <p>A request can be cancelled by calling <a href="GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF.html#GUID-10A380F1-7550-336E-BAE4-8CB889C5BACF__GUID-C7DC5CEC-A96C-3FBD-A0F5-FB986EC912DE"><span class="apiname">RLbsTransmitPosition::CancelTransmitPosition()</span></a>. When a request is cancelled, the <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html"><span class="apiname">TRequestStatus</span></a> variable is set to <samp class="codeph">KErrCancel</samp>. Note however, that the location may still be sent to the network soon after <samp class="codeph">CancelTransmitPosition()</samp> is called. </p>
 <p><strong>Closing the server session </strong> </p>
 <p>The server session should be closed when the application has finished sending location data to remote parties. The code example below uses the cleanup stack methods to do the cleanup. </p>
 <pre class="codeblock" id="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-F6F21180-8DE7-52B1-8C14-D6322EE12AF3"><a name="GUID-9711A7CD-8367-538C-9397-881FD0FE0703__GUID-F6F21180-8DE7-52B1-8C14-D6322EE12AF3"><!-- --></a>
CleanupStack::PopAndDestroy(&amp;transmitter);
CleanupStack::PopAndDestroy(&amp;server);
</pre>
 </div>
 <div class="section"><h2 class="sectiontitle">See also</h2> <p><a href="GUID-33BACB23-5BEB-5A1A-85B2-71E6AA7730C4.html" title="LBS allows a user to send their location to a remote party over a network.">Sending location to a remote party</a>  </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-90757A79-A001-52BF-81D9-CFA02FDDE1BE.html">Sending location to a remote party</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>