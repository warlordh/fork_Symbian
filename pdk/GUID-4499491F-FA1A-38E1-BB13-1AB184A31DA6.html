<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="RSendAsMessage"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6"/>

<title>RSendAsMessage</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6"><a name="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2366708 id2382304 id2382309 id2382806 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">RSendAsMessage Class Reference</h1>
	<table class="signature"><tr><td>class RSendAsMessage : public RSubSessionBase</td></tr></table><div class="section"><div>
			<p>Encapsulates creating and sending a message. This class requires a connected <a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html#GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3">RSendAs</a> session.</p>

			<p>A client application can have several <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> objects created simultaneously. Each <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> object corresponds to a single message.</p>

			<p>With the <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> class, a client application can perform the following operations:</p>

			<p>-Creating and managing a message</p>

			<p>-Modifying a message created using SendAs</p>

			<p>-Sending a message</p>

			<p>-Launching a message editor</p>

			<p>Client applications do not require any capabilities in order to use the <a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html#GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3">RSendAs</a> and <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> APIs. However, if an application does not have the necessary security capabilities to send a message, the SendAs server ensures that a message is only sent after the user's authorization.</p>

			<p>A message created using <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> can be saved, sent, or passed to the appropriate message editor. There are two types of send operation:</p>

			<p>-A confirmed send is forwarded to the UI MTM for the message type. Typically this results in the user being asked to confirm that the message should be sent.</p>

			<p>-An unconfirmed send fails if the client application does not have the required capabilities to use the server MTM for the message type.</p>

			<p>There are asynchronous and synchronous forms of these sending methods. Progress information for sending is available when the asynchronous forms are used. The synchronous forms, and the methods for saving the message and for launching it in a message editor, all close the handle to the <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a>, so the message cannot be further accessed through the API.</p>

		</div></div>
<div class="section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">RSendAsMessage<ul class="derivation"><li class="derivation-depth-1 "><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase</a></li></ul></li></ul></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-4D7688B5-297C-3A09-8891-30E7D2B7923C">AddAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-12AA1D25-93EF-3A80-94D3-CD42322A7B23">AddAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-0AA3E811-DA6F-3CB1-84E9-5268A12C510C">AddAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-C446339D-7604-3B04-9CE7-93851756F18E">AddAttachment</a>(<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-7804100A-4858-32EF-A5A8-906D8E4DA748">AddAttachment</a>(<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-919D0088-A3AA-31D2-A2A0-316393C7B581">AddAttachment</a>(<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-767F2DEE-2A26-376B-AC3F-4EF9C62A3152">AddLinkedAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-6AD58E14-0E45-37ED-A577-233C5B848904">AddLinkedAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-939CDC50-84F9-3615-9B84-E3D96FF2330C">AddLinkedAttachment</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-106A7A1C-023B-33EB-8925-859E2088FF24">AddRecipientL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-18EBDC5D-2228-3653-A1B1-478787CE29E3">AddRecipientL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-4A46E558-5AFD-3616-9C81-A5017A6DF449">Cancel</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-85ADBF17-4791-3D52-B268-1411FB178868">Close</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-34160CDB-A261-323A-8926-29D412E58336">CreateAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-ACAB8A66-1522-3CC5-9C36-270EA1AE4A35">CreateAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-272C6B8A-A84E-36ED-94EA-1D6D14FE6C31">CreateAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-F5C5023D-0066-3DD7-BFFA-CCA8E0DD1C76">CreateL</a>(<a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp;, <a href="GUID-1841BD94-1E7F-37D5-BE9A-82F5E82B7D2E.html">TSendAsAccount</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-E5A5B44A-A445-3398-B95C-337F2E4F57B7">CreateL</a>(<a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp;, <a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-FAAB36A9-38D3-343C-BC53-79CF19D82D8A">LaunchEditorAndCloseL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-64502A50-A2F7-3586-9895-1A5F37385D1D">ProgressL</a>(<a href="GUID-BF79BFDA-DCD4-3A88-8B84-390B51B68C8E.html">TSendAsProgress</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-1471DA21-5334-3A0D-8B17-CF53A3FB7DA2">SaveMessageAndCloseL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-E0A4DCD2-DAB4-3269-BC69-D101A7C322C5">SendMessage</a>(<a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-8C95AFCB-0A37-3D1D-AA9A-489FCEEA0959">SendMessageAndCloseL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-3732CF5E-5AE6-3C39-9226-E3986EE2896B">SendMessageConfirmed</a>(<a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-E61E15A0-E835-3A23-94B7-D65F7198D27E">SendMessageConfirmedAndCloseL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-3B2C307A-C616-3FC2-BCDC-9BB2045098DF">SetBioTypeL</a>(<a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-22E37DB6-35A2-3B01-A785-189B92A7E8D4">SetBodyTextL</a>(const <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html">CRichText</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-A56A1795-83C4-3FDF-9171-DA937334317E">SetBodyTextL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-46F13DC4-BB6F-3614-894E-1B344D16AF56">SetCharacterSetL</a>(const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-A3C4018D-BBF4-34FF-B995-8ACBBB97200C">SetSubjectL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;)</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::CloseSubSession(TInt)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::CreateAutoCloseSubSession(RSessionBase &amp;,TInt,const TIpcArgs &amp;)</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::CreateSubSession(const RSessionBase &amp;,TInt)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::CreateSubSession(const RSessionBase &amp;,TInt,const TIpcArgs &amp;)</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::RSubSessionBase()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::Send(TInt)const</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::Send(TInt,const TIpcArgs &amp;)const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::SendReceive(TInt)const</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::SendReceive(TInt,TRequestStatus &amp;)const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::SendReceive(TInt,const TIpcArgs &amp;)const</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::SendReceive(TInt,const TIpcArgs &amp;,TRequestStatus &amp;)const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::Session()const</a></td></tr><tr><td> </td><td><a href="GUID-1BBE1448-1DF8-33C4-BF9E-5A5F427AEE35.html">RSubSessionBase::SubSessionHandle()const</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Enumerations</th></tr></thead><tbody><tr><td align="right" valign="top">enum</td><td><a href="#GUID-1F91799F-CF68-3D4F-8CA9-7124E66CAC05">TSendAsRecipientType</a> { <a href="#GUID-0E5D9C0A-E7AE-3913-A50C-6F8A8A2213FA">ESendAsRecipientTo</a> = EMsvRecipientTo, <a href="#GUID-8567974B-E5C2-391D-8604-70194F591BBF">ESendAsRecipientCc</a>, <a href="#GUID-AB333231-86E2-3AD0-8329-30D206E0C96F">ESendAsRecipientBcc</a> }</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Private Attributes</th></tr></thead><tbody><tr><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *</td><td><a href="#GUID-E3EB5F9D-BB19-3728-9267-2A77F1A070B9">iAny</a></td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Member Functions Documentation</h1><div class="nested1" id="GUID-4D7688B5-297C-3A09-8891-30E7D2B7923C"><a name="GUID-4D7688B5-297C-3A09-8891-30E7D2B7923C"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(const TDesC &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aCharset,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>A copy of the specified file is attached to message.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as an attachment. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aCharset</td><td>The charset for this attachment. The value is a standard IANA charset. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-12AA1D25-93EF-3A80-94D3-CD42322A7B23"><a name="GUID-12AA1D25-93EF-3A80-94D3-CD42322A7B23"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(const TDesC &amp;, const TDesC8 &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>A copy of the specified file is attached to message.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as an attachment. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-0AA3E811-DA6F-3CB1-84E9-5268A12C510C"><a name="GUID-0AA3E811-DA6F-3CB1-84E9-5268A12C510C"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(const TDesC &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message. The attachment is copied into the message store from the supplied filename.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as an attachment. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-C446339D-7604-3B04-9CE7-93851756F18E"><a name="GUID-C446339D-7604-3B04-9CE7-93851756F18E"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(RFile &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aFile,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aCharset,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>A copy of the specified file is attached to message.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aFile</td><td>The file being added to the message as an attachment. The file is closed if attached successfully. Ownership is transferred .The caller must close the file handle. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aCharset</td><td>The charset for this attachment. The value is a standard IANA charset. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-7804100A-4858-32EF-A5A8-906D8E4DA748"><a name="GUID-7804100A-4858-32EF-A5A8-906D8E4DA748"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(RFile &amp;, const TDesC8 &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aFile,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>A copy of the specified file is attached to message.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aFile</td><td>The file being added to the message as an attachment. Ownership is transferred .The caller must close the file handle. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-919D0088-A3AA-31D2-A2A0-316393C7B581"><a name="GUID-919D0088-A3AA-31D2-A2A0-316393C7B581"><!-- --></a>
		<h2 class="topictitle2">AddAttachment(RFile &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachment</td><td>(</td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aFile,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message. The attachment is copied into the message store from the supplied file.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aFile</td><td>The file being added to the message as an attachment. Ownership is transferred .The caller must close the file handle. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-767F2DEE-2A26-376B-AC3F-4EF9C62A3152"><a name="GUID-767F2DEE-2A26-376B-AC3F-4EF9C62A3152"><!-- --></a>
		<h2 class="topictitle2">AddLinkedAttachment(const TDesC &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddLinkedAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aCharset,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message. The attachment is linked to the message from the supplied filename. This file must be present when the message is sent.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as a linked attachment. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aCharset</td><td>The charset for this attachment. The value is a standard IANA charset. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-6AD58E14-0E45-37ED-A577-233C5B848904"><a name="GUID-6AD58E14-0E45-37ED-A577-233C5B848904"><!-- --></a>
		<h2 class="topictitle2">AddLinkedAttachment(const TDesC &amp;, const TDesC8 &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddLinkedAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>The attachment is linked to the message from the supplied filename. This file must be present when the message is sent.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as a linked attachment. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-939CDC50-84F9-3615-9B84-E3D96FF2330C"><a name="GUID-939CDC50-84F9-3615-9B84-E3D96FF2330C"><!-- --></a>
		<h2 class="topictitle2">AddLinkedAttachment(const TDesC &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddLinkedAttachment</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add an attachment to this message asynchronously.</p>

				<p>The attachment is linked to the message from the supplied filename. This file must be present when the message is sent.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The file name and path for the file being added to the message as a linked attachment. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-106A7A1C-023B-33EB-8925-859E2088FF24"><a name="GUID-106A7A1C-023B-33EB-8925-859E2088FF24"><!-- --></a>
		<h2 class="topictitle2">AddRecipientL(const TDesC &amp;, TSendAsRecipientType)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddRecipientL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aAddress,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a></td><td>aRecipientType</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add a recipient to this message. The recipient's address is held in a descriptor, and is in the correct format for the message type.</p>

				<p>The recipient type is one of the TSendAsRecipientType constants, currently one of: ESendAsRecipientTo - The recipient goes in the 'To' field. ESendAsRecipientCc - The recipient goes in the 'Cc' field. ESendAsRecipientBcc - The recipient goes in the 'Bcc' field.</p>

				<p>If the 'Cc' field is not supported, the recipient will instead be added to the 'To' field since these are functionally equivalent. If the 'Bcc' field is not supported, this method will return KErrNotSupported.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aAddress</td><td>A descriptor holding the address of the recipient to add. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a> aRecipientType</td><td>The recipient type of the address being added. See above.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-18EBDC5D-2228-3653-A1B1-478787CE29E3"><a name="GUID-18EBDC5D-2228-3653-A1B1-478787CE29E3"><!-- --></a>
		<h2 class="topictitle2">AddRecipientL(const TDesC &amp;, const TDesC &amp;, TSendAsRecipientType)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>AddRecipientL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aAddress,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aAlias,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a></td><td>aRecipientType</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Add a recipient with an alias to this message. The recipient's address is held in a descriptor, and is in the correct format for the message type. The alias is the displayed recipient name.</p>

				<p>The recipient type is one of the TSendAsRecipientType constants, currently one of: ESendAsRecipientTo - The recipient goes in the 'To' field. ESendAsRecipientCc - The recipient goes in the 'Cc' field. ESendAsRecipientBcc - The recipient goes in the 'Bcc' field.</p>

				<p>If the 'Cc' field is not supported, the recipient will instead be added to the 'To' field since these are functionally equivalent. If the 'Bcc' field is not supported, this method will return KErrNotSupported.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aAddress</td><td>A descriptor holding the address of the recipient to add. </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aAlias</td><td>A descriptor holding the address alias of the recipient to add. </td></tr><tr><td class="parameter"><a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html">TSendAsRecipientType</a> aRecipientType</td><td>The recipient type of the address being added. See above.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-4A46E558-5AFD-3616-9C81-A5017A6DF449"><a name="GUID-4A46E558-5AFD-3616-9C81-A5017A6DF449"><!-- --></a>
		<h2 class="topictitle2">Cancel()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>Cancel</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Cancels any asynchronous request.</p>

				<p>Only a single asynchronous request is supported at any one time. This method cancels the current requests if any. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-85ADBF17-4791-3D52-B268-1411FB178868"><a name="GUID-85ADBF17-4791-3D52-B268-1411FB178868"><!-- --></a>
		<h2 class="topictitle2">Close()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>Close</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Close an open message and delete it from the Drafts folder. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-34160CDB-A261-323A-8926-29D412E58336"><a name="GUID-34160CDB-A261-323A-8926-29D412E58336"><!-- --></a>
		<h2 class="topictitle2">CreateAttachmentL(const TDesC &amp;, RFile &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CreateAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFileName,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aAttachmentFile</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Create an attachment to this message. The <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> object should not be open when this method is called. On return, the supplied <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> is able to write into the file.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFileName</td><td>The filename to assign to the newly create attachment file. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aAttachmentFile</td><td>The RFile which on return will be opened on the newly created attachment.Ownership is transferred .The caller must close the file handle.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-ACAB8A66-1522-3CC5-9C36-270EA1AE4A35"><a name="GUID-ACAB8A66-1522-3CC5-9C36-270EA1AE4A35"><!-- --></a>
		<h2 class="topictitle2">CreateAttachmentL(const TDesC &amp;, RFile &amp;, const TDesC8 &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CreateAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFileName,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aAttachmentFile,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Create an attachment to this message. The <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> object should not be open when this method is called. On return, the supplied <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> is able to write into the file.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFileName</td><td>The filename to assign to the newly create attachment file. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aAttachmentFile</td><td>The RFile which on return will be opened on the newly created attachment.Ownership is transferred . The caller must close the file handle. </td></tr><tr><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-272C6B8A-A84E-36ED-94EA-1D6D14FE6C31"><a name="GUID-272C6B8A-A84E-36ED-94EA-1D6D14FE6C31"><!-- --></a>
		<h2 class="topictitle2">CreateAttachmentL(const TDesC &amp;, RFile &amp;, const TDesC8 &amp;, TUint)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CreateAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFileName,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aAttachmentFile,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aMimeType,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aCharset</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Create an attachment to this message. The <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> object should not be open when this method is called. On return, the supplied <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html#GUID-BE0804F6-4375-3C8A-8C83-968F510466E0">RFile</a> is able to write into the file.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFileName</td><td>The filename to assign to the newly create attachment file. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aAttachmentFile</td><td>The RFile which on return will be opened on the newly created attachment. Ownership is transferred .The caller must close the file handle.  </td></tr><tr><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aMimeType</td><td>The mime type for this attachment. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aCharset</td><td>The charset for this attachment. The value is a standard IANA charset.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-F5C5023D-0066-3DD7-BFFA-CCA8E0DD1C76"><a name="GUID-F5C5023D-0066-3DD7-BFFA-CCA8E0DD1C76"><!-- --></a>
		<h2 class="topictitle2">CreateL(RSendAs &amp;, TSendAsAccount)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CreateL</td><td>(</td><td><a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp;</td><td>aSendAs,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-1841BD94-1E7F-37D5-BE9A-82F5E82B7D2E.html">TSendAsAccount</a></td><td>aAccount</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Create a new message in the Drafts folder.</p>

				<p>The message type is implied by the type of the account used. The message can be modified or deleted by this object at any time up until the message is sent, deleted or opened in an editor.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp; aSendAs</td><td>The connection to the SendAs server. This RSendAs object must be connected. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-1841BD94-1E7F-37D5-BE9A-82F5E82B7D2E.html">TSendAsAccount</a> aAccount</td><td>An account obtained from the CSendAsAccounts helper class.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-E5A5B44A-A445-3398-B95C-337F2E4F57B7"><a name="GUID-E5A5B44A-A445-3398-B95C-337F2E4F57B7"><!-- --></a>
		<h2 class="topictitle2">CreateL(RSendAs &amp;, TUid)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>CreateL</td><td>(</td><td><a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp;</td><td>aSendAs,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a></td><td>aMessageType</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Create a new message in the Drafts folder.</p>

				<p>The message type is specified. The message can be modified or deleted by this object at any time up until the message is sent, deleted or opened in an editor.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-E1699CAB-423D-3AFA-BE77-3AFF38886EA3.html">RSendAs</a> &amp; aSendAs</td><td>The connection to the SendAs server. This RSendAs object must be connected. </td></tr><tr class="bg"><td class="parameter"><a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a> aMessageType</td><td>A message type obtained from the CSendAsMessageTypes helper class.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-FAAB36A9-38D3-343C-BC53-79CF19D82D8A"><a name="GUID-FAAB36A9-38D3-343C-BC53-79CF19D82D8A"><!-- --></a>
		<h2 class="topictitle2">LaunchEditorAndCloseL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>LaunchEditorAndCloseL</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Opens the message in the associated message editor for the message type. The <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> handle is closed, so that the message cannot be futher accessed through the object. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-64502A50-A2F7-3586-9895-1A5F37385D1D"><a name="GUID-64502A50-A2F7-3586-9895-1A5F37385D1D"><!-- --></a>
		<h2 class="topictitle2">ProgressL(TSendAsProgress &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>ProgressL</td><td>(</td><td><a href="GUID-BF79BFDA-DCD4-3A88-8B84-390B51B68C8E.html">TSendAsProgress</a> &amp;</td><td>aProgress</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Retrieve the progress information for this message. This method can be called at any time after message creation.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BF79BFDA-DCD4-3A88-8B84-390B51B68C8E.html">TSendAsProgress</a> &amp; aProgress</td><td>Progress information on current asynchronous operation.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-1471DA21-5334-3A0D-8B17-CF53A3FB7DA2"><a name="GUID-1471DA21-5334-3A0D-8B17-CF53A3FB7DA2"><!-- --></a>
		<h2 class="topictitle2">SaveMessageAndCloseL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SaveMessageAndCloseL</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Close an open message and save it in the Drafts folder. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-E0A4DCD2-DAB4-3269-BC69-D101A7C322C5"><a name="GUID-E0A4DCD2-DAB4-3269-BC69-D101A7C322C5"><!-- --></a>
		<h2 class="topictitle2">SendMessage(TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SendMessage</td><td>(</td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Asynchronously send this message. This method requests that the SendAs server send the message without prompting the user. This will only be allowed to happen if the caller holds sufficient capabilities to perform this action. If the caller does not hold these capabilities, then the message send will be automatically demoted to a confirmed send. The <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> API cannot modify the message if this method fails.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-8C95AFCB-0A37-3D1D-AA9A-489FCEEA0959"><a name="GUID-8C95AFCB-0A37-3D1D-AA9A-489FCEEA0959"><!-- --></a>
		<h2 class="topictitle2">SendMessageAndCloseL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SendMessageAndCloseL</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Sends this message in the background without confirmation and close the handle. This is a synchronous operation. This will only be allowed to happen if the caller holds sufficient capabilities to perform this action. If the caller does not hold these capabilities, then the message send will be automatically demoted to a confirmed send. The <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> API cannot modify or resend the message if this method fails. No progress information is available after calling this API. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-3732CF5E-5AE6-3C39-9226-E3986EE2896B"><a name="GUID-3732CF5E-5AE6-3C39-9226-E3986EE2896B"><!-- --></a>
		<h2 class="topictitle2">SendMessageConfirmed(TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SendMessageConfirmed</td><td>(</td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Asynchronously send this message. This method requests that the SendAs server send the message, prompting the user for confirmation. This functionality must be supported by the UI MTM for the selected message type. The <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> API cannot modify the message if this method fails.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-E61E15A0-E835-3A23-94B7-D65F7198D27E"><a name="GUID-E61E15A0-E835-3A23-94B7-D65F7198D27E"><!-- --></a>
		<h2 class="topictitle2">SendMessageConfirmedAndCloseL()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SendMessageConfirmedAndCloseL</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Sends this message in the background and close the handle to it. This is a synchronous operation. This method requests that the SendAs server send the message, prompting the user for confirmation. This functionality must be supported by the UI MTM for the selected message type. The <a href="GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6.html#GUID-4499491F-FA1A-38E1-BB13-1AB184A31DA6">RSendAsMessage</a> API cannot modify or resend the message if this method fails. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-3B2C307A-C616-3FC2-BCDC-9BB2045098DF"><a name="GUID-3B2C307A-C616-3FC2-BCDC-9BB2045098DF"><!-- --></a>
		<h2 class="topictitle2">SetBioTypeL(TUid)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SetBioTypeL</td><td>(</td><td><a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a></td><td>aBioType</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Set the BIO type of this message. The object must have an open message to use this method.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a> aBioType</td><td>The biotype for this message.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-22E37DB6-35A2-3B01-A785-189B92A7E8D4"><a name="GUID-22E37DB6-35A2-3B01-A785-189B92A7E8D4"><!-- --></a>
		<h2 class="topictitle2">SetBodyTextL(const CRichText &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SetBodyTextL</td><td>(</td><td>const <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html">CRichText</a> &amp;</td><td>aBody</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Set the body text of this message using a <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html#GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934">CRichText</a> object. The object must have an open message to use this method.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html">CRichText</a> &amp; aBody</td><td>A CRichText object containing the body to add to the message being constructed.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-A56A1795-83C4-3FDF-9171-DA937334317E"><a name="GUID-A56A1795-83C4-3FDF-9171-DA937334317E"><!-- --></a>
		<h2 class="topictitle2">SetBodyTextL(const TDesC &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SetBodyTextL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aBody</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Set the body text of this message using a plain descriptor. The object must have an open message to use this method.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aBody</td><td>A descriptor containing the body to add to the message being constructed.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-46F13DC4-BB6F-3614-894E-1B344D16AF56"><a name="GUID-46F13DC4-BB6F-3614-894E-1B344D16AF56"><!-- --></a>
		<h2 class="topictitle2">SetCharacterSetL(const TUint)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SetCharacterSetL</td><td>(</td><td>const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aCharset</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Sets the character encoding value. The character encoding value options are 7-bit, 8-bit and 16-Bit Unicode. By default the character set encoding is 7 bit encoding.</p>

				<div class="p">Sets the character encoding value. The character encoding value options are 7-bit, 8-bit and 16-Bit Unicode. If this functionality is not supported by the sending MTM (currently for SMS it is supported), it will leave with KErrExtensionNotSupported <dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KErrExtensionNotSupported If the message is other than SMS. </dd>
</dl>
<dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>Other Standard system-wide error codes. </dd>
</dl>
</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aCharset</td><td>TUint, indicating the enocding value.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-A3C4018D-BBF4-34FF-B995-8ACBBB97200C"><a name="GUID-A3C4018D-BBF4-34FF-B995-8ACBBB97200C"><!-- --></a>
		<h2 class="topictitle2">SetSubjectL(const TDesC &amp;)</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>SetSubjectL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aSubject</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Set the subject of this message using a plain descriptor. The object must have an open message to use this method.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aSubject</td><td>A descriptor containing the subject for the message.  </td></tr></table></div>

	</div>
<h1 class="pageHeading topictitle1">Member Enumerations Documentation</h1><div class="nested1" id="GUID-1F91799F-CF68-3D4F-8CA9-7124E66CAC05"><a name="GUID-1F91799F-CF68-3D4F-8CA9-7124E66CAC05"><!-- --></a>
		<h2 class="topictitle2">Enum TSendAsRecipientType</h2>
		<div class="section"><div>
				<p>Defines the recipient types available when adding a recipient to a message </p>

			</div></div>
<div class="section enumerators"><h3 class="sectiontitle">Enumerators</h3><table border="0" class="enumerators"><tr><td valign="top">ESendAsRecipientTo = EMsvRecipientTo</td><td>
							<p>Designates a 'To' recipient. </p>

						 </td></tr><tr class="bg"><td valign="top">ESendAsRecipientCc</td><td>
							<p>Designates a 'Cc' recipient. </p>

						 </td></tr><tr><td valign="top">ESendAsRecipientBcc</td><td>
							<p>Designates a 'Bcc' recipient. </p>

						 </td></tr></table></div>

	</div>
<h1 class="pageHeading topictitle1">Member Data Documentation</h1><div class="nested1" id="GUID-E3EB5F9D-BB19-3728-9267-2A77F1A070B9"><a name="GUID-E3EB5F9D-BB19-3728-9267-2A77F1A070B9"><!-- --></a>
		<h2 class="topictitle2">
					TAny * iAny</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *</td><td>iAny</td><td>[private]</td></tr></table><div class="section"></div>

	</div>

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>