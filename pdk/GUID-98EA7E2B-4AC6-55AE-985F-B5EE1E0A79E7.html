<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Creating a Render Stage Plug-in"/>
<meta name="abstract" content="This topic provides information about creating and configuring a render stage plug-in. It applies to ScreenPlay and is aimed at device creators and system integrators who want to create a customized rendering pipeline."/>
<meta name="description" content="This topic provides information about creating and configuring a render stage plug-in. It applies to ScreenPlay and is aimed at device creators and system integrators who want to create a customized rendering pipeline."/>
<meta name="DC.Relation" scheme="URI" content="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-57A777A3-5D67-5CBB-B224-B7AD422A451B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0C4B86B5-530A-5839-86C1-46E7ABE281E0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5D81D4E2-BE8B-58CE-A745-4F044DE2FB5F.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Creating a Render Stage Plug-in</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2384330 id2384499 id2384574 id2384967 id2384982 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html">Graphics Guide</a> &gt; <a href="GUID-57A777A3-5D67-5CBB-B224-B7AD422A451B.html" title="The Windowing collection contains two componentsâ€”the Window Server, which manages the use of the screen by applications, and the Window Server Plugins component.">Windowing Collection</a> &gt; <a href="GUID-0C4B86B5-530A-5839-86C1-46E7ABE281E0.html" title="The Window Server component manages the use of the screen by applications and handles key and pointer events.">Window Server Component</a> &gt; <a href="GUID-5D81D4E2-BE8B-58CE-A745-4F044DE2FB5F.html" title="This section describes the generic Window Server plug-in framework and is mainly aimed at system integrators, UI platform providers and device and hardware manufacturers.">Window Server Plug-in Framework</a> &gt; <a href="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html" title="This section provides information about the render stage framework in ScreenPlay. This framework enables device creators to change the lower layers of the rendering pipeline without changing the Window Server code.">Render Stages</a> &gt; </div>
<h1 class="topictitle1">Creating
a Render Stage Plug-in</h1>
<div><p>This topic provides information about creating and configuring
a render stage plug-in. It applies to ScreenPlay and is aimed at device creators
and system integrators who want to create a customized rendering pipeline. </p>

<p> <strong>Variant</strong>: <a href="GUID-D93978BE-11A3-5CE3-B110-1DEAA5AD566C.html" title="This topic provides an introduction to ScreenPlay and its architecture. ScreenPlay is a new graphics architecture, introduced in Symbian^3 (S^3). ScreenPlay enables device creators to take advantage of improved software performance, hardware acceleration and third party graphics engines. ScreenPlay is sometimes known as the New Graphics Architecture (NGA).">ScreenPlay</a>. <strong>Target
audience</strong>: Device creators. </p>

<div class="section"><h2 class="sectiontitle">Background information</h2> <p>This topic assumes that
you have a general understanding of render stages and ECom. For more information
on these topics, see: </p>
 <ul>
<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-189C0DEB-01AC-554D-B5BF-45C17F84A38D"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-189C0DEB-01AC-554D-B5BF-45C17F84A38D"><!-- --></a><p><a href="GUID-9E92EE30-F2E2-5F28-BB2A-391C09EC69D2.html">Using
ECom</a>  </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-48020C41-8795-53EE-9D24-D9E6C0586742"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-48020C41-8795-53EE-9D24-D9E6C0586742"><!-- --></a><p><a href="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html" title="This section provides information about the render stage framework in ScreenPlay. This framework enables device creators to change the lower layers of the rendering pipeline without changing the Window Server code.">Render
Stages</a>  </p>
 </li>

</ul>
 </div>

<div class="section"><h2 class="sectiontitle">Summary</h2> <p>Creating and configuring a render stage
plug-in involves the following: </p>
 <ul>
<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-15333AD7-E535-57F7-8A61-068F44C0F362"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-15333AD7-E535-57F7-8A61-068F44C0F362"><!-- --></a><p><a href="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7.html#GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-D7F5CCDE-3A35-582F-B480-6D77E26DE0C1">Implementing the render stage classes</a>  </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-B6723CA4-635A-5EC7-99C3-17EF627E04D5"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-B6723CA4-635A-5EC7-99C3-17EF627E04D5"><!-- --></a><p><a href="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7.html#GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-233E8010-2BF7-563D-94D9-8CFAE61F21EF">Packaging the plug-ins</a>  </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-C2C9D2F5-C84B-520B-8C99-84780890850D"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-C2C9D2F5-C84B-520B-8C99-84780890850D"><!-- --></a><p><a href="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7.html#GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-140EDD81-76DF-5EF6-A34B-AE53283DBC73">Configuring the render stage chain</a>  </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-D7F5CCDE-3A35-582F-B480-6D77E26DE0C1"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-D7F5CCDE-3A35-582F-B480-6D77E26DE0C1"><!-- --></a><h2 class="sectiontitle">Implementing
the render stage classes</h2> <p><strong>The render stage factory </strong> </p>
 <p>For
each render stage plug-in, you must create a concrete render stage factory
class, which must be able to produce the render stage object. The render stage
factory class must derive from <a href="GUID-28DEFD88-3AB5-3F94-9A26-27B240294950.html"><span class="apiname">CWsPlugin</span></a> and <a href="GUID-DE3DA8CA-437D-33B8-A747-941810A48897.html"><span class="apiname">MWsRenderStageFactory</span></a>,
as shown in the following diagram. </p>
 <div class="fignone" id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-EFC66A6D-29E4-58FC-810C-A3BA276E0734"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-EFC66A6D-29E4-58FC-810C-A3BA276E0734"><!-- --></a><span class="figcap">Figure 1.               Render stage factory class diagram            </span>

<img src="GUID-BFD09EE5-CCB3-5498-BAA6-86F537DE9155_d0e248904_href.png"/>
</div>
 <p> <a href="GUID-28DEFD88-3AB5-3F94-9A26-27B240294950.html"><span class="apiname">CWsPlugin</span></a> is a thin wrapper around the Symbian
ECom functionality. </p>
 <p><strong>The render stage itself </strong> </p>
 <p>For each
render stage plug-in, you must create a concrete render stage class that derives
from <a href="GUID-B89CEF40-0139-3E6F-803D-F74E2BCB029A.html"><span class="apiname">CWsRenderStage</span></a>. In ScreenPlay, the render stage is
responsible for constructing the pixel target. Typically, you would do this
in the <a href="GUID-C8E0575D-5A7F-3D00-9BE5-AD8D6DBCF2F7.html"><span class="apiname">ConstructL()</span></a> function. Other important functions
to implement are <a href="GUID-96129474-AC75-350C-90EB-A8AF8E1CC663.html"><span class="apiname">Begin()</span></a> and <a href="GUID-95ED21B6-F0E5-3C9F-8AC3-CD73AD32E59D.html"><span class="apiname">End()</span></a>. </p>
 <p>You
must also create implementations of all of the required <a href="GUID-11BC2AAA-FDB8-5600-8488-F27A9552E336.html" title="This topic builds on the Render Stages Overview and provides an introduction to the main render stage interfaces.">render
stage interfaces</a>, plus any optional ones that you want to use. You
can do this in the main render stage class itself, or you can delegate them
to a helper class. If delegated to a helper class, multiple render stage plug-ins
could potentially share the same implementation of some of the interfaces. </p>
 <p>If
the render stage is to host a transition effect (TFX) engine, you need to
implement the transition effects. </p>
 <p>For example render stage plug-ins,
see the reference render stages provided by Symbian. These are located in <span class="filepath">os/graphics/windowing/windowserverplugins/</span>. </p>
 </div>

<div class="section" id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-233E8010-2BF7-563D-94D9-8CFAE61F21EF"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-233E8010-2BF7-563D-94D9-8CFAE61F21EF"><!-- --></a><h2 class="sectiontitle">Packaging the
plug-ins</h2> <p>Render stage plug-ins are ECom plug-ins and as such they
require an ECom resource file that must specify the UIDs of the DLL, interface
and implementation(s), respectively. The interface is defined by <a href="GUID-28DEFD88-3AB5-3F94-9A26-27B240294950.html"><span class="apiname">CWsPlugin</span></a> and
its UID is 0x10285A29. You can optionally wrap up multiple render stage plug-ins
in a single DLL. This would then have a single ECom resource file. See <a href="GUID-9A9103E4-27B0-5CF3-855A-DCD44795A5C0.html" title="The properties of the implementation are published in a compiled resource file. This file is known as the registration resource file of the implementation and has a.rss extension. The plug-in framework reads the resource files to find the interface implementations available on the system. In case of an implementation collection, the collection has one registration resource file and the properties of all the implementations of the collection are described in the file.">How to Provide ECom Registry
Information</a> for more information. </p>
 <p>For an example render stage
plug-in resource file, see the one provided for the reference render stages.
This is located in <span class="filepath">os/graphics/wserv_std_plugins/src</span>. </p>
 </div>

<div class="section" id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-140EDD81-76DF-5EF6-A34B-AE53283DBC73"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-140EDD81-76DF-5EF6-A34B-AE53283DBC73"><!-- --></a><h2 class="sectiontitle">Configuring
the render stage chain</h2> <p> </p>
 <p>You configure the render stage
chain in the <a href="GUID-1D529BDC-6665-58E2-AB3F-7023D8A84F69.html" title="This topic provides a reference to the wsini.ini file parameters. Some of the parameters are general, some are screen-specific and some are specific to individual plug-ins.">wsini.ini
file</a>. Here is an example: </p>
 <pre class="codeblock" id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-05CDB5C8-D6A0-5614-9CEE-7DCCF99FBB2E"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-05CDB5C8-D6A0-5614-9CEE-7DCCF99FBB2E"><!-- --></a>
// General parameters.
// ...
    
// Specify the plug-ins you want the Window Server to load.
PLUGINS tfxrenderstage fbrenderstage display 
    
[SCREEN0] // This section configures the first screen.
//...
    
// Configure the render stage chain for the first screen.
RENDERSTAGES tfxrenderstage display
    
[SCREEN1] // This section configures the second screen.
//...
    
// Configure the render stage chain for the second screen.
RENDERSTAGES fbrenderstage display
    
[TFXRENDERSTAGE] // This section configures tfxrenderstage.
ID 0x12345678
    
[FBRENDERSTAGE] // This section configures fbrenderstage.
ID 0x12345679</pre>
 <ul>
<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-02A77490-F545-53AC-A4C9-FA9A60F49297"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-02A77490-F545-53AC-A4C9-FA9A60F49297"><!-- --></a><p>The <samp class="codeph">PLUGINS</samp> parameter
controls which plug-ins the Window Server loads when it starts up. If you
supply your own plug-ins and want to use any of the default plug-ins supplied
by Symbian, you need to specify them here. </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-F3539B28-CDEB-5A4B-97B8-197AD14083A4"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-F3539B28-CDEB-5A4B-97B8-197AD14083A4"><!-- --></a><p>The <samp class="codeph">RENDERSTAGES</samp> parameter
configures the render stage chain. You can specify this separately for each
screen, so that different effects can be used for each screen. </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-FC95C274-2E4E-514E-B2DC-BA221DFE5FB7"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-FC95C274-2E4E-514E-B2DC-BA221DFE5FB7"><!-- --></a><p>For each plug-in that
you specify, create a separate section to specify its details (such as UID
and type). </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-52F01B4D-5CDC-591B-BB02-046FCF8E81BE"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-52F01B4D-5CDC-591B-BB02-046FCF8E81BE"><!-- --></a><p>TFX render stages that
implement their own visual stores typically use the <samp class="codeph">CHANGETRACKING</samp> parameter
to put the Window Server rendering loop into change-tracking mode, rather
than the default dirty-rectangle tracking mode. See <a href="GUID-22093E74-EFE7-5642-93DE-1573E18F7C08.html" title="This topic provides a brief introduction to the Window Server's rendering loop, which takes place in two stages, known as the upper loop and the lower loop.">Window
Server Rendering Loop</a> for more information. </p>
 </li>

<li id="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-5DD25953-C7A0-537F-BF16-9C7A95C534E5"><a name="GUID-98EA7E2B-4AC6-55AE-985F-B5EE1E0A79E7__GUID-5DD25953-C7A0-537F-BF16-9C7A95C534E5"><!-- --></a><p>In addition, you can
optionally use parameters in the <span class="filepath">wsini.ini</span> file to set
up dynamic screen modes and configure the render stage <a href="GUID-2B6D3A9D-1481-5587-A954-48CE7EC311EE.html" title="ScreenPlay has a new approach to display resolution control to support externally connected displays, such as TV-out. It involves the render stages plus a number of other components in the Graphics package, including the Window Server and the composition engine. The render stages are able to monitor and modify display control attributes, and to scale and position the application extent within the full UI area. In addition, they can optionally implement a display policy, which determines the UI to composition mapping policy.">display
control handling</a>. For example, the reference render stage chain uses
the <samp class="codeph">DP_SCALING</samp> parameter to specify the type of scaling.
However, this is not mandatory. </p>
 </li>

</ul>
 <p>See <a href="GUID-1D529BDC-6665-58E2-AB3F-7023D8A84F69.html" title="This topic provides a reference to the wsini.ini file parameters. Some of the parameters are general, some are screen-specific and some are specific to individual plug-ins.">The wsini.ini
File Reference</a> for more information. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html" title="This section provides information about the render stage framework in ScreenPlay. This framework enables device creators to change the lower layers of the rendering pipeline without changing the Window Server code.">Render Stages</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-3A2785D4-6185-50C3-8D7E-5D94CD2B7C98.html" title="This section provides information about the render stage framework in ScreenPlay. This framework enables device creators to change the lower layers of the rendering pipeline without changing the Window Server code.">Render Stages</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>