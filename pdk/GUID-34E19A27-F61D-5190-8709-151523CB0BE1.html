<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Reclamation And Compaction, Incrementally"/>
<meta name="abstract" content="Explains how to reclaim and compact incrementally by using smaller steps."/>
<meta name="description" content="Explains how to reclaim and compact incrementally by using smaller steps."/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8D12BC4-82C6-59CD-93C9-506FF872C622.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3FAB9077-3EC3-5539-B391-D11456362513.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E9C608C0-AC22-5267-BEC4-207C9758F968.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8D12BC4-82C6-59CD-93C9-506FF872C622.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-34E19A27-F61D-5190-8709-151523CB0BE1"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Reclamation And Compaction, Incrementally</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-34E19A27-F61D-5190-8709-151523CB0BE1"><a name="GUID-34E19A27-F61D-5190-8709-151523CB0BE1"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2859821 id2860178 id2533897 id2533970 id2534100 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html" title="Provides services to enable and support persistence.">Persistent Data Services Guide</a> &gt; <a href="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html" title="The persistent storage collection.">Persistent Storage</a> &gt; <a href="GUID-3FAB9077-3EC3-5539-B391-D11456362513.html" title="Store provides structured data storage.">Store</a> &gt; <a href="GUID-E9C608C0-AC22-5267-BEC4-207C9758F968.html" title="Provides persistent, embedded, dictionary, and memory stores.">Stores Guide</a> &gt; <a href="GUID-F8D12BC4-82C6-59CD-93C9-506FF872C622.html" title="Topics related to reclamation and compaction.">Space reclamation and compaction</a> &gt; </div>
<h1 class="topictitle1">Reclamation
And Compaction, Incrementally</h1>
<div><p>Explains how to reclaim and compact incrementally by using smaller
steps.</p>

<p>Both space reclamation and compaction can be done incrementally, i.e. broken
down into smaller steps. This allows an application to alternate reclamation
and compaction with other processing and remain responsive to other events.</p>

<p>To do this, construct an object of type <samp class="codeph">RStoreReclaim</samp> and
call:</p>

<ul>
<li id="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-4C8737BC-BCEA-5D06-9F31-5E823EE39C46"><a name="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-4C8737BC-BCEA-5D06-9F31-5E823EE39C46"><!-- --></a><p><samp class="codeph">RStoreReclaim::OpenL()</samp> or <samp class="codeph">RStoreReclaim::OpenLC()</samp> to
prepare the <samp class="codeph">RStoreReclaim</samp> object to perform space reclamation.</p>
 </li>

<li id="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-49C343FC-1C3F-5D92-A846-FC65EBEBDFA8"><a name="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-49C343FC-1C3F-5D92-A846-FC65EBEBDFA8"><!-- --></a><p><samp class="codeph">RStoreReclaim::CompactL()</samp> or <samp class="codeph">RStoreReclaim::CompactLC()</samp> to
prepare the <samp class="codeph">RStoreReclaim</samp> object to perform compaction.</p>
 </li>

</ul>

<p>Each stage of space reclamation and compaction is performed or initiated
by calling the appropriate variant of <samp class="codeph">RStoreReclaim::Next()</samp> or <samp class="codeph">RStoreReclaim::NextL()</samp>.
The class provides both synchronous and asynchronous variants of these two
functions. The asynchronous versions initiate the next stage of space reclamation
and compaction.</p>

<p>At any time during space reclamation or compaction, the <samp class="codeph">RStoreReclaim::Available()</samp> returns
a running total of free space discovered so far.</p>

<p>Compaction and normal access to the store interact in the following ways:</p>

<ul>
<li id="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-CE0ADA7E-0790-55A6-B9E3-4A237DACEE1E"><a name="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-CE0ADA7E-0790-55A6-B9E3-4A237DACEE1E"><!-- --></a><p>if a compaction step
is in progress, committing the store causes the compaction step to be abandoned
and to complete or leave with <samp class="codeph">KErrNotReady</samp>. All subsequent
attempts to initiate a compaction step, complete or leave with <samp class="codeph">KErrNotReady</samp>.
Compaction can be restarted by first doing a reset, i.e. by calling <samp class="codeph">ResetL()</samp>.</p>
 </li>

<li id="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-86F776A3-D1C0-55DB-A365-C085BFEFA28F"><a name="GUID-34E19A27-F61D-5190-8709-151523CB0BE1__GUID-86F776A3-D1C0-55DB-A365-C085BFEFA28F"><!-- --></a><p>a compaction step which
needs to physically move a stream, completes or leaves with <samp class="codeph">KErrInUse</samp>,
if any stream within the store is open. The stream must be closed before initiating
another compaction step.</p>
 </li>

</ul>

<p>Once compaction is complete, the store must be committed.</p>

<p>Doing an incremental space reclamation or compaction asynchronously requires
the use of active objects. </p>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F8D12BC4-82C6-59CD-93C9-506FF872C622.html" title="Topics related to reclamation and compaction.">Space reclamation and compaction</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>