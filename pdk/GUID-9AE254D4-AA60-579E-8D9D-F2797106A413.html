<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="User-Side Hardware Abstraction Technology"/>
<meta name="abstract" content="Description of HAL types and interfaces."/>
<meta name="description" content="Description of HAL types and interfaces."/>
<meta name="DC.Relation" scheme="URI" content="GUID-B7C56FF9-FE1B-58C3-BBD4-7479F0BEE555.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2D977A02-5928-5441-8AE7-42A722F2A4B8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B7C56FF9-FE1B-58C3-BBD4-7479F0BEE555.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>User-Side Hardware Abstraction Technology</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2402268 id2402276 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-2D977A02-5928-5441-8AE7-42A722F2A4B8.html" title="The User-Side Hardware Abstraction (HAL) component provides a simple interface for programs to read and set hardware-specific settings, for example, the display contrast.">User-Side Hardware Abstraction</a> &gt; <a href="GUID-B7C56FF9-FE1B-58C3-BBD4-7479F0BEE555.html" title="Describes the technology and architecture, and behaviour of the User-Side Hardware Abstraction component.">Concepts</a> &gt; </div>
<h1 class="topictitle1">User-Side
Hardware Abstraction Technology</h1>
<div><p>Description of HAL types and interfaces.</p>

<p>The User-Side Hardware Abstraction (HAL) component provides a platform-independent
way to access and control many device specific features, and to hide hardware-specific
functionality. For example, HAL can be used to find out if a screen backlight
is present or not, or to set the display contrast. This topic </p>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-174A663C-3943-5D36-B507-D97A687C168C"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-174A663C-3943-5D36-B507-D97A687C168C"><!-- --></a><h2 class="sectiontitle">Attributes</h2> <p>Specific
items of hardware related information are referred to as <em>attributes</em>.
Symbian platform defines two types of attribute: </p>
 <ul>
<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-3A220CC5-7D56-5FB8-A69A-EFAAC0159561"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-3A220CC5-7D56-5FB8-A69A-EFAAC0159561"><!-- --></a><p>Non-derived attribute.
This is an attribute where the information it represent is simply a value
that is stored in, and retrieved from, the HAL. </p>
 </li>

<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-934EFFE7-4768-5919-8900-6DE6915E3195"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-934EFFE7-4768-5919-8900-6DE6915E3195"><!-- --></a><p>Derived attribute. This
is an attribute that requires a software call to obtain and set its value.
The software component is, ultimately provided by a driver, kernel extension
or by the kernel itself. The drivers or kernel extensions normally need porting. </p>
 </li>

</ul>
 <p>Attributes are identified by the enumeration values of the enumerator <a href="GUID-8BE90160-2C60-3582-82C8-4A108C7C0317.html#GUID-8BE90160-2C60-3582-82C8-4A108C7C0317__GUID-1959915A-BA99-3F94-AFD4-FD1AA540BFBF"><span class="apiname">HALData::TAttribute</span></a> defined
in <span class="filepath">...\hal\inc\hal_data.h</span> and is exported to <span class="filepath">...\epoc32\include\</span>. </p>
 <p>To
maintain backwards compatibility, the numbers identifying HAL attributes are
allocated strictly increasing consecutive values, and that a given HAL attribute
always has the same enumeration number on all implementations of Symbian platform.
This means that new HAL attributes can only be added by Symbian. This also
means that the addition of custom HAL attributes is not possible. </p>
 </div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-F1F21DDA-DEA0-502E-83DB-84DDCFA5CBF8"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-F1F21DDA-DEA0-502E-83DB-84DDCFA5CBF8"><!-- --></a><h2 class="sectiontitle">User-side interface</h2> <p>Symbian
platform provides the following static functions to get and set information
about specific hardware features: </p>
 <ul>
<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-75ADEAE6-3BA5-55AA-9F6D-B91491CD1B7B"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-75ADEAE6-3BA5-55AA-9F6D-B91491CD1B7B"><!-- --></a><p> <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html#GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8__GUID-573C49D6-7763-37AE-B2B2-4C8FB1327E21"><span class="apiname">HAL::Get()</span></a>  </p>
 </li>

<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-A11EFEFE-D480-5557-965E-FEC524B7C5A9"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-A11EFEFE-D480-5557-965E-FEC524B7C5A9"><!-- --></a><p> <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html#GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8__GUID-9454F1B2-D525-3D6D-A872-C6457CACD4FC"><span class="apiname">HAL::Set()</span></a>  </p>
 </li>

<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-CD26D10D-84EB-56D4-AC70-86C2E65734E6"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-CD26D10D-84EB-56D4-AC70-86C2E65734E6"><!-- --></a><p> <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html#GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8__GUID-EF03B832-E9AA-32CF-903F-DFFA63A3E9AB"><span class="apiname">HAL::GetAll()</span></a>  </p>
 </li>

</ul>
 <p>The <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html"><span class="apiname">HAL</span></a> class is defined in the source tree header
file <span class="filepath">...\hal\inc\hal.h</span>, and is exported to <span class="filepath">...\epoc32\include\</span>.
The functions are exported from the HAL DLL, which is built as part of the
Variant. </p>
 <p> <samp class="codeph">Get()</samp> and <samp class="codeph">Set()</samp> take an <a href="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413.html#GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-174A663C-3943-5D36-B507-D97A687C168C">attribute</a> to
identify specific hardware functionality. </p>
 <p> <samp class="codeph">GetAll()</samp>,
as its name implies gets all available hardware information, but is rarely
used. See <a href="GUID-124AC7EE-E227-5358-A755-628FFE257250.html#GUID-124AC7EE-E227-5358-A755-628FFE257250__GUID-D75D3A65-590D-5716-84A7-0195DFCD1656">Dealing
with the HAL::GetAll() function</a> for more information. </p>
 <p> <samp class="codeph">Get()</samp> and <samp class="codeph">Set()</samp> each
have a variation that allows a device number to be specified. The device number
allows more than one set of attributes to be used. Each set is associated
with a different device number. This is motivated by the need to support multiple
display screens where each screen is identified as a separate device of the
same 'type'. The idea of a device can be extended other hardware, and indeed
the underlying implementation assumes a device number. If a device number
is not specified and has no meaning, then a default device number of 0 is
assumed for compatibility with the underlying implementation. </p>
 <p>For
example, on return from code such as: </p>
 <pre class="codeblock" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-D512D36F-C94A-50C2-9245-569C6386E559"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-D512D36F-C94A-50C2-9245-569C6386E559"><!-- --></a>...
TInt xpixels;
HAL::Get(EDisplayXPixels, xpixels);
...</pre>
 <p> <samp class="codeph"> xpixels</samp> contains the horizontal size
of the display screen in terms of the number of pixels. If you have more than
one screen, i.e. more than one device, then you would use the API variant
that takes a device number. </p>
 </div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-79BE4534-B9C6-5D64-8CB0-E3EEDE8AD293"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-79BE4534-B9C6-5D64-8CB0-E3EEDE8AD293"><!-- --></a><h2 class="sectiontitle">HAL handler
interface</h2> <p>A request for fetching and setting information about
hardware is dealt with by an entity called a HAL handler on the kernel side.
This section describes the types and concepts used to implement a HAL handler. </p>
 </div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-FBA183CB-E9D5-4E70-B65F-A496853D614B"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-FBA183CB-E9D5-4E70-B65F-A496853D614B"><!-- --></a><h2 class="sectiontitle">HAL groups and function-ids</h2><p>It is useful to group
together requests for information about related hardware features so that
they can be dealt with by a single HAL handler. As an example, all the HAL
screen attributes are in the display group and are handled by the screen (i.e.
video or LCD) driver. This means that a HAL group has a one-to-one association
with a HAL handler. </p>
 <p>A HAL group has an associated set of function-ids,
which identify requests for different pieces of information to the HAL handler. </p>
 <p>Symbian
platform identifies HAL groups by a number defined by the <a href="GUID-66A851A0-2A0C-3624-AEC1-22F6629FABF7.html"><span class="apiname">THalFunctionGroup</span></a> enum
in <span class="filepath">u32hal.h</span>, which is exported to <span class="filepath">...\epoc32\include</span>.
For example, the <a href="GUID-7F299BFC-D8A5-3A5A-B8DA-39BF42C99DC6.html"><span class="apiname">EHalGroupDisplay</span></a> enum value identifies
the group associated with the HAL screen attributes. </p>
 <p>The function-ids
associated with each HAL group are also defined in <span class="filepath">u32hal.h</span>.
Each set of function-ids is defined by an enum; for example the enum <a href="GUID-BB011D9B-105F-345C-9FC0-39B0BA509394.html"><span class="apiname">TDisplayHalFunction</span></a> defines
the function-ids associated with the HAL group <a href="GUID-7F299BFC-D8A5-3A5A-B8DA-39BF42C99DC6.html"><span class="apiname">EHalGroupDisplay</span></a>. </p>
 <p>The
idea of the HAL group is what allows HAL handling functionality to be implemented
in the Variant, rather than in the kernel. </p>
 <p>Up to 32 groups can be
defined. Often, a HAL group is concerned with mode settings for a particular
piece of hardware; for example there are standard HAL groups for keyboard,
digitiser and display. However, some groups are concerned with some overall
aspect of the platform which extends across all devices; for example, there
is a group to handle emulation parameters on emulator platforms. </p>
 <p>An <a href="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413.html#GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-174A663C-3943-5D36-B507-D97A687C168C">attribute</a> maps
to a HAL group/function-id pair, although the mapping is not necessarily a
one-to-one relationship. For example, the calls: </p>
 <pre class="codeblock" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-FB9CB26C-3DEF-5E8B-A564-40ECC68AD2FD"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-FB9CB26C-3DEF-5E8B-A564-40ECC68AD2FD"><!-- --></a>TInt xPixels, yPixels;
...
HAL::Get(HALData::EDisplayXPixels,xPixels);
HAL::Get(HALData::EDisplayYPixels,yPixels);
...</pre>
 <p>both result in calls to the screen (i.e. video or LCD)
HAL handler, as represented by the HAL group number <a href="GUID-66A851A0-2A0C-3624-AEC1-22F6629FABF7.html#GUID-66A851A0-2A0C-3624-AEC1-22F6629FABF7__GUID-950EA0D3-747F-305E-92EA-1579023A111E"><span class="apiname">THalFunctionGroup::EHalGroupDisplay</span></a>,
using the same function-id <a href="GUID-BB011D9B-105F-345C-9FC0-39B0BA509394.html#GUID-BB011D9B-105F-345C-9FC0-39B0BA509394__GUID-FD814550-9B59-3196-827C-5C1A87E09D77"><span class="apiname">TDisplayHalFunction::EDisplayHalScreenInfo</span></a>. </p>
 <p>However,
there are HAL group/function-id pairs for which there are no corresponding
generic attributes. In these cases, the hardware attributes represented by
the HAL group/function-id pair are used internally, and can only be accessed
using the kernel side function <a href="GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D.html#GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D__GUID-DA115709-A225-3E2A-BCCD-6E2BB15979B9"><span class="apiname">Kern::HalFunction()</span></a> **. </p>
 <p>The
following picture shows the general idea: </p>
 <div class="fignone" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-95743ED4-8CEC-5BAD-A5C2-9FD16D0485FA"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-95743ED4-8CEC-5BAD-A5C2-9FD16D0485FA"><!-- --></a>
<img src="GUID-F50E1C81-E80F-5692-996B-3AC2BE995425_d0e415179_href.png"/>
</div>
 <p>**Technically, the user side function <samp class="codeph">UserSvr::HalFunction()</samp> will
achieve the same thing, but this is <em>internal to Symbian</em> and is <em>not
intended for general use</em>. </p>
</div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-F28BA77B-D7AA-4D27-8ADF-029F42F800E4"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-F28BA77B-D7AA-4D27-8ADF-029F42F800E4"><!-- --></a><h2 class="sectiontitle">HAL handler implementation</h2><p>Most HAL handlers are
implemented as part of a driver, a kernel extension, the Variant or the kernel
itself. Some will need porting. See <a href="GUID-857F981E-711B-5CA8-AB37-5C700A6140FA.html" title="List of HAL groups and the location of their associated handlers.">Groups
and the location of their HAL handlers</a>. </p>
 <p>An extension or a device
driver <em>must register</em> a handler for HAL group. It does so by calling <a href="GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D.html#GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D__GUID-8C8DCE9D-0094-3909-8FDA-2F3134D0BC88"><span class="apiname">Kern::AddHalEntry()</span></a>,
specifying the group number. It is important to note that it is the extension
or driver's responsibility to do this; in other words, the kernel cannot know
what entity within a final ported Symbian platform is going to be the HAL
handler until it is explicitly told by registration. One point to note is
that the HAL handlers for the groups: <a href="GUID-F10DCE1F-756C-318D-B0D1-8C8F5255959E.html"><span class="apiname">EHalGroupKernel</span></a>, <a href="GUID-D60C5503-A176-354A-A655-22BE371178AE.html"><span class="apiname">EHalGroupVariant</span></a> and <a href="GUID-FB85CE22-DDFF-37E6-A6CE-7F70A994D371.html"><span class="apiname">EHalGroupPower</span></a> are not explicitly registered - they are registered internally by the kernel
itself. </p>
 <p>Internally, pointers to the HAL handler are stored in the
array <samp class="codeph">K::HalFunction[]</samp>, and this is indexed by the group
number. </p>
 <p>On the template board, for example, the HAL handler for the
display group is part of the screen driver. The screen driver source can be
found in <span class="filepath">...\template_variant\specific\lcd.cpp</span>. The HAL
handler itself is the function: </p>
 <pre class="codeblock" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-C7272D10-F603-5DF6-8C0B-EE18EDDAF32E"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-C7272D10-F603-5DF6-8C0B-EE18EDDAF32E"><!-- --></a>LOCAL_C TInt halFunction(TAny* aPtr, TInt aFunction, TAny* a1, TAny* a2)
    {
    DLcdPowerHandler* pH=(DLcdPowerHandler*)aPtr;
    return pH-&gt;HalFunction(aFunction,a1,a2);
    }</pre>
 <p>The following code, implemented in the Create() function
of the main class, does the registration. </p>
 <pre class="codeblock" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-2B8BFFC5-8FC5-5220-BE9D-F02003C41275"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-2B8BFFC5-8FC5-5220-BE9D-F02003C41275"><!-- --></a>TInt DLcdPowerHandler::Create()
    {
    ...
    // install the HAL function
    r=Kern::AddHalEntry(EHalGroupDisplay,halFunction,this);
    if (r!=KErrNone)
        return r;
    ...
    }</pre>
 <p>Security is the responsibility of the HAL handler. If
necessary, it needs to check the capability of the caller's process. Each
information item, as identified by the function-id, can have an associated
capability. </p>
 <p>Each function-id defined in <span class="filepath">u32hal.h</span> is
documented with the required capability. If no capability is listed, then
no specific capability is required. </p>
 <p>See <a href="GUID-124AC7EE-E227-5358-A755-628FFE257250.html" title="Describes how to implement or change a new HAL handler when you create a base port.">Implementing
HAL handlers</a> for details. </p>
 </div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-042A8840-2260-5951-8951-E6E2A83F378E"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-042A8840-2260-5951-8951-E6E2A83F378E"><!-- --></a><h2 class="sectiontitle">Kernel-side
interface</h2> <p>Code such as device drivers that runs on the kernel side
need not use the generic interface provided by the HAL class functions. The <a href="GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D.html#GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D__GUID-DA115709-A225-3E2A-BCCD-6E2BB15979B9"><span class="apiname">Kern::HalFunction()</span></a> API
is provided to access HAL information. </p>
 <p>Unlike the HAL class functions, <a href="GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D.html#GUID-C6946ECB-775F-3EC2-A56F-78F25B9FBE3D__GUID-DA115709-A225-3E2A-BCCD-6E2BB15979B9"><span class="apiname">Kern::HalFunction()</span></a> uses
the group number and function-ids to identify hardware related information.
This means that kernel side code does not use attributes to identify hardware
related information. The implication here is that you <em>may</em> have to make
changes to your kernel side code when porting to another platform. In practice,
no changes may be needed, but at the very least you need to check. </p>
 </div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-43324161-56E6-40A7-A4C4-D3D8435D3568"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-43324161-56E6-40A7-A4C4-D3D8435D3568"><!-- --></a><h2 class="sectiontitle">Config and Values files define attributes</h2><p>Although
an <a href="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413.html#GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-174A663C-3943-5D36-B507-D97A687C168C">attribute</a> is
generic, some attributes may not have meaning on some platforms. In addition,
each platform needs to define whether an attribute is either: </p>
 <ul>
<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-5D6B46DF-FAE7-5097-832D-F8FD33A3DB53"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-5D6B46DF-FAE7-5097-832D-F8FD33A3DB53"><!-- --></a><p> <em>non-derived</em>,
i.e. has a value that is simply stored in the HAL, </p>
 </li>

</ul>
 <p>or: </p>
 <ul>
<li id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-B40D5AE3-13E7-50B0-8926-5B3461496DD2"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-B40D5AE3-13E7-50B0-8926-5B3461496DD2"><!-- --></a><p> <em>derived</em>, i.e.
requires a call to a software entity to get and set the value. </p>
 </li>

</ul>
 <p>This is the role of the <em>Config file</em>. </p>
 <p>The Config file
contains a list of all the attributes that have meaning on a platform, and
uses the symbols defined in the enum <a href="GUID-8BE90160-2C60-3582-82C8-4A108C7C0317.html#GUID-8BE90160-2C60-3582-82C8-4A108C7C0317__GUID-1959915A-BA99-3F94-AFD4-FD1AA540BFBF"><span class="apiname">HALData::TAttribute</span></a> to
identify them. Using a simple syntax, an attribute can be defined as being
derived by associating the attribute symbol with the name of a function. This
function is known as the <em>accessor function</em>. </p>
 <p>There is also a
file known as the <em>Values file</em> that defines the initial values for all
of the non-derived attributes, i.e. those attributes that are simply stored
in, and retrieved from, the HAL. </p>
 <p>The Config and Values files are text
files that, for a specific implementation of the HAL, reside in the <span class="filepath">...\variant\hal</span> directory.
The MMP file also resides there, and the HAL is built as part of the Variant.
As part of the build process, the Config and Values files are passed to a
Perl script, <span class="filepath">halcfg.pl</span>, which translates the contents
into C++ source files. The resulting binaries are linked in as part of the
resulting HAL DLL. </p>
 <p>In effect, these C++ source files implement the
static data arrays defined by the <samp class="codeph">HalInternal</samp> class. As its
name suggests, <strong>this class is internal to Symbian platform</strong>, and is only
discussed here to help with understanding. </p>
 <pre class="codeblock" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-35660653-5519-59B9-A8D1-1BC18EA5E46D"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-35660653-5519-59B9-A8D1-1BC18EA5E46D"><!-- --></a>class HalInternal
    {
    ...
    static const TUint8 Properties[HAL::ENumHalAttributes];
       ...
    static const TInt InitialValue[HAL::ENumHalAttributes];
    static const THalImplementation Implementation[HAL::ENumHalAttributes];
    ...
    }</pre>
 <p>The data member <samp class="codeph">Implementation[]</samp> is
an array of pointers to the accessor functions </p>
 <p>See <a href="GUID-52583CC7-483E-54B5-8094-F0F61BD46B7F.html" title="Describes the format of configuration files.">Creating
the Config &amp; Values files</a> for detailed syntax. </p>
</div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-35FF9B50-7503-4F8E-B7A7-91287FDB57AB"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-35FF9B50-7503-4F8E-B7A7-91287FDB57AB"><!-- --></a><h2 class="sectiontitle">Derived attributes require accessor functions</h2><p>Each
derived attribute has a corresponding accessor function. For example, <samp class="codeph">ProcessDisplayContrast()</samp>. </p>
 <p>All
accessor functions are implemented in <span class="filepath">...\hal\src\userhal.cpp</span>,
and are provided by Symbian platform because of the 'connection' to attributes
which are themselves defined as part of the generic platform. </p>
 <p>Generally
there is one accessor function per derived attribute, although there is nothing
to prevent an accessor function dealing with more than one attribute. The
attribute number is used to route calls made to <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html#GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8__GUID-573C49D6-7763-37AE-B2B2-4C8FB1327E21"><span class="apiname">HAL::Get()</span></a> and <a href="GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8.html#GUID-BD00E7FC-C234-3111-87A5-10F79EB0F2B8__GUID-9454F1B2-D525-3D6D-A872-C6457CACD4FC"><span class="apiname">HAL::Set()</span></a> forward
to the correct accessor function. Internally, Symbian platform routes calls
to Get() and Set() for an attribute to the same accessor function, distinguishing
between the two by a boolean value. </p>
 <p>A new implementation of an accessor
function should rarely, if ever, be needed as all likely accessor functions
are already defined and implemented by Symbian platform in <span class="filepath">...\hal\src\userhal.cpp</span>. </p>
 <p>See <a href="GUID-A7ECF51F-F96A-5251-A71F-2F269C8C0664.html" title="Explains how to add accessor functions for derived attributes.">Writing accessor functions
for derived attributes</a>. </p>
</div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-0561268F-C0D0-4E33-85A7-D90F3099E5D1"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-0561268F-C0D0-4E33-85A7-D90F3099E5D1"><!-- --></a><h2 class="sectiontitle">Accessor functions call UserSvr::HalFunction()</h2><p>Typically,
an accessor function implementation calls <a href="GUID-9EF04FB9-B36F-3A6F-AF3F-F2238BD181E9.html#GUID-9EF04FB9-B36F-3A6F-AF3F-F2238BD181E9__GUID-7F07C14C-E69A-3277-8BFF-0CE2A820166D"><span class="apiname">UserSvr::HalFunction()</span></a>,
specifying a group number, as defined in <a href="GUID-66A851A0-2A0C-3624-AEC1-22F6629FABF7.html"><span class="apiname">THalFunctionGroup</span></a>,
and a function-id that is related to the attribute, but is <em>not</em> the
attribute number as defined in <a href="GUID-72B0351E-E8D1-3990-9673-A6713F923BC9.html"><span class="apiname">TAttribute</span></a>. Function numbers
are published in <span class="filepath">u32hal.h</span>, and exported into <span class="filepath">...\epoc32\include</span>;
for example, the enumerators of the enum <samp class="codeph">TDigitiserHalFunction</samp>. </p>
 <p>This
means that it is the accessor function, which is part of Symbian platform
generic code, that decides which HAL handler is to deal with a request (as
identified by the attribute). </p>
 <p>The kernel uses the HAL group number
as an index to dispatch the call to the correct HAL handler. </p>
 <p>Note
that there may be cases where access to a HAL attribute may be handled through
a device driver or server. </p>
</div>

<div class="section" id="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-14E8EB8B-35FD-4780-8096-249742595207"><a name="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-14E8EB8B-35FD-4780-8096-249742595207"><!-- --></a><h2 class="sectiontitle">UserSvr::HalFunction() calls ExecHandler::HalFunction()</h2><p>The
static function <samp class="codeph">UserSvr::HalFunction()</samp>, which is <em>internal</em> to
Symbian platform, is the user side point of access. It takes a <a href="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413.html#GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-366CC4B8-C6BD-5DCC-B55D-6D87CD5C8E64">HAL group</a> to identify a set of related hardware features. In addition,
it takes a function-id to identify specific hardware functionality within
the HAL group, for example, one of the <samp class="codeph">TDisplayHalFunction</samp> enumerators. </p>
 <p>A
call to this function results in a call to the kernel side function <samp class="codeph">exechandler::HalFunction()</samp>,
passing the group number and the function-id. This, in turn, finds the appropriate <a href="GUID-9AE254D4-AA60-579E-8D9D-F2797106A413.html#GUID-9AE254D4-AA60-579E-8D9D-F2797106A413__GUID-1B59A40C-D023-5555-8E5E-DF18D653D321">HAL
handler</a> function in the internal array <samp class="codeph">K::HalFunction[]</samp>,
using the group number as the index. </p>
 <p> <samp class="codeph">UserSvr::HalFunction()</samp> is
exported from <span class="filepath">euser.dll</span>, and is therefore accessible
from the user side. However, it is <em>not intended for general third party
use</em>. </p>
 <p>For information purposes, the <samp class="codeph">UserSvr</samp> class
is defined in the source tree header file <span class="filepath">...\e32\include\e32svr.h</span>,
which is exported to <span class="filepath">...\epoc32\include\</span>. </p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-B7C56FF9-FE1B-58C3-BBD4-7479F0BEE555.html" title="Describes the technology and architecture, and behaviour of the User-Side Hardware Abstraction component.">Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>