<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Port Implementation Tutorial"/>
<meta name="abstract" content="This topic describes how to customize the Base Starter."/>
<meta name="description" content="This topic describes how to customize the Base Starter."/>
<meta name="DC.Relation" scheme="URI" content="GUID-80698E62-E310-59CA-A524-5CF44C437BE4.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-80698E62-E310-59CA-A524-5CF44C437BE4.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Port Implementation Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2399606 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-80698E62-E310-59CA-A524-5CF44C437BE4.html" title="The Base Starter is a program that runs when the system starts.">Base Starter</a> &gt; </div>
<h1 class="topictitle1">Port
Implementation Tutorial</h1>
<div><p>This topic describes how to customize the Base Starter. </p>

<div class="section" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-9F925D19-DFAB-5C2A-8A04-E82963F2D221"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-9F925D19-DFAB-5C2A-8A04-E82963F2D221"><!-- --></a><h2 class="sectiontitle">Creating local
drive mapping files</h2> <a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-B20B8E9B-2FA5-57F2-9F06-88ED21D24E87"><!-- --></a><ol id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-B20B8E9B-2FA5-57F2-9F06-88ED21D24E87">
<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-BD13EA0C-81E2-5174-BFB0-1857B17BE85B"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-BD13EA0C-81E2-5174-BFB0-1857B17BE85B"><!-- --></a><p>Create an ASCII text
file containing your local drive mapping records; see <a href="GUID-8BA1EEC2-78A3-54CC-95D9-81BF2659963D.html#GUID-8BA1EEC2-78A3-54CC-95D9-81BF2659963D__GUID-2B95B775-1BD1-5256-86D3-CD3FA12447B9">create local drive mapping files</a> for information about the syntax
of the file. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-03BE3694-C78E-5A46-B4FF-FCAF55CED8D4"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-03BE3694-C78E-5A46-B4FF-FCAF55CED8D4"><!-- --></a><p>Put this text file into
your variant source tree. The source tree is typically of the form <span class="filepath">sf/os/boardsupport/.../&lt;your
                variant&gt;/estart/</span> . Depending on your port, you
might need more than one local drive mapping file. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-1850EBF2-71EB-53D6-A2AC-2FE33AEC8AE8"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-1850EBF2-71EB-53D6-A2AC-2FE33AEC8AE8"><!-- --></a><p>In the <span class="filepath">kernel.iby</span> file
for your variant, you need to add lines to make sure that your local drive
mapping files are copied into the ROM's <span class="filepath">\sys\data\</span> directory
when the ROM is built. For example include a lines in the form </p>
 <pre class="codeblock" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-B7C15498-DB7E-51CF-83D9-25013ABEC3B8"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-B7C15498-DB7E-51CF-83D9-25013ABEC3B8"><!-- --></a>data=\epoc32\rom\youvariant\ESTARTCOMP.TXT              \Sys\Data\ESTARTCOMP.TXT</pre>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-2808A5CB-D270-56D7-BE0E-BA476A31AFC6"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-2808A5CB-D270-56D7-BE0E-BA476A31AFC6"><!-- --></a><p>If you need more than
one mapping file, or your single mapping file has a name other than <span class="filepath">ESTART.TXT</span>,
then you need to customise the function <a href="GUID-9A65BCC6-FC1B-349E-BF8C-AEDE8F2549B7.html#GUID-9A65BCC6-FC1B-349E-BF8C-AEDE8F2549B7__GUID-F46A932C-8CC0-3F39-8C68-38C2660F86E7"><span class="apiname">TFSStartUp::LocalDriveMappingFileName()</span></a> so
that you can return the appropriate file name at run time. </p>
 </li>

</ol>
 </div>

<div class="section" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-51FBCDD1-7DB4-556D-9599-5F8B54837852"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-51FBCDD1-7DB4-556D-9599-5F8B54837852"><!-- --></a><h2 class="sectiontitle">Making use
of auto detection</h2> <p>To make use of auto-detection, you need to ensure
that your variant cannot find local drive mapping files in your ROM's <span class="filepath">\sys\data\</span> directory.
If you are using the default version of <a href="GUID-9A65BCC6-FC1B-349E-BF8C-AEDE8F2549B7.html#GUID-9A65BCC6-FC1B-349E-BF8C-AEDE8F2549B7__GUID-F46A932C-8CC0-3F39-8C68-38C2660F86E7"><span class="apiname">TFSStartUp::LocalDriveMappingFileName()</span></a>,
then make sure that no file exists with the full path name <span class="filepath">Z:\sys\data\estart.txt</span>. </p>
 </div>

<div class="section" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-AA916F3A-E8DF-522D-BDD6-18C2FD82AC16"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-AA916F3A-E8DF-522D-BDD6-18C2FD82AC16"><!-- --></a><h2 class="sectiontitle">Customising
code</h2> <p>The most common customisation is to provide your own implementation
of the <a href="GUID-7A6C0343-7B98-3429-9162-4C0357594230.html"><span class="apiname">TFSStartup</span></a> virtual functions. To do this: </p>
 <a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-7C709736-88C7-5770-8799-44C5DE9B78A2"><!-- --></a><ol id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-7C709736-88C7-5770-8799-44C5DE9B78A2">
<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-A5CB09C7-C008-5ADA-BC1C-BFDC268570B9"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-A5CB09C7-C008-5ADA-BC1C-BFDC268570B9"><!-- --></a><p>Take a copy of <span class="filepath">ESTARTMAIN.CPP</span> from <span class="filepath">sf/os/kernelhwsrv/userlibandfileserver/fileserver/estart/</span>, and insert your code into this copy. Typically this will include, but is
not limited to, your implementation of the <a href="GUID-7A6C0343-7B98-3429-9162-4C0357594230.html"><span class="apiname">TFSStartup</span></a> virtual
functions. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-A67D8EB7-A4A7-54DE-A46C-BF44FC6F173C"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-A67D8EB7-A4A7-54DE-A46C-BF44FC6F173C"><!-- --></a><p>Place the copy into
your variant's source tree. This is typically of the form <span class="filepath">sf/os/boardsupport/.../&lt;your
variant&gt;/estart/</span>. This is the general pattern for the other ports
supplied with Symbian platform. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-24536FD8-EABF-5E4D-A691-F36FEEBB604C"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-24536FD8-EABF-5E4D-A691-F36FEEBB604C"><!-- --></a><p>Create a <span class="filepath">.mmp</span> file
to build your variant's version of the Base Starter. This is usually placed
in the <span class="filepath">\&lt;youvariant&gt;\</span> directory. The general pattern
looks like this: <span class="filepath">sf/os/boardsupport/.../&lt;your               
 variant&gt;/estart/estart.mmp</span>. Ports to other hardware variants and
the emulator (WINS) variant follow the same general pattern. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-41111731-D21E-53E8-9728-1F2E8B2977B9"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-41111731-D21E-53E8-9728-1F2E8B2977B9"><!-- --></a><p>Your <span class="filepath">.mmp</span> file
should pick up the Symbian platform generic code from <span class="filepath">sf/os/kernelhwsrv/userlibandfileserver/fileserver/estart/estart.cpp</span>,
but should pick up your variant's customised source code from <span class="filepath">sf/os/boardsupport/.../&lt;your
variant&gt;/estart/estartmain.cpp</span>. The general pattern is to give
the resulting executable the name <span class="filepath">e32strt.exe</span>. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-FBBE887B-69D6-5904-8BD6-7E67F1B049B7"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-FBBE887B-69D6-5904-8BD6-7E67F1B049B7"><!-- --></a><p>In the <span class="filepath">kernel.iby</span> file
for your variant, you need to add a line that copies your executable into
the ROM's <span class="filepath">\sys\bin\</span> directory when the ROM is built.
For example, include a line of the form: </p>
 <pre class="codeblock" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-DF458ADA-69B8-5AC3-92D1-F57B9C14C326"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-DF458ADA-69B8-5AC3-92D1-F57B9C14C326"><!-- --></a>file=\Epoc32\Release\##MAIN##\##BUILD##\_##VARIANT##_e32strt.exe        sys\bin\estart.exe HEAPMAX(0x2000)</pre>
 </li>

</ol>
 </div>

<div class="section" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-92EE546A-2945-55EC-A0C3-4CE2ED7926CF"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-92EE546A-2945-55EC-A0C3-4CE2ED7926CF"><!-- --></a><h2 class="sectiontitle">Removing auto
detect from the Base Starter</h2> <p>You do this only if you need to save
code space, and you do not need the autodetect functionality. </p>
 <p>See
also <a href="GUID-8BA1EEC2-78A3-54CC-95D9-81BF2659963D.html#GUID-8BA1EEC2-78A3-54CC-95D9-81BF2659963D__GUID-A195BD51-80C7-5D87-ABA2-8878CC509B84">Use
automatic local drive mapping</a>. </p>
 <a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-6B18F11A-5271-5E04-A246-3143A856722B"><!-- --></a><ol id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-6B18F11A-5271-5E04-A246-3143A856722B">
<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-D86AD2FB-EDF7-5A95-949E-3C7BE9B609F0"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-D86AD2FB-EDF7-5A95-949E-3C7BE9B609F0"><!-- --></a><p>Create a <span class="filepath">.mmp</span> file
to build your variant's version of the Base Starter. This is usually placed
in the <span class="filepath">sf/os/boardsupport/.../&lt;your variant&gt;/estart/</span> directory.
This shows the general pattern. Ports to other hardware variants and the emulator
(WINS) variant follow the same general pattern. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-CFA6F952-2637-5999-8C06-191B8C9B81EB"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-CFA6F952-2637-5999-8C06-191B8C9B81EB"><!-- --></a><p>In your <span class="filepath">.mmp</span> file,
define the macro: </p>
 <pre class="codeblock" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-7DCF288E-CF86-550F-95BB-33CDAF342C66"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-7DCF288E-CF86-550F-95BB-33CDAF342C66"><!-- --></a>MACRO AUTODETECT_DISABLE</pre>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-3CD0D0C9-5CA5-5CCA-A918-5076DD38C576"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-3CD0D0C9-5CA5-5CCA-A918-5076DD38C576"><!-- --></a><p>The location of all
source files in the <span class="filepath">.mmp</span> file will be <span class="filepath">sf/os/kernelhwsrv/userlibandfileserver/fileserver/estart/</span>. </p>
 </li>

<li id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-9D679A09-134A-5E09-9A29-79D52B6BE975"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-9D679A09-134A-5E09-9A29-79D52B6BE975"><!-- --></a><p>In the <span class="filepath">kernel.iby</span> file
for your variant, you need to add a line to make sure that your executable
is copied into the ROM's <span class="filepath">\sys\bin\</span> directory when the
ROM is built. For example, include a line of the form </p>
 <pre class="codeblock" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-F893D88D-212A-5396-AB64-918CB48A37A1"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-F893D88D-212A-5396-AB64-918CB48A37A1"><!-- --></a>file=\Epoc32\Release\##MAIN##\##BUILD##\_##VARIANT##_e32strt.exe        sys\bin\estart.exe HEAPMAX(0x2000)</pre>
 <p>This is the general pattern for the other ports supplied with Symbian
platform. </p>
 </li>

</ol>
 </div>

<div class="section" id="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-251E3B54-AB58-4FE4-8E81-0ED48484C1FD"><a name="GUID-BFE1422D-3B4A-5B25-A757-B5B68D6390F8__GUID-251E3B54-AB58-4FE4-8E81-0ED48484C1FD"><!-- --></a><h2 class="sectiontitle">See also</h2> <p><a href="GUID-E5459A54-14BC-55C1-B911-63415E4C61A6.html" title="This section describes the technology, architecture, and source code organization of the Base Starter.">Concepts</a>  </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-80698E62-E310-59CA-A524-5CF44C437BE4.html" title="The Base Starter is a program that runs when the system starts.">Base Starter</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>