<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Processing an Extended Inquiry Response"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8411E1C9-C6CC-5B0A-BEBA-74D0B8AABF35.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DD13AA8E-BDAD-57EC-81EC-49C8D6D30A86.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6CE12919-FF81-5254-BA12-385F589FEA44.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8411E1C9-C6CC-5B0A-BEBA-74D0B8AABF35.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F2A793F1-A5B5-526B-B147-771D440B13A2.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Processing an Extended Inquiry Response</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2535271 id2535486 id2535540 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-DD13AA8E-BDAD-57EC-81EC-49C8D6D30A86.html" title="The Short Link Services module enables licensees to implement Bluetooth, USB, Infrared and OBEX on Symbian platform devices.">Short Link Services Guide</a> &gt; <a href="GUID-6CE12919-FF81-5254-BA12-385F589FEA44.html" title="The Bluetooth Management collection contains the Bluetooth Manager and Bluetooth Client components.">Bluetooth Management Collection</a> &gt; <a href="GUID-8411E1C9-C6CC-5B0A-BEBA-74D0B8AABF35.html">Bluetooth Client Library</a> &gt; </div>
<h1 class="topictitle1">Processing an Extended Inquiry Response</h1>
<div>
<p>This tutorial shows you how to retrieve and process the data from
a Bluetooth Extended Inquiry Response (EIR). </p>

<div class="section" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-5BD30F69-2DE0-40C6-8F45-3DDBC3F79A35"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-5BD30F69-2DE0-40C6-8F45-3DDBC3F79A35"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>This tutorial shows you how
to retrieve the EIR data and how to access the various types of data
within it. </p>
 <p><strong>Basic Procedure</strong> </p>
 <p>The high level steps to access the
EIR are shown here: </p>
 <a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-27E2F081-EE4A-516D-8D04-29D1A4601045"><!-- --></a><ol id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-27E2F081-EE4A-516D-8D04-29D1A4601045">
<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2F5F1046-3335-53CA-AD6D-01D1981348B5"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2F5F1046-3335-53CA-AD6D-01D1981348B5"><!-- --></a><p>Create the <samp class="codeph">EIR</samp> object and during construction fill it with the data
from the Extended Inquiry Response </p>
 </li>

<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-541D9DF2-816B-5057-B116-8A587F7A2146"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-541D9DF2-816B-5057-B116-8A587F7A2146"><!-- --></a><p>Use access functions
to retrieve the different types of data. </p>
 </li>

</ol>
 </div>

<div class="section" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-ED477BF8-1A81-49C2-9566-682D70A9DC3A"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-ED477BF8-1A81-49C2-9566-682D70A9DC3A"><!-- --></a><h2 class="sectiontitle">Environment</h2> <p>This tutorial assumes that
you have your device correctly configured, active and with Bluetooth
enabled and the Bluetooth Stack initialised. <samp class="codeph">iResult</samp> is in scope and contains a <a href="GUID-C625E339-6726-3FB9-8F8A-F4DB0CAC15FF.html"><span class="apiname">TNameEntry</span></a> object
as the result of a successful Inquiry request. See <a href="GUID-58F65411-CF08-5F46-8222-3FDB9E571FCC.html">Inquiring About Remote
Devices</a>. </p>
 <p> <strong>Note:</strong> When the Inquiry Request is
made, set the <samp class="codeph">aDoEIR</samp> flag to specify that Extended
Inquire Response data is required. The Bluetooth Stack will set the <samp class="codeph">aDoEIR</samp> flag if an older version of the API (non-EIR) is
used. </p>
 </div>

<div class="section" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-38AF6CEE-4F78-4113-AE85-CDD0390F1DC7"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-38AF6CEE-4F78-4113-AE85-CDD0390F1DC7"><!-- --></a><h2 class="sectiontitle">Tutorial</h2> <p><strong>Create an object to hold the Extended Inquiry Response data </strong> </p>
 <ul>
<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-0837BC7D-58A1-5E84-B64F-D2705DA2A844"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-0837BC7D-58A1-5E84-B64F-D2705DA2A844"><!-- --></a><pre class="codeblock" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-945D5812-6C22-595F-BE1F-F384C72121E1"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-945D5812-6C22-595F-BE1F-F384C72121E1"><!-- --></a>TBluetoothNameRecordWrapper eir(iResult());</pre>
 </li>

</ul>
 <p><strong> Use access functions to retrieve the various kinds of data</strong> </p>
 <a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2733C57E-2A4B-58CD-9340-A0DA609F5705"><!-- --></a><ol id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2733C57E-2A4B-58CD-9340-A0DA609F5705">
<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-0CA4F35B-23D4-570C-BAAC-520B5CEA62D2"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-0CA4F35B-23D4-570C-BAAC-520B5CEA62D2"><!-- --></a><p>Get the Bluetooth
device local name </p>
 <p> <strong>Note:</strong> The device local name may
be truncated if it is too long to fit in the EIR data packet. If the
name is not truncated then the <samp class="codeph">isNameComplete</samp> flag
will be set to <samp class="codeph">TRUE</samp>. </p>
 <pre class="codeblock" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-5F03D407-41FD-53AB-8DA7-B5F465719CFD"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-5F03D407-41FD-53AB-8DA7-B5F465719CFD"><!-- --></a>
TBool isNameComplete;
TInt error = KErrNone;
TInt length = 0;
            
// Get name
// This length could be used to create the TBuf to be passed into GetDeviceName()
length = eir.GetDeviceNameLength();
TBuf&lt;255&gt; name;
if(length &gt;= 0)
 {
 // name will contain a Unicode encoded 16-bit string
    error = eir.GetDeviceName(name, isNameComplete);
    }
 else
    {
        error = length;
    }
if(error == KErrNone)
// we have name here
    {
    if(isNameComplete == EFalse)
        {
        iHROutputConsole-&gt;Printf(_L("%d Bytes [Partial] Name: "), length);
        }
    else
        {
        iHROutputConsole-&gt;Printf(_L("%d Bytes [Complete] Name: "), length);
        }
        iHROutputConsole-&gt;Printf(_L("%S \n"),&amp;name);
    }
</pre>
 </li>

<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-323875EC-7012-537A-935A-74A91DE0F8D7"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-323875EC-7012-537A-935A-74A91DE0F8D7"><!-- --></a><p>Get the Transmission
Power level </p>
 <pre class="codeblock" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-870F61A6-F827-5B6D-BD4D-A8BB9EFAB0C6"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-870F61A6-F827-5B6D-BD4D-A8BB9EFAB0C6"><!-- --></a>// Get TxPowerLevel
TInt8 txPowerLevel;
error = eir.GetTxPowerLevel(txPowerLevel);
if(error == KErrNone)
    // TxPowerLevel present
    {
    iHROutputConsole-&gt;Printf(_L("TxPowerLevel: %ddBm\n"), txPowerLevel);
    }</pre>
 </li>

<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2C67FE67-0652-5840-BA1F-04891A95CAB6"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-2C67FE67-0652-5840-BA1F-04891A95CAB6"><!-- --></a><p>Get the Service
Class UUIDs. </p>
 <p> </p>
 <pre class="codeblock" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-132B642E-EC0A-54D5-B0F6-4F4218578EB5"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-132B642E-EC0A-54D5-B0F6-4F4218578EB5"><!-- --></a>// Get UUIDs
RExtendedInquiryResponseUUIDContainer uuidContainer;
error = eir.GetServiceClassUuids(uuidContainer);
if(error &gt;= KErrNone)
    {
    RArray&lt;TUUID&gt; uuids;
    TInt uuidCount = uuidContainer.UUIDs().Count();
    if(uuidCount &gt; 0)
     {
        iHROutputConsole-&gt;Printf(_L("*** UUID Count: %d\n"), uuidCount);
        TInt i;
        for(i=0;i&lt;uuidCount;i++)
            {
            TInt j;
            TPtrC8 uuid(uuidContainer.UUIDs()[i].ShortestForm());
            // Treat it as a big endian
            for(j=0;j&lt;uuid.Length();j++)
                {
                iHROutputConsole-&gt;Printf(_L("%02X"), uuid[j]);
                }
                
            iHROutputConsole-&gt;Printf(_L(" \n"));
            }
        }
    }</pre>
 </li>

<li id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-C694FBFB-496F-5936-B542-BDB3CD0C063B"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-C694FBFB-496F-5936-B542-BDB3CD0C063B"><!-- --></a><p>Get Manufacturer
Specific data. </p>
 <p> <strong>Note:</strong> This data is entirely defined
by the individual Manufacturer. </p>
 <pre class="codeblock" id="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-A53768A5-9644-5D56-84BC-EAA4580E8280"><a name="GUID-783D0B50-0E8A-5199-A07E-749D4A71E671__GUID-A53768A5-9644-5D56-84BC-EAA4580E8280"><!-- --></a>// Get Manufacturer Specific Data
length = eir.GetVendorSpecificDataLength();
TBuf8&lt;255&gt; msd;
if(length &gt; 0)
    {
    error = eir.GetVendorSpecificData(msd);
    }
else
    {
    error = length;
 }
if(error == KErrNone)
// we have Manufacturer Specific Data here
    {
    // This conversion is for display reason, in a real world this may not be necessary as 
    // Manufacturer specific data can be just raw 8-bit data, however GetDeviceName() is
    // different as it always return Unicode encoded 16-bit string
    error = CnvUtfConverter::ConvertToUnicodeFromUtf8(name, msd);
    if(error &gt;= KErrNone &amp;&amp; length &gt; 0)
        {
        iHROutputConsole-&gt;Printf(_L("%d Bytes Manufacturer Specific Data: %S\n"), length, &amp;name);
        }
    }
}</pre>
 </li>

</ol>
 </div>


</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-8411E1C9-C6CC-5B0A-BEBA-74D0B8AABF35.html">Bluetooth Client Library</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-F2A793F1-A5B5-526B-B147-771D440B13A2.html">Bluetooth Extended Inquiry Response</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>