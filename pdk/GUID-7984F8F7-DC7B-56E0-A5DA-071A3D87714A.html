<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="LString Tutorial"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D33EB877-CCCB-527B-8AFC-4A8385C55E78.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-28AD51DC-C101-5E6E-9EC3-C2B61400D8CD.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D60B55FA-D8C1-559A-9D99-48845BE32A6C.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D33EB877-CCCB-527B-8AFC-4A8385C55E78.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B1D5B680-00E3-5702-985A-94256180E2D8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-69D916D3-ED05-58DA-BA42-CE4D7E4F6482.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B419D99E-8312-5336-9693-3ED8DFCD0559.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>LString Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2381103 id2383459 id2384051 id2384059 id2384120 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html">Generic OS Services Guide</a> &gt; <a href="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html">Low Level Libraries and Frameworks</a> &gt; <a href="GUID-28AD51DC-C101-5E6E-9EC3-C2B61400D8CD.html">Generic Usability Library</a> &gt; <a href="GUID-D60B55FA-D8C1-559A-9D99-48845BE32A6C.html" title="The EUser High Level (EUserHL) library is a general purpose user library that provides a usability layer to hide away some of the complexities of the Symbian platform. This section lists the concepts, the overview and the tutorials that helps the Symbian Developers understand the importance of the EUserHL library.">EUser High Level Library</a> &gt; <a href="GUID-D33EB877-CCCB-527B-8AFC-4A8385C55E78.html" title="The EUser High Level Library tutorials are meant to discuss the usage of the LString and resource management class implementation.">EUser High Level Library Tutorials</a> &gt; </div>
<h1 class="topictitle1">LString
Tutorial</h1>
<div><div><p>LStrings can be used as class member variables, declared in the
class declaration and instantiated in ConstructL(), in the constructor or
in the constructor initialisation list.  </p>
</div>

<div class="p"><p><strong>Required background</strong></p>
<p>Before beginning you must know
the following: </p>
 <ul>
<li id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-F16B6935-EAF1-5EF1-A69E-4D0D5F48EF95"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-F16B6935-EAF1-5EF1-A69E-4D0D5F48EF95"><!-- --></a><p> <a href="GUID-49D4E917-57EA-39AE-8941-144AA8AC2584.html"><span class="apiname">TDes </span></a> -
Build independent modifiable descriptor. </p>
 </li>

<li id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-FD3CD5F7-E991-5003-B595-15139EE34880"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-FD3CD5F7-E991-5003-B595-15139EE34880"><!-- --></a><p> <a href="GUID-52D07F46-2162-380C-A775-C3BB335C42F5.html"><span class="apiname">TDesC </span></a> -
Build independent non-modifiable descriptor. </p>
 </li>

<li id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-0CD1486E-0B54-5877-91D8-7D5C094B90FD"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-0CD1486E-0B54-5877-91D8-7D5C094B90FD"><!-- --></a><p> <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a> -
This class provides a buffer that contains, accesses and manipulates TUint16
data. The buffer itself is on the heap, and is managed by the class. </p>
 </li>

</ul>
 </div>

<div class="section"><p> <a href="GUID-2C3DFAFD-A2DD-3E44-BB1A-580E60EDD8BC.html"><span class="apiname">LString</span></a> is a convenient, general-purpose string
class derived from RBuf. LString adds automatic cleanup and on-demand buffer
resize facilities. Like an RBuf, an LString can be passed to any function
that is prototyped to take a <a href="GUID-49D4E917-57EA-39AE-8941-144AA8AC2584.html"><span class="apiname">TDes</span></a> or a <a href="GUID-52D07F46-2162-380C-A775-C3BB335C42F5.html"><span class="apiname">TDesC</span></a> reference.
Again like an <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a>, an LString maintains its string data
in a heap buffer. </p>
 </div>

<ul><li class="stepexpand" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-3B84AF07-5356-4BFA-91D2-B8FE64121852"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-3B84AF07-5356-4BFA-91D2-B8FE64121852"><!-- --></a><span><strong>Declaring an LString</strong></span><br/>
 <p>LStrings can also be used as class member variables, declared in
the class declaration and instantiated in <a href="GUID-C8E0575D-5A7F-3D00-9BE5-AD8D6DBCF2F7.html"><span class="apiname">ConstructL()</span></a>,
in the constructor or in the constructor initialisation list. </p>
 <p>LString
provides a variety of construction options as show in code snippet below: </p>
 <pre class="codeblock" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-760C7BA0-DDBC-5B8C-AD1C-E0E5E7ECCC1D"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-760C7BA0-DDBC-5B8C-AD1C-E0E5E7ECCC1D"><!-- --></a>
{

_LIT(KOne, "One ");
_LIT(KTesting, "Testing ");


// A default constructed LString starts empty, doesn't
// allocate any memory on the heap, and therefore the
// following cannot leave
LString s;

// You can initialize with a MaxLength value
LString s(KMaxFileName); // This operation may leave

// You can initialize from any descriptor (or literal) and the
// string data is copied into the LString
LString s(KOne); // From a literal

LString half(s.Left(s.Length() / 2)); // Left returns a TPtrC

// On the other hand, you can initialize from a returned
// HBufC* and the LString automatically takes ownership
LString own(AllocateNameL(KTesting));

// LStrings can be allocated on the heap if necessary
LString* s = new(ELeave) LString;

}
</pre>

</li>
<li class="stepexpand" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-2A0AB10A-433B-46BC-A636-86CC128B6F35"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-2A0AB10A-433B-46BC-A636-86CC128B6F35"><!-- --></a><span><strong>Managing the size of the LString manually</strong></span><br/>
 <p>Although <a href="GUID-2C3DFAFD-A2DD-3E44-BB1A-580E60EDD8BC.html"><span class="apiname">LString</span></a> supports automatic resizing,
it is also possible, and sometimes necessary to manually change the length
of the string. When an LString is passed to a function as a <a href="GUID-49D4E917-57EA-39AE-8941-144AA8AC2584.html"><span class="apiname">TDes</span></a> or <a href="GUID-52D07F46-2162-380C-A775-C3BB335C42F5.html"><span class="apiname">TDesC</span></a>,
it looses its automatic resizing capabilities and therefore care must be taken
to ensure sufficient space is allocated before the call is made. </p>
 <p>Extra
space can be allocated to the LString by calling <a href="GUID-A3EE1898-D58C-3C15-8A98-7BEF85963AEB.html"><span class="apiname">ReserveFreeCapacityL()</span></a> function
and the string can be compressed to the minimum length by calling <a href="GUID-E016AEA6-D901-3AF4-AE52-CBE4308E962C.html"><span class="apiname">Compress()</span></a> function.
An example code snippet is shown below: </p>
 <pre class="codeblock" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-DE899D49-DC9D-53DE-8E7B-B0F19EAF4D8A"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-DE899D49-DC9D-53DE-8E7B-B0F19EAF4D8A"><!-- --></a>
_LIT(KOne, "One ");

{
    LString s(KOne);
    s.ReserveFreeCapacityL(4);
    test(s.Length() == 4);
    test(s.MaxLength() &gt;= 8);
    s.Compress();
    test(s.MaxLength() &gt;= 4);    //note indefinite test
    s.Reset();
    test(s.Length() == 0);
    test(s.MaxLength() == 0);
}
</pre>

</li>
<li class="stepexpand" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-5FD35D1B-B252-4266-BCC0-7FC00ED6BF93"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-5FD35D1B-B252-4266-BCC0-7FC00ED6BF93"><!-- --></a><span><strong>Passing an LString to a function expecting a TDes or TDesC</strong></span><br/>
 <p> <a href="GUID-2C3DFAFD-A2DD-3E44-BB1A-580E60EDD8BC.html"><span class="apiname">LString</span></a>, derived from <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a> can
be passed directly to any method accepting a <a href="GUID-49D4E917-57EA-39AE-8941-144AA8AC2584.html"><span class="apiname">TDes</span></a> or <a href="GUID-52D07F46-2162-380C-A775-C3BB335C42F5.html"><span class="apiname">TDesC</span></a> parameter.
Be aware though that once passed as a TDes, LString loses its automatic resizing
capability. Care must be taken to ensure that sufficient capacity is reserved
by calling <a href="GUID-A3EE1898-D58C-3C15-8A98-7BEF85963AEB.html"><span class="apiname">ReserveFreeCapacityL()</span></a> function or <a href="GUID-B7878C32-D093-3B15-A5B6-E91DA3A0961E.html"><span class="apiname">SetMaxLengthL() </span></a> function
before passing the LString as a TDes. When passed to a function as a TDes
a USER 11 panic will be raised if the string is modified and the resulting
length of this descriptor is greater than its maximum length. </p>
 <p>An example
code snippet is shown below: </p>
 <pre class="codeblock" id="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-2BDE3A6B-E974-5E30-AB1A-D670C64AD2F1"><a name="GUID-7984F8F7-DC7B-56E0-A5DA-071A3D87714A__GUID-2BDE3A6B-E974-5E30-AB1A-D670C64AD2F1"><!-- --></a>
void GetCurrentPath(TDes&amp; aDes)
    {
    aDes = KPath;
    }
. . .
{
    LString s;
    test(s.MaxLength() == 0);
    s.SetMaxLengthL(KMaxFileName);
    GetCurrentPath(s);
}
</pre>

</li>
</ul>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-D33EB877-CCCB-527B-8AFC-4A8385C55E78.html" title="The EUser High Level Library tutorials are meant to discuss the usage of the LString and resource management class implementation.">EUser High Level Library Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-B1D5B680-00E3-5702-985A-94256180E2D8.html" title="Automatic resource management is designed to increase the baseline usability of the Symbian platform for Symbian Developers.">Automatic
Resource Management</a></div>
</div>
<div class="relinfo reltasks"><strong>Related tasks</strong><br/>
<div><a href="GUID-69D916D3-ED05-58DA-BA42-CE4D7E4F6482.html">Automatic
Resource Management Class Templates Tutorial</a></div>
<div><a href="GUID-B419D99E-8312-5336-9693-3ED8DFCD0559.html">Automatic
Resource Management Tutorial</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>