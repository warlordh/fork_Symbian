<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Host Settings API Tutorial"/>
<meta name="abstract" content="This document describes how to use the SUPL Host Settings API (deprecated)."/>
<meta name="description" content="This document describes how to use the SUPL Host Settings API (deprecated)."/>
<meta name="DC.Relation" scheme="URI" content="GUID-816334A7-488B-5F91-8C2E-47076D875013.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-01C03839-C88B-5FC3-9E0E-686415888B63.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-816334A7-488B-5F91-8C2E-47076D875013.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Host Settings API Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2402590 id2403195 id2403262 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-7F476137-5E7F-5288-9F4A-6C20F0A1AD9B.html">Location Based Services (LBS) Guide</a> &gt; <a href="GUID-01C03839-C88B-5FC3-9E0E-686415888B63.html" title="The Network Adaptation collection contains Protocol Module ECOM plug-ins that can be used by the Network Gateway to support location and privacy requests.">Network Adaptation</a> &gt; <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a> &gt; </div>
<h1 class="topictitle1">Host
Settings API Tutorial</h1>
<div><p>This document describes how to use the SUPL Host Settings API (deprecated). </p>

<div class="p" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-3C812574-821A-4CE0-9010-7BEBECBCEED6"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-3C812574-821A-4CE0-9010-7BEBECBCEED6"><!-- --></a><p>The reader must be familiar with the <a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL
Protocol Module</a> of the LBS subsystem. </p>
<p>Note: From
Symbian^3 the SUPL Protocol Module is deprecated. For the preferred way of
using SUPL see <a href="GUID-1F7F543A-8A9C-4460-BDB1-A6866E9DF0B9.html">SUPL
Proxy Protocol Module</a>. </p>
 </div>

<div class="section" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-9D651569-468E-4C91-9A23-5AFB5A50007C"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-9D651569-468E-4C91-9A23-5AFB5A50007C"><!-- --></a><p>There are three classes of users of the Host Settings API: </p>
 <ul>
<li id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-CFC35B97-A153-5BB5-A08A-99CAA35ADAE1"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-CFC35B97-A153-5BB5-A08A-99CAA35ADAE1"><!-- --></a><p>The Symbian reference
SUPL Protocol Module. </p>
 </li>

<li id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-B188E558-7209-5161-A7EB-D76B52E60E69"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-B188E558-7209-5161-A7EB-D76B52E60E69"><!-- --></a><p>The Symbian SUPL host
settings device provisioning plug-ins. </p>
 </li>

<li id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-166D7B7C-D989-5AC1-AF3F-ED286FBB62FD"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-166D7B7C-D989-5AC1-AF3F-ED286FBB62FD"><!-- --></a><p>A licensee host settings
application. </p>
 </li>

</ul>
 <p>Device creators will typically only need to use the Host Settings
API to create a host settings application to allow mobile device users to
read the host settings and to set the default SLP. </p>
 <p>Note that network
operators may not want to allow device users to create new host settings or
to modify the individual properties of host settings such as host address
and port number as defined in <a href="GUID-5B492B69-19D2-38B8-946F-FD1155513F9F.html"><span class="apiname">TLbsHostSettingsSupl</span></a>  </p>
 </div>

<a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-5890F26A-EC50-5B4A-89DA-A2BB059C2722"><!-- --></a><ol id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-5890F26A-EC50-5B4A-89DA-A2BB059C2722"><li class="stepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-1238A4A5-ED69-5B27-B83D-CD9DB6E5102A"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-1238A4A5-ED69-5B27-B83D-CD9DB6E5102A"><!-- --></a><span>How to create host
settings. </span>
 Host settings can be created using the Host Settings API. They are typically
created by the SUPL Device Provisioning plug-ins for Device Management (<span class="filepath">dmsupladapter.dll</span>)
and Client Provisioning (<span class="filepath">cpsupladapter.dll</span>). 
 A network operator can send a Device Management or Client Provisioning
message to the mobile device. The message is processed by one of the Device
Provisioning plug-ins which use the Host Settings API to create host settings. 
 The example code below shows how the Device Management plug-in creates
host settings: 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7123BAFF-9013-5EF6-97D9-44A2F28538F7"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7123BAFF-9013-5EF6-97D9-44A2F28538F7"><!-- --></a>
// Create a host settings store
// The value of KLbsHostSettingsSuplStoreId is defined in lbshostsettings.h

CLbsHostSettingsStore iLBSHostSettingStore;
iLBSHostSettingStore = CLbsHostSettingsStore::NewL(KLbsHostSettingsSuplStoreId);
</pre>
 
 A Device Provisioning plug-in decodes a received message and creates
host settings: 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-B40F45FF-9DE8-5F0D-9721-C0E05AEC1C15"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-B40F45FF-9DE8-5F0D-9721-C0E05AEC1C15"><!-- --></a>
TLbsHostSettingsSupl setting;

/* Device Management plug-in decodes message to get host settings properties
   and sets the hosts settings properties, for example:
   setting.SetHostNameAddress(aRequest.Data());
   setting.SetReadOnly(iSetReadOnly); etc.
*/

// Use the Host Settings API to create the host settings

TLbsHostSettingsId settingId;

// KLbsHostSettingsDevProvCreatorId is defined in lbshostsettings.h
// settingId is a return parameter that contains a unique ID for the new host setting entry
User::LeaveIfError(iLBSHostSettingStore-&gt;CreateHostSettings(setting, KLbsHostSettingsDevProvCreatorId, settingId));
</pre>
 
 Note that in general, mobile device users should not be given the ability
to create new host settings via a licensee settings application because host
settings are defined by network operators. 
</li>
<li class="stepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-E0FAF2CC-A4D7-5A76-82EE-0E8D8619C7B5"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-E0FAF2CC-A4D7-5A76-82EE-0E8D8619C7B5"><!-- --></a><span>How to delete host
settings. </span>
 Host settings can be deleted using the Host Settings API. 
 A network operator can send a message to a mobile device to delete host
settings. The message is processed by either the SUPL Device Management or
SUPL Client Provisioning plug-in. 
 The example code below shows how the Device Management plug-in calls
the Host Settings API to delete host settings: 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-18FCD2DC-4845-5E4F-B1F9-A810B13B3775"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-18FCD2DC-4845-5E4F-B1F9-A810B13B3775"><!-- --></a>
// Device Management code to get the ID of the settings to be deleted
TInt settingid;
GetLuidL(aRequest.UriParser().Uri(), settingid);
TLbsHostSettingsId id = TUid::Uid(settingid);

// Use the Host Settings API to delete the host settings...
User::LeaveIfError(iLBSHostSettingStore-&gt;DeleteHostSettings(id));
</pre>
 
</li>
<li class="stepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-30B1EB05-D763-564C-84E3-049A887F73AA"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-30B1EB05-D763-564C-84E3-049A887F73AA"><!-- --></a><span>How to modify host
settings </span>
 Existing host settings can be modified using the Host Settings API. 
 A network operator can send a message to a mobile device to modify host
settings. The message is processed by either the SUPL Device Management or
SUPL Client Provisioning plug-in. 
 The example code below shows how the Device Management plug-in calls
the Host Settings API to modify host settings: 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-04725335-6496-52C5-9C74-4A9D7811DC26"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-04725335-6496-52C5-9C74-4A9D7811DC26"><!-- --></a>
// Device Management code to get the ID of the settings to be updated
TInt luid;
GetLuidL(pathStub, luid);
TLbsHostSettingsId settingid = TUid::Uid(luid);


// Use the Host Settings API to update the host settings...
iLBSHostSettingStore-&gt;UpdateHostSettings(settingid, aSuplSetting);
</pre>
 
</li>
<li class="stepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-F8FE15D9-767A-52E5-93CE-026D29844485"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-F8FE15D9-767A-52E5-93CE-026D29844485"><!-- --></a><span>How to read host
settings </span>
 Host Settings can be read using the Host Settings API. 
 A licensee may want to create a host settings application to display
a list of SLP names and to allow a user to select the default SLP (which is
used for SET initiated location requests). 
 There are three methods that can be used to read host settings: 

<a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-ABA13B53-4CEE-5CDA-B7F7-A7B5638C3181"><!-- --></a><ol type="a" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-ABA13B53-4CEE-5CDA-B7F7-A7B5638C3181">
<li class="substepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7026779A-EB1E-5551-A1AE-CEFD7F98C257"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7026779A-EB1E-5551-A1AE-CEFD7F98C257"><!-- --></a><span/><br/>
  <a href="GUID-30917438-ED01-3AFC-9964-9337761D6AB6.html#GUID-30917438-ED01-3AFC-9964-9337761D6AB6__GUID-1CF97B00-2E7C-3E96-83C6-B7551A896215"><span class="apiname">CLbsHostSettingsStore::GetNextHostSettings()</span></a> gets
the next host settings in the data store. 
</li>

<li class="substepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7CB76E0C-E440-51C9-A3A4-76AB2EA6ABB8"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-7CB76E0C-E440-51C9-A3A4-76AB2EA6ABB8"><!-- --></a><span/><br/>
  <a href="GUID-30917438-ED01-3AFC-9964-9337761D6AB6.html#GUID-30917438-ED01-3AFC-9964-9337761D6AB6__GUID-86FA035F-4ED9-3ADA-ABC9-E42229659288"><span class="apiname">CLbsHostSettingsStore::GetNextHostSettingsByCreator()</span></a> gets
the next host settings created by a specified Host Settings API client. 
</li>

<li class="substepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-64B675FF-5074-5F58-BA10-3D87AE5A1283"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-64B675FF-5074-5F58-BA10-3D87AE5A1283"><!-- --></a><span/><br/>
  <a href="GUID-30917438-ED01-3AFC-9964-9337761D6AB6.html#GUID-30917438-ED01-3AFC-9964-9337761D6AB6__GUID-47FA6FAA-8529-3CBF-9DCD-7D0358EE2980"><span class="apiname">CLbsHostSettingsStore::GetHostSettings()</span></a> gets the
host settings when the settings ID is known (it is specified by a <a href="GUID-A8BEC3F1-3DC4-3F36-8A27-56F8ECB6CACB.html"><span class="apiname">TLbsHostSettingsId</span></a> input
parameter). <samp class="codeph">GetNextHostSettings()</samp> and <samp class="codeph">GetNextHostSettingsByCreator()</samp> return
a settings ID as a <samp class="codeph">TLbsHostSettingsId</samp> output parameter. 
</li>

</ol>

 The first two of the above methods allow a program to iterate over the
host settings in the data store. It is necessary to call <a href="GUID-30917438-ED01-3AFC-9964-9337761D6AB6.html#GUID-30917438-ED01-3AFC-9964-9337761D6AB6__GUID-B69CF40F-010D-3571-B563-6054263352FF"><span class="apiname">CLbsHostSettingsStore::RewindHostSettings()</span></a> before
calling either of the <samp class="codeph">GetNext</samp> methods in order to begin iteration
with the first host settings entry. 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-57B81FFA-B798-5CC7-9702-9CD6765B45B5"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-57B81FFA-B798-5CC7-9702-9CD6765B45B5"><!-- --></a>
TLbsHostSettingsSupl setting;
TLbsHostSettingsId settingId;

User::LeaveIfError(iLBSHostSettingStore-&gt;RewindHostSettings());

TInt err = KErrNone;
while (err != KErrNotFound)
    {
    err = iLBSHostSettingStore-&gt;GetNextHostSettings(setting, settingId);
                    
    if (err == KErrNone)
        {
        // settingId contains a unique settingId
        // Get hostname, host address etc. for this host setting

        } 

 }
</pre>
 
</li>
<li class="stepexpand" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-EA0B8441-C245-57EB-9E3A-C2AD267FA89C"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-EA0B8441-C245-57EB-9E3A-C2AD267FA89C"><!-- --></a><span>How to set default
host settings </span>
 The default host settings are used by the SUPL Protocol Module for SET
initiated location requests (MO-LRs). A licensee may want to allow users to
set the default host settings in a host settings application. 
 See the section <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html#GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE__GUID-061F50BE-F291-53D9-ACD9-B36D19B01E54">Configure
the SUPL Location Platform host settings</a> of the document <a href="GUID-91F95D0C-E4CF-510E-B280-E27F89274ACE.html" title="This document describes how a device creator starts working with the SUPL Protocol Module.">SUPL
Protocol Module Quick Start</a> for details of the rules used by the SUPL
Protocol Module for host settings selection for SET initiated and network
initiated location requests. 
 <pre class="codeblock" id="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-C1D87EA3-1089-54F1-BDED-5EEC1B1BC93A"><a name="GUID-567DA7A6-B900-5506-97DA-F425F15CFCB0__GUID-C1D87EA3-1089-54F1-BDED-5EEC1B1BC93A"><!-- --></a>
// Set the first entry in the host settings store to be the default

TLbsHostSettingsSupl setting;
TLbsHostSettingsId settingId;

User::LeaveIfError(iLBSHostSettingStore-&gt;RewindHostSettings());
User::LeaveIfError(iLBSHostSettingStore-&gt;GetNextHostSettings(setting, settingId));
User::LeaveIfError(iLBSHostSettingStore-&gt;SetDefaultHostSettings(settingId));

</pre>
 
</li>
</ol>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-816334A7-488B-5F91-8C2E-47076D875013.html" title="The LBS subsystem contains a reference Network Protocol Module that supports the Open Mobile Alliance (OMA) SUPL V1.0 standard. This section contains documentation that describes the Symbian platform reference SUPL Protocol Module, its supporting components and APIs, its runtime behaviour and details about how it is configured by device creators.">SUPL Protocol Module</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-FE4794F8-2519-5AC2-BCF7-168ECA6645EA.html" title="The Host Settings API is used by the SUPL Protocol Module to get the host settings. It is also used by a device creator's application or device provisioning plug-in to set host settings.">Host    
            Settings API</a></div>
<div><a href="GUID-CC3454B1-21DA-542E-8949-52C30755AC77.html" title="The SUPL Protocol Module is a Network Protocol Module provided by Symbian to support the OMA SUPL v1.0 standard.">SUPL Protocol
                Module Overview</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>